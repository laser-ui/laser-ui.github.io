import{r as l,u as H,b as M,e as q,f as U,g as J,h as K,i as Q,k as V,j as s,m as W,l as m}from"./index-c42aab4a.js";import{g as R,u as X}from"./getOffsetToRoot-7e0b0ae7.js";import{s as Y}from"./scrollTo-0bdbbbcc.js";import{t as A}from"./toPx-cc587901.js";const Z={anchor:"^anchor",anchor__link:"^anchor__link","anchor__link.is-active":"is-active","anchor__indicator-track":"^anchor__indicator-track","anchor__indicator-wrapper":"^anchor__indicator-wrapper","anchor__dot-indicator":"^anchor__dot-indicator","anchor__line-indicator":"^anchor__line-indicator"},S=Symbol(),C=Symbol();function tt(N,L){const{styleOverrides:O,styleProvider:T,list:E,page:b,distance:d=0,scrollBehavior:D="instant",indicator:x=S,onClick:k,...y}=H("Anchor",N),u=M(Z,{anchor:T==null?void 0:T.anchor},O),{pageScrollRef:w,contentResizeRef:$}=q(),r=U(b??(()=>w.current)),_=l.useRef(null),g=l.useRef(null),I=l.useRef({}),[v,B]=l.useState(null),h=J(()=>{if(r.current&&_.current&&g.current){const a=R(r.current);let e;const n=c=>{c.forEach(({href:t,children:p})=>{const i=document.getElementById(t);if(i&&r.current){const f=R(i),G=m.isString(d)?A(d,!0):d;Math.ceil(r.current.scrollTop)+G>=f-a&&(m.isUndefined(e)?e=[t,f]:f>e[1]&&(e=[t,f]))}m.isArray(p)&&n(p)})};n(E);const o=e?e[0]:null;if(B(o),o){const c=_.current.querySelector(`[data-l-href="${o}"]`).getBoundingClientRect(),t=c.top-_.current.getBoundingClientRect().top+c.height/2;g.current.style.cssText=`opacity:1;top:${t}px;`}else g.current.style.cssText+="opacity:0;"}});X(()=>{h()});const P=K(h);Q(r,"scroll",h,{passive:!0},P),V($,h),l.useImperativeHandle(L,()=>({active:v,updateAnchor:h}),[v,h]);const z=a=>{var e,n;if(r.current){const o=R(r.current),c=r.current.scrollTop;window.location.hash=`#${a}`,r.current.scrollTop=c;const t=document.getElementById(a);if(t){const p=R(t),i=m.isString(d)?A(d,!0):d;(n=(e=I.current).clearTid)==null||n.call(e),I.current.clearTid=Y(r.current,{top:p-o-i,behavior:D})}}},F=(()=>{const a=(e,n=0)=>e.map(o=>{const{title:c,href:t,target:p,children:i}=o;return s.jsxs(l.Fragment,{children:[s.jsx("li",{...u("anchor__link",{"anchor__link.is-active":t===v}),"data-l-href":t,children:s.jsx("a",{style:{paddingLeft:16+n*16},href:`#${t}`,target:p,onClick:f=>{f.preventDefault(),z(t),k==null||k(t,o)},children:c??t})}),i&&a(i,n+1)]},`${t}-${n}`)});return a(E)})();return s.jsxs("ul",{...y,...W(u("anchor"),{className:y.className,style:y.style}),ref:_,children:[s.jsx("div",{...u("anchor__indicator-track"),children:s.jsx("div",{...u("anchor__indicator-wrapper"),ref:g,children:x===S?s.jsx("div",{...u("anchor__dot-indicator")}):x===C?s.jsx("div",{...u("anchor__line-indicator")}):x})}),F]})}const j=l.forwardRef(tt);j.DOT_INDICATOR=S;j.LINE_INDICATOR=C;export{j as A};
