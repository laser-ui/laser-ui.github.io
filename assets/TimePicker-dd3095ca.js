import{r as s,u as Pe,a as Ie,b as Ne,d as ze,P as $e,V as Me,o as Fe,e as Oe,c as se,l as E,a6 as A,R as Be,_ as Ue,g as Le,$ as He,a0 as ce,a1 as We,h as Ge,i as Ye,k as G,a3 as Je,j as n,m as Y,I as J,a4 as Ke,n as Ze,a5 as K,B as qe}from"./index-69d16a75.js";import{u as oe}from"./useForkRef-892bbf69.js";import{u as Qe}from"./MdRoute-c7575085.js";import{S as Xe}from"./cancel-5dc0fa6a.js";import{d as et,S as tt,T as it,a as rt}from"./utils-f530098f.js";const nt=F=>s.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",...F},s.createElement("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm.5-13H11v6l5.25 3.15.75-1.23-4.5-2.67z"})),st={"time-picker":"^time-picker","time-picker.is-disabled":"is-disabled","time-picker--small":"^time-picker--small","time-picker--medium":"^time-picker--medium","time-picker--large":"^time-picker--large","time-picker__input":"^time-picker__input","time-picker__indicator":"^time-picker__indicator","time-picker__separator":"^time-picker__separator","time-picker__clear":"^time-picker__clear","time-picker__icon":"^time-picker__icon","time-picker-popup":"^time-picker-popup","time-picker__panel":"^time-picker__panel","time-picker__header":"^time-picker__header","time-picker__column":"^time-picker__column","time-picker__cell":"^time-picker__cell","time-picker__cell.is-active":"is-active","time-picker__cell.is-disabled":"is-disabled","time-picker__footer":"^time-picker__footer"},dt=s.forwardRef((F,ae)=>{const{styleOverrides:le,styleProvider:S,formControl:u,model:ue,defaultModel:de,visible:pe,defaultVisible:me,placeholder:Z,range:p=!1,format:v="HH:mm:ss",order:fe="ascend",clearable:ve=!1,size:ke,disabled:ge=!1,config:q,escClosable:he=!0,inputRef:T,inputRender:O,onModelChange:_e,onVisibleChange:xe,onClear:B,afterVisibleChange:w,...o}=Pe("TimePicker",F),U=Ie(),m=Ne(st,{"time-picker":S==null?void 0:S["time-picker"],"time-picker-popup":S==null?void 0:S["time-picker-popup"]},le),P=ze(),{t:I}=$e(),L=Me(),be=Fe(),{pageScrollRef:Ee,contentResizeRef:Se}=Oe(),y=s.useRef(null),k=s.useRef(null),g=s.useRef(null),j=s.useRef(null),R=s.useRef(null),Te=oe(g,T==null?void 0:T[0]),we=oe(j,T==null?void 0:T[1]),c=s.useRef(null),r=s.useRef({latestFocused:"start",onceVisible:!1,focusAnother:!1,inputValue:[void 0,void 0],rangeDate:[null,null]}),Q=e=>rt(e,fe),[l,D]=se(me??!1,pe,xe),[h,X]=Qe([!1,!1]);h[0]&&(r.current.latestFocused="start"),h[1]&&(r.current.latestFocused="end");const[V,N]=se(de??null,ue,_e,(e,t)=>et(e,t,v),u==null?void 0:u.control);let[_,x=null]=p?V??[null,null]:[V,null];p&&(E.isNull(V)?[_,x]=r.current.rangeDate:r.current.rangeDate=[null,null]);const z=[0,1].map(e=>h[e]&&!E.isUndefined(r.current.inputValue[e])?r.current.inputValue[e]:(()=>{const t=e===0?_:x;return E.isNull(t)?"":A(t).format(v)})()),H=e=>{const t=h.findIndex(i=>i);p?E.isNull(V)?(r.current.rangeDate[t]=e,r.current.rangeDate.every(i=>!E.isNull(i))&&(r.current.focusAnother=Q(r.current.rangeDate),r.current.focusAnother&&r.current.rangeDate.reverse(),r.current.inputValue=[void 0,void 0],N(r.current.rangeDate))):(r.current.inputValue=[void 0,void 0],N(i=>{i[t]=e,r.current.focusAnother=Q(i),r.current.focusAnother&&i.reverse()})):(r.current.inputValue=[void 0,void 0],N(e)),L()},[ye=I("TimePicker",p?"Start time":"Select time"),je=I("TimePicker","End time")]=p?Z??[]:[Z],{size:Re,disabled:$}=Be({size:ke,disabled:ge||(u==null?void 0:u.control.disabled)}),De=Ue(l),Ve=`calc(var(--${U}-zindex-fixed) + ${De})`,W=s.useRef(),f=Le(()=>{if(l&&y.current&&k.current){const e=k.current.offsetHeight,t=He.windowSize.width-ce*2,i=Math.min(k.current.scrollWidth,t),d=We(y.current,{width:i,height:e},{placement:"bottom-left",inWindow:ce});W.current=d.transformOrigin,P.classes.position&&k.current.classList.toggle(P.classes.position,!1),P.replaceRule("position",{top:d.top,left:d.left,maxWidth:t}),k.current.classList.toggle(P.classes.position,!0)}}),Ce=Ge(f,!l);Ye(Ee,"scroll",f,{passive:!0},!l||Ce),G(y,f,void 0,!l),G(k,f,void 0,!l),G(Se,f,void 0,!l),s.useImperativeHandle(ae,()=>({updatePosition:f}),[f]),s.useEffect(()=>{if(y.current&&R.current){let e=!1;const t=y.current.getBoundingClientRect();if(g.current&&document.activeElement===g.current){const i=g.current.getBoundingClientRect();R.current.style.cssText=`left:${i.left-t.left}px;width:${i.width}px;opacity:1;`,e=!0}if(j.current&&document.activeElement===j.current){const i=j.current.getBoundingClientRect();R.current.style.cssText=`left:${i.left-t.left}px;width:${i.width}px;opacity:1;`,e=!0}e||(R.current.style.cssText+="opacity:0;")}}),s.useEffect(()=>{if(r.current.focusAnother&&document.activeElement){const e=document.activeElement.parentElement;for(let t=0;t<e.childElementCount;t++){const i=e.children.item(t);if(i.tagName.toLowerCase()==="input"&&i!==document.activeElement){i.focus({preventScroll:!0});break}}}r.current.focusAnother=!1});const ee=e=>{var t;if(p){const i=h.findIndex(d=>d);E.isNull(i===0?x:_)?(r.current.focusAnother=!0,L()):D(!1)}else D(!1);r.current.focusAnother||(t=c.current)==null||t.call(c,e)},te=ve&&!E.isNull(V)&&!l&&!$,ie=e=>{const t=e?0:1,i=e?_:x,d=O==null?void 0:O[t],re=n.jsx("input",{...m("time-picker__input"),...u==null?void 0:u.inputAria,ref:e?Te:we,type:"text",autoComplete:"off",value:z[t],size:10,placeholder:e?ye:je,disabled:$,onChange:a=>{var b;if(L(),r.current.inputValue[t]=a.currentTarget.value,A(a.currentTarget.value,v,!0).isValid()){const C=A(a.currentTarget.value,v).toDate();H(C),(b=c.current)==null||b.call(c,C)}},onKeyDown:a=>{if(a.code==="Escape")l&&he&&(a.stopPropagation(),a.preventDefault(),D(!1));else if(a.code==="Enter"&&z[t]&&A(z[t],v,!0).isValid()){a.preventDefault();const b=A(z[t],v).toDate();ee(b)}},onFocus:()=>{var a,b,C;(b=(a=r.current).clearTid)==null||b.call(a),X(ne=>{ne.fill(!1),ne[e?0:1]=!0}),r.current.inputValue=[void 0,void 0],l&&p&&i&&((C=c.current)==null||C.call(c,i))},onBlur:()=>{r.current.clearTid=be.setTimeout(()=>{X([!1,!1]),D(!1)},20)}});return d?d(re):re},M=e=>{(document.activeElement===g.current||document.activeElement===j.current)&&e.target!==g.current&&e.target!==j.current&&e.button===0&&e.preventDefault()},Ae=Je({compose:{disabled:$},form:u});return n.jsxs(n.Fragment,{children:[n.jsxs("div",{...o,...Y(m("time-picker",`time-picker--${Re}`,{"time-picker.is-disabled":$}),{className:o.className,style:o.style}),...Ae,ref:y,onMouseDown:e=>{var t;(t=o.onMouseDown)==null||t.call(o,e),M(e)},onMouseUp:e=>{var t;(t=o.onMouseUp)==null||t.call(o,e),M(e)},onClick:e=>{var t,i;(t=o.onClick)==null||t.call(o,e),h.some(d=>d)||(i=g.current)==null||i.focus({preventScroll:!0}),D(!0)},children:[ie(!0),p&&n.jsxs(n.Fragment,{children:[n.jsx("div",{...m("time-picker__indicator"),ref:R}),n.jsx("div",{...m("time-picker__separator"),children:n.jsx(J,{children:n.jsx(tt,{})})}),ie(!1)]}),te&&n.jsx("div",{...m("time-picker__clear"),role:"button","aria-label":I("Clear"),onClick:e=>{e.stopPropagation(),r.current.inputValue=[void 0,void 0],N(null),B==null||B()},children:n.jsx(J,{children:n.jsx(Xe,{})})}),n.jsx("div",{...Y(m("time-picker__icon"),{style:{visibility:te?"hidden":void 0}}),children:n.jsx(J,{children:n.jsx(nt,{})})})]}),n.jsx(Ke,{selector:()=>{let e=document.getElementById(`${U}-time-picker-root`);return e||(e=document.createElement("div"),e.id=`${U}-time-picker-root`,document.body.appendChild(e)),e},children:n.jsx(Ze,{enter:l,during:K,afterRender:()=>{f();const e=()=>{var i;const t=h[0]?_:x;t&&((i=c.current)==null||i.call(c,t))};p?e():r.current.onceVisible||(r.current.onceVisible=!0,e())},afterEnter:()=>{w==null||w(!0)},afterLeave:()=>{w==null||w(!1)},children:e=>{let t={};switch(e){case"enter":t={transform:"scaleY(0.7)",opacity:0};break;case"entering":t={transition:["transform","opacity"].map(i=>`${i} ${K}ms ease-out`).join(", "),transformOrigin:W.current};break;case"leaving":t={transform:"scaleY(0.7)",opacity:0,transition:["transform","opacity"].map(i=>`${i} ${K}ms ease-in`).join(", "),transformOrigin:W.current};break;case"leaved":t={display:"none"};break}return n.jsxs("div",{...Y(m("time-picker-popup"),{style:{zIndex:Ve,...t}}),ref:k,onMouseDown:i=>{M(i)},onMouseUp:i=>{M(i)},children:[n.jsx(it,{ref:c,styled:m,time:r.current.latestFocused==="start"?_:x,format:v,config:q?(...i)=>q(...i,r.current.latestFocused,[_,x]):void 0,onTimeChange:i=>{H(i)}}),n.jsx("div",{...m("time-picker__footer"),children:n.jsx(qe,{pattern:"link",onClick:()=>{const i=new Date;H(i),ee(i)},children:I("TimePicker","Now")})})]})}})})]})});export{dt as T};
