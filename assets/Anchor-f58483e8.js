import{u as H,b as q,d as F,e as M,r as d,f as U,g as G,s as J,i as K,j as a,m as Q,l as m}from"./index-a3329107.js";import{g as R}from"./getOffsetToRoot-ecc9918d.js";import{s as V}from"./scrollTo-4b1704f6.js";import{t as A}from"./toPx-996c9f39.js";const W={anchor:"^anchor",anchor__link:"^anchor__link","anchor__link.is-active":"is-active","anchor__indicator-track":"^anchor__indicator-track","anchor__indicator-wrapper":"^anchor__indicator-wrapper","anchor__dot-indicator":"^anchor__dot-indicator","anchor__line-indicator":"^anchor__line-indicator"},E=Symbol(),C=Symbol(),j=N=>{const{ref:L,styleOverrides:O,styleProvider:T,list:I,page:D,distance:i=0,scrollBehavior:$="instant",indicator:x=E,onClick:y,...k}=H("Anchor",N),l=q(W,{anchor:T==null?void 0:T.anchor},O),{pageScrollRef:b,contentResizeRef:w}=F(),r=M(D??(()=>b.current)),h=d.useRef(null),p=d.useRef(null),S=d.useRef(()=>{}),[v,B]=d.useState(null),f=U(()=>{if(r.current&&h.current&&p.current){const e=R(r.current);let n;const o=s=>{s.forEach(({href:t,children:g})=>{const _=document.getElementById(t);if(_&&r.current){const u=R(_),z=m.isString(i)?A(i,!0):i;Math.ceil(r.current.scrollTop)+z>=u-e&&(m.isUndefined(n)?n=[t,u]:u>n[1]&&(n=[t,u]))}m.isArray(g)&&o(g)})};o(I);const c=n?n[0]:null;if(B(c),c){const s=h.current.querySelector(`[data-l-href="${c}"]`).getBoundingClientRect(),t=s.top-h.current.getBoundingClientRect().top+s.height/2;p.current.style.cssText=`opacity:1;top:${t}px;`}else p.current.style.cssText+="opacity:0;"}});G(()=>{f()},[]),J(r,"scroll",f,{passive:!0}),K(w,f),d.useImperativeHandle(L,()=>({active:v,updateAnchor:f}),[v,f]);const P=e=>{if(r.current){const n=R(r.current),o=r.current.scrollTop;window.location.hash=`#${e}`,r.current.scrollTop=o;const c=document.getElementById(e);if(c){const s=R(c),t=m.isString(i)?A(i,!0):i;S.current(),S.current=V(r.current,{top:s-n-t,behavior:$})}}};return a.jsxs("ul",{...k,...Q(l("anchor"),{className:k.className,style:k.style}),ref:e=>(h.current=e,()=>{h.current=null}),children:[a.jsx("div",{...l("anchor__indicator-track"),children:a.jsx("div",{...l("anchor__indicator-wrapper"),ref:e=>(p.current=e,()=>{p.current=null}),children:x===E?a.jsx("div",{...l("anchor__dot-indicator")}):x===C?a.jsx("div",{...l("anchor__line-indicator")}):x})}),(()=>{const e=(n,o=0)=>n.map(c=>{const{title:s,href:t,target:g,children:_}=c;return a.jsxs(d.Fragment,{children:[a.jsx("li",{...l("anchor__link",{"anchor__link.is-active":t===v}),"data-l-href":t,children:a.jsx("a",{style:{paddingLeft:16+o*16},href:`#${t}`,target:g,onClick:u=>{u.preventDefault(),P(t),y==null||y(t,c)},children:s??t})}),_&&e(_,o+1)]},`${t}-${o}`)});return e(I)})()]})};j.DOT_INDICATOR=E;j.LINE_INDICATOR=C;export{j as A};
