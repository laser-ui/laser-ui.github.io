import{r as c,u as ht,a as mt,b as bt,N as vt,d as xt,c as de,l as g,Q as gt,X as St,Y as J,Z as jt,f as yt,_ as ke,$ as ee,a0 as Re,h as wt,i as Et,k as ue,m as W,j as l,p as It,I as H,a1 as kt,a2 as Rt,q as De,a3 as Dt,n as Ct,a4 as pe,V as Nt}from"./index-23b78b6e.js";import{u as Pt}from"./useForkRef-66a9c376.js";import{S as Mt}from"./cancel-5a0c7cc9.js";import{S as Wt}from"./add-ad1e4e21.js";import{S as zt}from"./keyboard_arrow_down-f558feb6.js";import{S as At}from"./search-8558651a.js";import{i as Tt}from"./isPrintableCharacter-1b5c27a6.js";import{T as Ce}from"./Tag-e86d78b7.js";import{V as $t}from"./VirtualScroll-3a5a9032.js";import{C as Vt}from"./Checkbox-9fd90a41.js";import{E as Ne}from"./Empty-25e15fff.js";const Lt={select:"^select","select.is-expanded":"is-expanded","select.is-disabled":"is-disabled","select--small":"^select--small","select--medium":"^select--medium","select--large":"^select--large",select__container:"^select__container",select__content:"^select__content",select__search:"^select__search","select__placeholder-wrapper":"^select__placeholder-wrapper",select__placeholder:"^select__placeholder","select__multiple-count":"^select__multiple-count",select__close:"^select__close",select__clear:"^select__clear",select__icon:"^select__icon",select__arrow:"^select__arrow","select-popup":"^select-popup","select-popup__loading":"^select-popup__loading","select-popup__loading--empty":"^select-popup__loading--empty",select__list:"^select__list",select__option:"^select__option","select__option.is-selected":"is-selected","select__option.is-disabled":"is-disabled","select__option-prefix":"^select__option-prefix","select__option-content":"^select__option-content","select__option-group":"^select__option-group","select__option-group-label":"^select__option-group-label",select__empty:"^select__empty"},z=Symbol();function Ft(Pe,Me){const{styleOverrides:We,styleProvider:k,formControl:m,list:R,model:ze,defaultModel:Ae,visible:Te,defaultVisible:$e,placeholder:fe,multiple:d=!1,searchable:S=!1,searchValue:Ve,defaultSearchValue:Le,clearable:Fe=!1,loading:B=!1,size:Oe,disabled:Ue=!1,monospaced:He=!0,virtual:A=!1,escClosable:Be=!0,customItem:_e,customSelected:D,customSearch:j,createItem:te,inputRef:Ge,inputRender:he,onModelChange:se,onVisibleChange:Ke,onSearch:Ye,onClear:le,onCreateItem:ne,onScrollBottom:qe,afterVisibleChange:C,...p}=ht("Select",Pe),N=mt(),i=bt(Lt,{select:k==null?void 0:k.select,"select-popup":k==null?void 0:k["select-popup"]},We),{t:G}=vt(),me=c.useId(),be=`${N}-select-list-${me}`,T=e=>`${N}-select-item-${e}-${me}`,{pageScrollRef:Ze,contentResizeRef:Qe}=xt(),y=c.useRef(null),P=c.useRef(null),w=c.useRef(null),K=c.useRef(null),Xe=Pt(K,Ge),$=c.useRef(null),V=c.useMemo(()=>{const e=new Map,s=t=>{for(const n of t)e.set(n.value,n),n.children&&s(n.children)};return s(R),e},[R]),[a,v]=de($e??!1,Te,Ke),[L,Je]=de(Le??"",Ve,Ye),E=c.useCallback(e=>!e.disabled&&!e.children,[]),[Y,q]=de(Ae??(d?[]:null),ze,e=>{se&&(d?se(e,e.map(s=>V.get(s))):se(e,g.isNull(e)?null:V.get(e)))},void 0,m==null?void 0:m.control),b=c.useMemo(()=>d?new Set(Y):Y,[Y,d]),Z=e=>{d?q(s=>{const t=s.findIndex(n=>n===e);t!==-1?s.splice(t,1):s.push(e)}):(q(e),v(!1))},{size:oe,disabled:M}=gt({size:Oe,disabled:Ue||(m==null?void 0:m.control.disabled)}),F=L.length>0,ie=d?b.size>0:!g.isNull(b),ce=(()=>{if(!F)return[];const e=g.isUndefined(j==null?void 0:j.filter)?o=>o.label.includes(L):o=>j.filter(L,o),s=j==null?void 0:j.sort;let t=te==null?void 0:te(L);t&&(t={...t,[z]:!0});let n=[];return R.forEach(o=>{if(!o.children)t&&o.value===t.value&&(t=void 0),e(o)&&n.push(o);else{const u=[];o.children.forEach(h=>{t&&h.value===t.value&&(t=void 0),e(h)&&u.push(h)}),n=n.concat(u)}}),s&&n.sort(s),t&&n.unshift(t),n})(),O=F?ce:R,[et,tt]=St(e=>e.startsWith("Arrow")||["Home","End","Enter","Space"].includes(e)),[ve,st]=c.useState(),lt=(()=>{let e;return ve&&(e=V.get(ve.value),e&&E(e))||(ie&&(e=J(R,s=>E(s)&&d?b.has(s.value):b===s.value)),g.isUndefined(e)&&(e=J(R,s=>E(s)))),e})(),[ae,nt]=c.useState(),ot=(()=>{if(ae&&J(ce,e=>E(e)&&e.value===ae.value))return ae;if(F)return J(ce,e=>E(e))})(),f=F?ot:lt,xe=e=>{F?nt(e):st(e)},ge=e=>{if(!g.isUndefined(e)){const s=Object.assign({},e);delete s[z],ne==null||ne(s)}},it=jt(a),ct=`calc(var(--${N}-zindex-fixed) + ${it})`,[Se,je]=c.useState(),[at,ye]=c.useState({top:"-200vh",left:"-200vw"}),x=yt(()=>{if(a&&y.current&&P.current)if(He){const e=Math.min(y.current.offsetWidth,ke.windowSize.width-ee*2),s=P.current.offsetHeight,t=Re(y.current,{width:e,height:s},{placement:"bottom",inWindow:ee});je(t.transformOrigin),ye({top:t.top,left:t.left,width:e})}else{const e=y.current.offsetWidth,s=P.current.offsetHeight,t=ke.windowSize.width-ee*2,n=Math.min(Math.max(P.current.scrollWidth,e),t),o=Re(y.current,{width:n,height:s},{placement:"bottom-left",inWindow:ee});je(o.transformOrigin),ye({top:o.top,left:o.left,minWidth:Math.min(e,t),maxWidth:t})}}),rt=wt(x,!a);Et(Ze,"scroll",x,{passive:!0},!a||rt),ue(y,x,void 0,!a),ue(P,x,void 0,!a),ue(Qe,x,void 0,!a),c.useImperativeHandle(Me,()=>({updatePosition:x}),[x]);const Q=e=>{document.activeElement===K.current&&e.target!==K.current&&e.button===0&&e.preventDefault()},I=c.useRef(),X=S&&a,we=Fe&&ie&&!a&&!B&&!M,Ee=tt(c.createElement(S?"input":"div",Object.assign({...W(i("select__search"),{style:{opacity:X?void 0:0,zIndex:X?void 0:-1}}),...m==null?void 0:m.inputAria,ref:Xe,tabIndex:M?-1:0,role:"combobox","aria-haspopup":"listbox","aria-expanded":a,"aria-controls":be,onBlur:()=>{v(!1)},onKeyDown:e=>{if(e.code==="Escape")a&&Be&&(e.stopPropagation(),e.preventDefault(),v(!1));else{const s=t=>{var n,o,u,h;if(w.current){let _;switch(t){case"next":_=(n=$.current)==null?void 0:n.scrollToStep(w.current,1);break;case"prev":_=(o=$.current)==null?void 0:o.scrollToStep(w.current,-1);break;case"first":_=(u=$.current)==null?void 0:u.scrollToStart(w.current);break;case"last":_=(h=$.current)==null?void 0:h.scrollToEnd(w.current);break}_&&(xe(_),A===!1&&(I.current=()=>{const r=document.getElementById(T(_.value));r&&Nt(r,w.current)},a&&(I.current(),I.current=void 0)))}};if(a)switch(e.code){case"ArrowUp":{e.preventDefault(),s("prev");break}case"ArrowDown":{e.preventDefault(),s("next");break}case"Home":{e.preventDefault(),s("first");break}case"End":{e.preventDefault(),s("last");break}default:{(e.code==="Enter"||e.code==="Space"&&!S)&&(e.preventDefault(),f&&(f[z]&&ge(f),Z(f.value)));break}}else if(!(S&&["Home","End","Enter","Space"].includes(e.code)))switch(e.code){case"End":case"ArrowUp":{e.preventDefault(),v(!0),s("last");break}case"Home":case"ArrowDown":{e.preventDefault(),v(!0),s("first");break}case"Enter":case"Space":{e.preventDefault(),v(!0);break}default:{Tt(e.key)&&v(!0);break}}}},onChange:e=>{S&&Je(e.currentTarget.value)}},S?{type:"text",value:L,autoComplete:"off",disabled:M}:{}))),[dt,ut,pt]=(()=>{let e=null,s=null,t;if(d){const n=[];for(const o of Y){const u=V.get(o);u&&n.push(u)}s=l.jsx(It,{list:n.map(o=>{const{label:u,value:h,disabled:_}=o,r=D?D(o):u;return{id:h,title:r,type:"item",disabled:_}}),onClick:o=>(Z(o),!1),children:l.jsx(Ce,{tabIndex:-1,size:oe,children:b.size})}),e=n.map(o=>l.jsxs(Ce,{size:oe,children:[D?D(o):o.label,!(o.disabled||M)&&l.jsx("div",{...i("select__close"),role:"button","aria-label":G("Close"),onClick:u=>{u.stopPropagation(),Z(o.value)},children:l.jsx(H,{children:l.jsx(kt,{})})})]},o.value))}else if(!g.isNull(b)){const n=V.get(b);n&&(t=n.label,e=D?D(n):t)}return[e,s,t]})(),ft=Rt({compose:{disabled:M},form:m}),_t=c.useMemo(()=>({list:O,itemKey:e=>e.value,itemSize:g.isNumber(A)?A:32,itemEmptySize:32,itemNested:e=>e.children,itemFocusable:E}),[E,O,A]);return l.jsxs(l.Fragment,{children:[l.jsxs("div",{...p,...W(i("select",`select--${oe}`,{"select.is-expanded":a,"select.is-disabled":M}),{className:p.className,style:p.style}),...ft,ref:y,onMouseDown:e=>{var s;(s=p.onMouseDown)==null||s.call(p,e),Q(e)},onMouseUp:e=>{var s;(s=p.onMouseUp)==null||s.call(p,e),Q(e)},onClick:e=>{var s,t;(s=p.onClick)==null||s.call(p,e),(t=K.current)==null||t.focus({preventScroll:!0}),v(n=>S?!0:!n)},children:[l.jsxs("div",{...i("select__container"),title:pt,children:[he?he(Ee):Ee,!X&&(ie?l.jsx("div",{...i("select__content"),children:dt}):fe?l.jsx("div",{...i("select__placeholder-wrapper"),children:l.jsx("div",{...i("select__placeholder"),children:fe})}):null)]}),d&&l.jsx("div",{...i("select__multiple-count"),onClick:e=>{e.stopPropagation()},children:ut}),we&&l.jsx("div",{...i("select__clear"),role:"button","aria-label":G("Clear"),onClick:e=>{e.stopPropagation(),q(d?[]:null),le==null||le()},children:l.jsx(H,{children:l.jsx(Mt,{})})}),l.jsx("div",{...W(i("select__icon"),{style:{visibility:we?"hidden":void 0}}),children:l.jsx(H,{children:B?l.jsx(De,{}):X?l.jsx(At,{}):l.jsx(zt,{...i("select__arrow")})})})]}),l.jsx(Dt,{selector:()=>{let e=document.getElementById(`${N}-select-root`);return e||(e=document.createElement("div"),e.id=`${N}-select-root`,document.body.appendChild(e)),e},children:l.jsx(Ct,{enter:a,during:pe,afterRender:()=>{var e;x(),(e=I.current)==null||e.call(I),I.current=void 0},afterEnter:()=>{C==null||C(!0)},afterLeave:()=>{C==null||C(!1)},children:e=>{let s={};switch(e){case"enter":s={transform:"scaleY(0.7)",opacity:0};break;case"entering":s={transition:["transform","opacity"].map(t=>`${t} ${pe}ms ease-out`).join(", "),transformOrigin:Se};break;case"leaving":s={transform:"scaleY(0.7)",opacity:0,transition:["transform","opacity"].map(t=>`${t} ${pe}ms ease-in`).join(", "),transformOrigin:Se};break;case"leaved":s={display:"none"};break}return l.jsxs("div",{...W(i("select-popup"),{style:{zIndex:ct,...at,...s}}),ref:P,onMouseDown:t=>{Q(t)},onMouseUp:t=>{Q(t)},children:[B&&l.jsx("div",{...i("select-popup__loading",{"select-popup__loading--empty":O.length===0}),children:l.jsx(H,{children:l.jsx(De,{})})}),B&&O.length===0?null:l.jsx($t,{..._t,ref:$,enable:A!==!1,listSize:264,listPadding:4,itemRender:(t,n,o,u,h)=>{const{label:_,value:r,disabled:re}=t,Ie=_e?_e(t):_;if(h)return c.createElement("ul",{...i("select__option-group"),key:r,role:"group","aria-labelledby":T(r)},c.createElement("li",{...i("select__option-group-label"),key:r,id:T(r),role:"presentation"},l.jsx("div",{...i("select__option-content"),children:Ie})),h);let U=!1;return d?U=b.has(r):U=b===r,c.createElement("li",{...W(i("select__option",{"select__option.is-selected":!d&&U,"select__option.is-disabled":re}),{style:{paddingLeft:u.length===0?void 0:12+8}}),...o,key:r,id:T(r),title:(t[z]?G("Create")+" ":"")+_,role:"option","aria-selected":U,"aria-disabled":re,onClick:()=>{t[z]&&ge(t),xe(t),Z(r)}},et&&(f==null?void 0:f.value)===r&&l.jsx("div",{className:`${N}-focus-outline`}),t[z]?l.jsx("div",{...i("select__option-prefix"),children:l.jsx(H,{theme:"primary",children:l.jsx(Wt,{})})}):d?l.jsx("div",{...i("select__option-prefix"),children:l.jsx(Vt,{model:U,disabled:re})}):null,l.jsx("div",{...i("select__option-content"),children:Ie}))},itemFocused:f==null?void 0:f.value,itemEmptyRender:()=>l.jsx("li",{...W(i("select__empty"),{style:{paddingLeft:12+8}}),children:l.jsx("div",{...i("select__option-content"),children:G("No Data")})}),itemInAriaSetsize:t=>!t.children,placeholder:"li",onScrollEnd:qe,children:(t,n)=>l.jsx("ul",{...i("select__list"),ref:w,id:be,tabIndex:-1,role:"listbox","aria-multiselectable":d,"aria-activedescendant":g.isUndefined(f)?void 0:T(f.value),onScroll:n,children:O.length===0?l.jsx(Ne,{style:{padding:"12px 0"},image:Ne.SIMPLE_IMG}):t})})]})}})})]})}const Jt=c.forwardRef(Ft);export{Jt as S};
