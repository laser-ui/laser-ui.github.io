import{r as n,g as Me,l as W,A as Be,j as s,I as ce,q as De,E as pa,u as fa,a as _a,b as ha,d as ba,v as ma,e as ga,c as we,x as xa,F as va,G as Ce,H as Sa,R as ka,W as Ue,J as ja,h as ya,i as Ea,k as Ie,m as me,p as wa,K as Ca,L as Ia,P as Ra,n as Da,M as Re}from"./index-40b015b6.js";import{u as Na}from"./useForkRef-fb6acea2.js";import{S as Ma}from"./cancel-ec520f89.js";import{S as Pa}from"./keyboard_arrow_down-27f36eca.js";import{S as Ta}from"./search-0219cd73.js";import{V as Ge}from"./VirtualScroll-c90d0b66.js";import{C as Ye}from"./Checkbox-93ccc764.js";import{E as ge}from"./Empty-5f6b3e37.js";import{g as Ne}from"./utils-c2ed83c6.js";import{T as R,M as La,S as Aa}from"./single-node-19c90d0d.js";import{B as Fa}from"./BaseInput-759c6821.js";import{i as Wa}from"./isPrintableCharacter-1b5c27a6.js";import{T as Oe}from"./Tag-e88d597a.js";function za(Y,ee){const{namespace:ae,styled:p,id:x,list:y,customItem:V,itemId:K,itemSelected:k,itemFocused:_,multiple:P,virtual:l,focusVisible:D,onFocus:q,onClick:j,_root:E=!0}=Y,m=n.useRef(null),v=n.useRef(null),d=n.useRef(null),T=_&&y.findIndex(a=>a.id===_.id)!==-1,o=(()=>{if(_)for(const a of y){if(_.id===a.id)return a;let f=_;for(;f.parent;)if(f=f.parent,f.id===a.id)return a}})(),h=Me(a=>{var f,J,z,w,Z,re,te;if(m.current){let S;if(E&&W.isUndefined(_))switch(a){case"first":case"next":S=(f=v.current)==null?void 0:f.scrollToStart(m.current);break;case"last":case"prev":S=(J=v.current)==null?void 0:J.scrollToEnd(m.current);break}else if(T)switch(a){case"next":S=(z=v.current)==null?void 0:z.scrollToStep(m.current,1);break;case"prev":S=(w=v.current)==null?void 0:w.scrollToStep(m.current,-1);break;case"first":S=(Z=v.current)==null?void 0:Z.scrollToStart(m.current);break;case"last":S=(re=v.current)==null?void 0:re.scrollToEnd(m.current);break;case"prev-level":o&&o.parent&&(S=o.parent);break;case"next-level":if(o&&o.children){for(const L of o.children)if(L.enabled){S=L;break}}break;default:a instanceof HTMLElement&&m.current&&Be(a,m.current);break}else S=(te=d.current)==null?void 0:te.call(d,a);return S}});n.useImperativeHandle(ee,()=>h,[h]);const N=n.useMemo(()=>({list:y,itemKey:a=>a.id,itemSize:W.isNumber(l)?l:32,itemFocusable:a=>a.enabled}),[y,l]);return s.jsxs(s.Fragment,{children:[s.jsx(Ge,{...N,ref:v,enable:l!==!1,listSize:264,listPadding:4,itemRender:(a,f,J)=>{let z=!1;if(a.children&&k){let w=k;for(;w.parent;)if(w=w.parent,w.id===a.id){z=!0;break}}return n.createElement("li",{...p("cascader__option",{"cascader__option.is-focused":a.id===(o==null?void 0:o.id),"cascader__option.is-selected":!P&&a.checked,"cascader__option.is-disabled":a.disabled}),...J,key:a.id,id:K(a.id),title:a.origin.label,role:"option","aria-selected":a.checked,"aria-disabled":a.disabled,onClick:()=>{q(a),P&&!a.isLeaf||j(a)}},D&&(_==null?void 0:_.id)===a.id&&s.jsx("div",{className:`${ae}-focus-outline`}),z&&s.jsx("div",{...p("cascader__option-dot")}),P&&s.jsx("div",{...p("cascader__option-prefix"),children:s.jsx(Ye,{model:a.checked,disabled:a.disabled,indeterminate:a.indeterminate,onClick:w=>{w.stopPropagation(),q(a),j(a)}})}),s.jsx("div",{...p("cascader__option-content"),children:V?V(a.origin):a.origin.label}),!a.isLeaf&&s.jsx("div",{...p("cascader__option-icon"),children:s.jsx(ce,{children:a.origin.loading?s.jsx(De,{}):s.jsx(pa,{})})}))},itemFocused:o==null?void 0:o.id,placeholder:"li",children:(a,f)=>s.jsx("ul",{...p("cascader__list","cascader__list--inline"),ref:m,id:x,tabIndex:-1,role:"listbox","aria-multiselectable":P,"aria-activedescendant":E&&!W.isUndefined(_)?K(_.id):void 0,onScroll:f,children:y.length===0?s.jsx(ge,{style:{padding:"12px 28px"},image:ge.SIMPLE_IMG}):a})}),o&&!o.origin.loading&&o.children&&s.jsx(qe,{...Y,_root:!1,ref:d,id:void 0,list:o.children})]})}const qe=n.forwardRef(za);function Ha(Y,ee){const{namespace:ae,styled:p,id:x,list:y,customItem:V,itemId:K,itemFocused:k,multiple:_,onlyLeafSelectable:P,virtual:l,focusVisible:D,onClick:q}=Y,j=n.useRef(null),E=n.useRef(null),m=Me(d=>{var T,o,h,N;if(j.current){let a;switch(d){case"next":a=(T=E.current)==null?void 0:T.scrollToStep(j.current,1);break;case"prev":a=(o=E.current)==null?void 0:o.scrollToStep(j.current,-1);break;case"first":a=(h=E.current)==null?void 0:h.scrollToStart(j.current);break;case"last":a=(N=E.current)==null?void 0:N.scrollToEnd(j.current);break;default:d instanceof HTMLElement&&j.current&&Be(d,j.current);break}return a}});n.useImperativeHandle(ee,()=>m,[m]);const v=n.useMemo(()=>({list:y,itemKey:d=>d.value,itemSize:W.isNumber(l)?l:32,itemFocusable:d=>d[R].enabled}),[y,l]);return s.jsx(Ge,{...v,ref:E,enable:l!==!1,listSize:264,listPadding:4,itemRender:(d,T,o)=>{const h=d[R];let N=h.checked;if(!P){let a=h;for(;a.parent;)if(a=a.parent,a.id===d.value){N=!0;break}}return n.createElement("li",{...p("cascader__option",{"cascader__option.is-selected":!_&&N,"cascader__option.is-disabled":h.disabled}),...o,key:d.value,id:K(d.value),title:d.label,role:"option","aria-selected":h.checked,"aria-disabled":h.disabled,onClick:()=>{q(d)}},D&&(k==null?void 0:k.value)===d.value&&s.jsx("div",{className:`${ae}-focus-outline`}),_&&s.jsx("div",{...p("cascader__option-prefix"),children:s.jsx(Ye,{model:h.checked,disabled:h.disabled})}),s.jsx("div",{...p("cascader__option-content"),children:V?V(h.origin):Ne(h)}))},itemFocused:k==null?void 0:k.value,placeholder:"li",children:(d,T)=>s.jsx("ul",{...p("cascader__list"),ref:j,id:x,tabIndex:-1,role:"listbox","aria-multiselectable":_,"aria-activedescendant":W.isUndefined(k)?void 0:K(k.value),onScroll:T,children:y.length===0?s.jsx(ge,{style:{padding:"12px 28px"},image:ge.SIMPLE_IMG}):d})})}const $a=n.forwardRef(Ha),Va={cascader:"^cascader","cascader.is-expanded":"is-expanded","cascader.is-disabled":"is-disabled","cascader--small":"^cascader--small","cascader--medium":"^cascader--medium","cascader--large":"^cascader--large",cascader__container:"^cascader__container",cascader__content:"^cascader__content",cascader__search:"^cascader__search","cascader__placeholder-wrapper":"^cascader__placeholder-wrapper",cascader__placeholder:"^cascader__placeholder","cascader__multiple-count":"^cascader__multiple-count",cascader__close:"^cascader__close",cascader__clear:"^cascader__clear",cascader__icon:"^cascader__icon",cascader__arrow:"^cascader__arrow","cascader-popup":"^cascader-popup","cascader-popup__content":"^cascader-popup__content","cascader-popup__loading":"^cascader-popup__loading","cascader-popup__loading--empty":"^cascader-popup__loading--empty",cascader__list:"^cascader__list","cascader__list--inline":"^cascader__list--inline",cascader__option:"^cascader__option","cascader__option.is-focused":"is-focused","cascader__option.is-selected":"is-selected","cascader__option.is-disabled":"is-disabled","cascader__option-dot":"^cascader__option-dot","cascader__option-prefix":"^cascader__option-prefix","cascader__option-content":"^cascader__option-content","cascader__option-icon":"^cascader__option-icon",cascader__empty:"^cascader__empty"};function Ka(Y,ee){const{styleOverrides:ae,styleProvider:p,formControl:x,list:y,model:V,defaultModel:K,visible:k,defaultVisible:_,placeholder:P,multiple:l=!1,searchable:D=!1,searchValue:q,defaultSearchValue:j,onlyLeafSelectable:E=!0,clearable:m=!1,loading:v=!1,size:d,disabled:T=!1,virtual:o=!1,escClosable:h=!0,customItem:N,customSelected:a,customSearch:f,inputRef:J,inputRender:z,popupRender:w,onModelChange:Z,onVisibleChange:re,onSearch:te,onClear:S,onFirstFocus:L,afterVisibleChange:Q,...C}=fa("Cascader",Y),U=_a(),b=ha(Va,{cascader:p==null?void 0:p.cascader,"cascader-popup":p==null?void 0:p["cascader-popup"]},ae),ie=ba(),{t:Pe}=ma(),Te=n.useId(),xe=`${U}-cascader-list-${Te}`,ve=e=>`${U}-cascader-item-${e}-${Te}`,{pageScrollRef:Je,contentResizeRef:Ze}=ga(),ne=n.useRef(null),O=n.useRef(null),le=n.useRef(null),Qe=Na(le,J),se=n.useRef(null),oe=n.useRef({itemFocused:new Set}),[de,B]=n.useMemo(()=>{const e=y.map(r=>l?new La(r,t=>t.value,{disabled:r.disabled}):new Aa(r,t=>t.value,{disabled:r.disabled})),c=new Map,i=r=>{for(const t of r)c.set(t.id,t),t.children&&i(t.children)};return i(e),[e,c]},[y,l]),[g,A]=we(_??!1,k,re),[ue,Xe]=we(j??"",q,te),[pe,H]=we(K??(l?[]:null),V,e=>{Z&&(l?Z(e,e.map(c=>B.get(c).origin)):Z(e,W.isNull(e)?null:B.get(e).origin))},void 0,x==null?void 0:x.control),I=n.useMemo(()=>l?new Set(pe):pe,[pe,l]),Le=e=>{if(l){const c=e.changeStatus(e.checked?"UNCHECKED":"CHECKED",I);H(Array.from(c.keys()))}else(e.isLeaf||!E)&&H(e.id),e.isLeaf&&A(!1)},Ae=e=>{if(l){const c=e[R].changeStatus(e[R].checked?"UNCHECKED":"CHECKED",I);H(Array.from(c.keys()))}else H(e[R].id),A(!1)};B.forEach(e=>{e.updateStatus(I)});const{size:Se,disabled:X}=xa({size:d,disabled:T||(x==null?void 0:x.control.disabled)}),F=ue.length>0,fe=l?I.size>0:!W.isNull(I),_e=(()=>{if(!F)return[];const e=W.isUndefined(f==null?void 0:f.filter)?t=>t.label.includes(ue):t=>f.filter(ue,t),c=f==null?void 0:f.sort,i=[],r=t=>{t.forEach(u=>{(!l&&!E||u.isLeaf)&&e(u.origin)&&i.push({label:Ne(u),value:u.id,disabled:u.disabled,[R]:u}),u.children&&r(u.children)})};return r(de),c&&i.sort((t,u)=>c(t[R].origin,u[R].origin)),i})(),Fe=F?_e.length===0:de.length===0,[We,ea]=va(e=>e.startsWith("Arrow")||["Home","End","Enter","Space"].includes(e)),[ze,aa]=n.useState(),He=e=>{oe.current.itemFocused.has(e.id)||(oe.current.itemFocused.add(e.id),L==null||L(e.id,e.origin)),aa(e)},ke=(()=>{if(ze){const e=B.get(ze.id);if(e&&e.enabled)return e}if(fe)return Ce(de,e=>e.enabled&&e.checked)})(),[je,sa]=n.useState(),$e=e=>{oe.current.itemFocused.has(e.value)||(oe.current.itemFocused.add(e.value),L==null||L(e.value,e[R].origin)),sa(e)},ye=(()=>{if(je&&Ce(_e,e=>e[R].enabled&&e.value===je.value))return je;if(F)return Ce(_e,e=>e[R].enabled)})(),ca=Sa(g),ra=`calc(var(--${U}-zindex-fixed) + ${ca})`,Ee=n.useRef(),$=Me(()=>{if(g&&ne.current&&O.current){const e=O.current.offsetHeight,c=ka.windowSize.width-Ue*2,i=Math.min(O.current.scrollWidth,c),r=ja(ne.current,{width:i,height:e},{placement:"bottom-left",inWindow:Ue});Ee.current=r.transformOrigin,ie.classes.position&&O.current.classList.toggle(ie.classes.position,!1),ie.replaceRule("position",{top:r.top,left:r.left,maxWidth:c}),O.current.classList.toggle(ie.classes.position,!0)}}),ta=ya($,!g);Ea(Je,"scroll",$,{passive:!0},!g||ta),Ie(ne,$,void 0,!g),Ie(O,$,void 0,!g),Ie(Ze,$,void 0,!g),n.useImperativeHandle(ee,()=>({updatePosition:$}),[$]);const he=e=>{document.activeElement===le.current&&e.target!==le.current&&e.button===0&&e.preventDefault()},G=n.useRef(),be=D&&g,Ve=m&&fe&&!g&&!v&&!X,Ke=ea(n.createElement(D?Fa:"div",Object.assign({...me(b("cascader__search"),{style:{opacity:be?void 0:0,zIndex:be?void 0:-1}}),...x==null?void 0:x.inputAria,ref:Qe,tabIndex:X?-1:0,role:"combobox","aria-haspopup":"listbox","aria-expanded":g,"aria-controls":xe,onBlur:()=>{A(!1)},onKeyDown:e=>{if(e.code==="Escape")g&&h&&(e.stopPropagation(),e.preventDefault(),A(!1));else{const c=i=>{if(se.current){const r=se.current(i);r&&(F?$e(r):He(r),o===!1&&!i.includes("level")&&(G.current=()=>{const t=document.getElementById(ve(F?r.value:r.id));t&&se.current(t)},g&&(G.current(),G.current=void 0)))}};if(g)switch(e.code){case"ArrowUp":{e.preventDefault(),c("prev");break}case"ArrowDown":{e.preventDefault(),c("next");break}case"ArrowLeft":{F||(e.preventDefault(),c("prev-level"));break}case"ArrowRight":{F||(e.preventDefault(),c("next-level"));break}case"Home":{e.preventDefault(),c("first");break}case"End":{e.preventDefault(),c("last");break}default:{(e.code==="Enter"||e.code==="Space"&&!D)&&(e.preventDefault(),F?ye&&Ae(ye):ke&&Le(ke));break}}else if(!(D&&["Home","End","Enter","Space"].includes(e.code)))switch(e.code){case"End":case"ArrowUp":{e.preventDefault(),A(!0),c("last");break}case"Home":case"ArrowDown":{e.preventDefault(),A(!0),c("first");break}case"Enter":case"Space":{e.preventDefault(),A(!0);break}default:{Wa(e.key)&&A(!0);break}}}}},D?{type:"text",value:ue,autoComplete:"off",disabled:X,onValueChange:e=>{Xe(e)}}:{}))),[ia,na,la]=(()=>{let e=null,c=null,i;if(l){const r=pe.map(t=>{const u=B.get(t);return{value:t,label:a?a(t,u==null?void 0:u.origin):u?u.origin.label:String(t),node:u}});c=s.jsx(wa,{list:r.map(({value:t,label:u,node:M})=>({id:t,title:u,type:"item",disabled:M==null?void 0:M.origin.disabled})),onClick:t=>(H(u=>{u.splice(u.findIndex(M=>M===t),1)}),!1),children:s.jsx(Oe,{tabIndex:-1,size:Se,children:I.size})}),e=r.map(({value:t,label:u,node:M})=>s.jsxs(Oe,{size:Se,children:[u,!(M!=null&&M.disabled||X)&&s.jsx("div",{...b("cascader__close"),role:"button","aria-label":Pe("Close"),onClick:da=>{da.stopPropagation();const ua=M.changeStatus("UNCHECKED",I);H(Array.from(ua.keys()))},children:s.jsx(ce,{children:s.jsx(Ca,{})})})]},t))}else if(!W.isNull(I)){const r=B.get(I);e=i=a?a(I,r==null?void 0:r.origin):r?Ne(r):String(I)}return[e,c,i]})(),oa=Ia({compose:{disabled:X},form:x});return s.jsxs(s.Fragment,{children:[s.jsxs("div",{...C,...me(b("cascader",`cascader--${Se}`,{"cascader.is-expanded":g,"cascader.is-disabled":X}),{className:C.className,style:C.style}),...oa,ref:ne,onMouseDown:e=>{var c;(c=C.onMouseDown)==null||c.call(C,e),he(e)},onMouseUp:e=>{var c;(c=C.onMouseUp)==null||c.call(C,e),he(e)},onClick:e=>{var c,i;(c=C.onClick)==null||c.call(C,e),(i=le.current)==null||i.focus({preventScroll:!0}),A(r=>D?!0:!r)},children:[s.jsxs("div",{...b("cascader__container"),title:la,children:[z?z(Ke):Ke,!be&&(fe?s.jsx("div",{...b("cascader__content"),children:ia}):P?s.jsx("div",{...b("cascader__placeholder-wrapper"),children:s.jsx("div",{...b("cascader__placeholder"),children:P})}):null)]}),l&&s.jsx("div",{...b("cascader__multiple-count"),onClick:e=>{e.stopPropagation()},children:na}),Ve&&s.jsx("div",{...b("cascader__clear"),role:"button","aria-label":Pe("Clear"),onClick:e=>{e.stopPropagation(),S==null||S(),H(l?[]:null)},children:s.jsx(ce,{children:s.jsx(Ma,{})})}),s.jsx("div",{...me(b("cascader__icon"),{style:{visibility:Ve?"hidden":void 0}}),children:s.jsx(ce,{children:v?s.jsx(De,{}):be?s.jsx(Ta,{}):s.jsx(Pa,{...b("cascader__arrow")})})})]}),s.jsx(Ra,{selector:()=>{let e=document.getElementById(`${U}-cascader-root`);return e||(e=document.createElement("div"),e.id=`${U}-cascader-root`,document.body.appendChild(e)),e},children:s.jsx(Da,{enter:g,during:Re,afterRender:()=>{var e;$(),(e=G.current)==null||e.call(G),G.current=void 0},afterEnter:()=>{Q==null||Q(!0)},afterLeave:()=>{Q==null||Q(!1)},children:e=>{let c={};switch(e){case"enter":c={transform:"scaleY(0.7)",opacity:0};break;case"entering":c={transition:["transform","opacity"].map(i=>`${i} ${Re}ms ease-out`).join(", "),transformOrigin:Ee.current};break;case"leaving":c={transform:"scaleY(0.7)",opacity:0,transition:["transform","opacity"].map(i=>`${i} ${Re}ms ease-in`).join(", "),transformOrigin:Ee.current};break;case"leaved":c={display:"none"};break}return s.jsx("div",{...me(b("cascader-popup"),{style:{zIndex:ra,...c}}),ref:O,onMouseDown:i=>{he(i)},onMouseUp:i=>{he(i)},children:(()=>{const i=s.jsxs("div",{...b("cascader-popup__content"),children:[v&&s.jsx("div",{...b("cascader-popup__loading",{"cascader-popup__loading--empty":Fe}),children:s.jsx(ce,{children:s.jsx(De,{})})}),v&&Fe?null:F?s.jsx($a,{ref:se,namespace:U,styled:b,id:xe,list:_e,customItem:N,itemId:ve,itemFocused:ye,multiple:l,onlyLeafSelectable:E,virtual:o,focusVisible:We,onClick:r=>{$e(r),Ae(r)}}):s.jsx(qe,{ref:se,namespace:U,styled:b,id:xe,list:de,customItem:N,itemId:ve,itemSelected:!l&&fe?B.get(I):void 0,itemFocused:ke,multiple:l,virtual:o,focusVisible:We,onFocus:He,onClick:Le})]});return w?w(i):i})()})}})})]})}const cs=n.forwardRef(Ka);export{cs as C};
