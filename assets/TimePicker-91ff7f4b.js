import{r as d,u as Te,a as je,b as Se,x as Ve,Q as Ae,o as Ce,e as Re,c as ie,l as D,O as R,z as Ne,H as ze,g as Ie,R as Be,W as ne,J as Me,i as Fe,k as W,h as $e,M as Pe,j as n,m as L,I as K,P as Oe,n as Ue,N as He,B as We}from"./index-36878000.js";import{u as Le}from"./MdRoute-fb10bd28.js";import{s as Ke}from"./setRef-3b3e71f9.js";import{S as Ge}from"./cancel-144fa015.js";import{d as Je,S as Qe,T as Ze,a as qe}from"./utils-74b8446b.js";import{B as Xe}from"./BaseInput-1a2d2afa.js";const Ye=P=>d.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",...P},d.createElement("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm.5-13H11v6l5.25 3.15.75-1.23-4.5-2.67z"})),et={"time-picker":"^time-picker","time-picker.is-disabled":"is-disabled","time-picker--small":"^time-picker--small","time-picker--medium":"^time-picker--medium","time-picker--large":"^time-picker--large","time-picker__input":"^time-picker__input","time-picker__indicator":"^time-picker__indicator","time-picker__separator":"^time-picker__separator","time-picker__clear":"^time-picker__clear","time-picker__icon":"^time-picker__icon","time-picker-popup":"^time-picker-popup","time-picker__panel":"^time-picker__panel","time-picker__header":"^time-picker__header","time-picker__column":"^time-picker__column","time-picker__cell":"^time-picker__cell","time-picker__cell.is-active":"is-active","time-picker__cell.is-disabled":"is-disabled","time-picker__footer":"^time-picker__footer"};function ot(P){const{ref:ce,styleOverrides:se,styleProvider:T,formControl:p,model:oe,defaultModel:le,visible:ue,defaultVisible:ae,placeholder:G,range:m=!1,format:E="HH:mm:ss",order:de="ascend",clearable:pe=!1,size:me,disabled:fe=!1,config:J,escClosable:_e=!0,inputProps:l,onModelChange:ke,onVisibleChange:ve,onClear:O,afterVisibleChange:j,...a}=Te("TimePicker",P),N=je(),v=Se(et,{"time-picker":T==null?void 0:T["time-picker"],"time-picker-popup":T==null?void 0:T["time-picker-popup"]},se),{t:z}=Ve(),U=Ae(),he=Ce(),{contentResizeRef:ge}=Re(),h=d.useRef(null),f=d.useRef(null),w=d.useRef(null),S=d.useRef(null),V=d.useRef(null),s=d.useRef(null),i=d.useRef({latestFocused:"start",onceVisible:!1,focusAnother:!1,inputValue:[void 0,void 0],rangeDate:[null,null]}),Q=e=>qe(e,de),[_,A]=ie(ae??!1,ue,ve),[g,Z]=Le([!1,!1]);g[0]&&(i.current.latestFocused="start"),g[1]&&(i.current.latestFocused="end");const[C,I]=ie(le??null,oe,ke,(e,r)=>Je(e,r,E),p==null?void 0:p.control);let[x,b=null]=m?C??[null,null]:[C,null];m&&(D.isNull(C)?[x,b]=i.current.rangeDate:i.current.rangeDate=[null,null]);const B=[0,1].map(e=>g[e]&&!D.isUndefined(i.current.inputValue[e])?i.current.inputValue[e]:(()=>{const r=e===0?x:b;return D.isNull(r)?"":R(r).format(E)})()),H=e=>{const r=g.findIndex(t=>t);m?D.isNull(C)?(i.current.rangeDate[r]=e,i.current.rangeDate.every(t=>!D.isNull(t))&&(i.current.focusAnother=Q(i.current.rangeDate),i.current.focusAnother&&i.current.rangeDate.reverse(),i.current.inputValue=[void 0,void 0],I(i.current.rangeDate))):(i.current.inputValue=[void 0,void 0],I(t=>{t[r]=e,i.current.focusAnother=Q(t),i.current.focusAnother&&t.reverse()})):(i.current.inputValue=[void 0,void 0],I(e)),U()},[xe=z("TimePicker",m?"Start time":"Select time"),be=z("TimePicker","End time")]=m?G??[]:[G],{size:ye,disabled:M}=Ne({size:me,disabled:fe||(p==null?void 0:p.control.disabled)}),Ee=ze(_),we=`calc(var(--${N}-zindex-fixed) + ${Ee})`,y=Ie(()=>{if(_&&h.current&&f.current){const e=f.current.offsetHeight,r=Be.windowSize.width-ne*2,t=Math.min(f.current.scrollWidth,r),k=Me(h.current,{width:t,height:e},{placement:"bottom-left",inWindow:ne});f.current.style.setProperty("--popup-down-transform-origin",k.transformOrigin),f.current.style.top=k.top+"px",f.current.style.left=k.left+"px",f.current.style.maxWidth=r+"px"}});Fe(h,y,!_),W(h,y,void 0,!_),W(f,y,void 0,!_),W(ge,y,void 0,!_),d.useImperativeHandle(ce,()=>({updatePosition:y}),[y]),$e(()=>{if(h.current&&V.current){let e=!1;const r=h.current.getBoundingClientRect();if(w.current&&document.activeElement===w.current){const t=w.current.getBoundingClientRect();V.current.style.cssText=`left:${t.left-r.left}px;width:${t.width}px;opacity:1;`,e=!0}if(S.current&&document.activeElement===S.current){const t=S.current.getBoundingClientRect();V.current.style.cssText=`left:${t.left-r.left}px;width:${t.width}px;opacity:1;`,e=!0}e||(V.current.style.cssText+="opacity:0;")}}),d.useEffect(()=>{if(i.current.focusAnother&&document.activeElement){const e=document.activeElement.parentElement;for(let r=0;r<e.childElementCount;r++){const t=e.children.item(r);if(t.tagName.toLowerCase()==="input"&&t!==document.activeElement){t.focus({preventScroll:!0});break}}}i.current.focusAnother=!1});const q=e=>{var r;if(m){const t=g.findIndex(k=>k);D.isNull(t===0?b:x)?(i.current.focusAnother=!0,U()):A(!1)}else A(!1);i.current.focusAnother||(r=s.current)==null||r.call(s,e)},X=pe&&!D.isNull(C)&&!_&&!M,Y=e=>{const r=e?0:1,t=e?x:b,k=e?w:S;return n.jsx(Xe,{...l==null?void 0:l[r],...v("time-picker__input"),...p==null?void 0:p.inputAria,ref:o=>{var u;k.current=o;const c=Ke((u=l==null?void 0:l[r])==null?void 0:u.ref,o);return()=>{k.current=null,c()}},type:"text",autoComplete:"off",value:B[r],size:10,placeholder:e?xe:be,disabled:M,onValueChange:o=>{var c;if(U(),i.current.inputValue[r]=o,R(o,E,!0).isValid()){const u=R(o,E).toDate();H(u),(c=s.current)==null||c.call(s,u)}},onKeyDown:o=>{var c,u;if((u=(c=l==null?void 0:l[r])==null?void 0:c.onKeyDown)==null||u.call(c,o),o.code==="Escape")_&&_e&&(o.stopPropagation(),o.preventDefault(),A(!1));else if(o.code==="Enter"&&B[r]&&R(B[r],E,!0).isValid()){o.preventDefault();const $=R(B[r],E).toDate();q($)}},onFocus:o=>{var c,u,$,ee,te;(u=(c=l==null?void 0:l[r])==null?void 0:c.onFocus)==null||u.call(c,o),(ee=($=i.current).clearTid)==null||ee.call($),Z(re=>{re.fill(!1),re[e?0:1]=!0}),i.current.inputValue=[void 0,void 0],_&&m&&t&&((te=s.current)==null||te.call(s,t))},onBlur:o=>{var c,u;(u=(c=l==null?void 0:l[r])==null?void 0:c.onBlur)==null||u.call(c,o),i.current.clearTid=he.setTimeout(()=>{Z([!1,!1]),A(!1)},20)}})},F=e=>{(document.activeElement===w.current||document.activeElement===S.current)&&e.target!==w.current&&e.target!==S.current&&e.button===0&&e.preventDefault()},De=Pe({compose:{disabled:M},form:p});return n.jsxs(n.Fragment,{children:[n.jsxs("div",{...a,...L(v("time-picker",`time-picker--${ye}`,{"time-picker.is-disabled":M}),{className:a.className,style:a.style}),...De,ref:e=>(h.current=e,()=>{h.current=null}),onMouseDown:e=>{var r;(r=a.onMouseDown)==null||r.call(a,e),F(e)},onMouseUp:e=>{var r;(r=a.onMouseUp)==null||r.call(a,e),F(e)},onClick:e=>{var r,t;(r=a.onClick)==null||r.call(a,e),g.some(k=>k)||(t=w.current)==null||t.focus({preventScroll:!0}),A(!0)},children:[Y(!0),m&&n.jsxs(n.Fragment,{children:[n.jsx("div",{...v("time-picker__indicator"),ref:e=>(V.current=e,()=>{V.current=null})}),n.jsx("div",{...v("time-picker__separator"),children:n.jsx(K,{children:n.jsx(Qe,{})})}),Y(!1)]}),X&&n.jsx("div",{...v("time-picker__clear"),role:"button","aria-label":z("Clear"),onClick:e=>{e.stopPropagation(),i.current.inputValue=[void 0,void 0],I(null),O==null||O()},children:n.jsx(K,{children:n.jsx(Ge,{})})}),n.jsx("div",{...L(v("time-picker__icon"),{style:{visibility:X?"hidden":void 0}}),children:n.jsx(K,{children:n.jsx(Ye,{})})})]}),n.jsx(Oe,{selector:()=>{let e=document.getElementById(`${N}-time-picker-root`);return e||(e=document.createElement("div"),e.id=`${N}-time-picker-root`,document.body.appendChild(e)),e},children:n.jsx(Ue,{enter:_,name:`${N}-popup-down`,duration:He,onSkipEnter:()=>{y();const e=()=>{var t;const r=g[0]?x:b;r&&((t=s.current)==null||t.call(s,r))};m?e():i.current.onceVisible||(i.current.onceVisible=!0,e())},onBeforeEnter:()=>{y();const e=()=>{var t;const r=g[0]?x:b;r&&((t=s.current)==null||t.call(s,r))};m?e():i.current.onceVisible||(i.current.onceVisible=!0,e())},onAfterEnter:()=>{j==null||j(!0)},onAfterLeave:()=>{j==null||j(!1)},children:(e,r)=>n.jsxs("div",{...L(v("time-picker-popup"),{style:{zIndex:we,...r?{display:"none"}:void 0}}),ref:t=>(f.current=t,e(t),()=>{f.current=null,e(null)}),onMouseDown:t=>{F(t)},onMouseUp:t=>{F(t)},children:[n.jsx(Ze,{ref:t=>(s.current=t,()=>{s.current=null}),styled:v,time:i.current.latestFocused==="start"?x:b,format:E,config:J?(...t)=>J(...t,i.current.latestFocused,[x,b]):void 0,onTimeChange:t=>{H(t)}}),n.jsx("div",{...v("time-picker__footer"),children:n.jsx(We,{pattern:"link",onClick:()=>{const t=new Date;H(t),q(t)},children:z("TimePicker","Now")})})]})})})]})}export{ot as T};
