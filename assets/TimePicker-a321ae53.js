import{r as d,u as Te,a as je,b as Se,w as Ve,O as Ae,n as Ce,d as Re,c as ie,l as D,N as R,y as Ne,G as Ie,f as ze,H as Be,h as Me,i as W,g as Fe,K as $e,j as n,m as L,I as K,P as Pe,k as Oe,M as Ue,B as He,R as We,W as ne}from"./index-ca0623a3.js";import{u as Le}from"./MdRoute-8e6660ce.js";import{s as Ke}from"./setRef-3431fe00.js";import{S as Ge}from"./cancel-021eb944.js";import{d as Ze,S as qe,T as Je,a as Qe}from"./utils-590200ca.js";import{B as Xe}from"./BaseInput-7b978962.js";const Ye=P=>d.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",...P},d.createElement("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm.5-13H11v6l5.25 3.15.75-1.23-4.5-2.67z"})),et={"time-picker":"^time-picker","time-picker.is-disabled":"is-disabled","time-picker--small":"^time-picker--small","time-picker--medium":"^time-picker--medium","time-picker--large":"^time-picker--large","time-picker__input":"^time-picker__input","time-picker__indicator":"^time-picker__indicator","time-picker__separator":"^time-picker__separator","time-picker__clear":"^time-picker__clear","time-picker__icon":"^time-picker__icon","time-picker-popup":"^time-picker-popup","time-picker__panel":"^time-picker__panel","time-picker__header":"^time-picker__header","time-picker__column":"^time-picker__column","time-picker__cell":"^time-picker__cell","time-picker__cell.is-active":"is-active","time-picker__cell.is-disabled":"is-disabled","time-picker__footer":"^time-picker__footer"};function ot(P){const{ref:ce,styleOverrides:se,styleProvider:T,formControl:p,model:oe,defaultModel:le,visible:ue,defaultVisible:ae,placeholder:G,range:m=!1,format:w="HH:mm:ss",order:de="ascend",clearable:pe=!1,size:me,disabled:fe=!1,config:Z,escClosable:ke=!0,inputProps:l,onModelChange:ve,onVisibleChange:he,onClear:O,afterVisibleChange:j,...a}=Te("TimePicker",P),N=je(),h=Se(et,{"time-picker":T==null?void 0:T["time-picker"],"time-picker-popup":T==null?void 0:T["time-picker-popup"]},se),{t:I}=Ve(),U=Ae(),_e=Ce(),{contentResizeRef:ge}=Re(),_=d.useRef(null),f=d.useRef(null),E=d.useRef(null),S=d.useRef(null),V=d.useRef(null),s=d.useRef(null),i=d.useRef({latestFocused:"start",onceVisible:!1,focusAnother:!1,inputValue:[void 0,void 0],rangeDate:[null,null]}),q=e=>Qe(e,de),[k,A]=ie(ae??!1,ue,he),[g,J]=Le([!1,!1]);g[0]&&(i.current.latestFocused="start"),g[1]&&(i.current.latestFocused="end");const[C,z]=ie(le??null,oe,ve,(e,r)=>Ze(e,r,w),p==null?void 0:p.control);let[x,b=null]=m?C??[null,null]:[C,null];m&&(D.isNull(C)?[x,b]=i.current.rangeDate:i.current.rangeDate=[null,null]);const B=[0,1].map(e=>g[e]&&!D.isUndefined(i.current.inputValue[e])?i.current.inputValue[e]:(()=>{const r=e===0?x:b;return D.isNull(r)?"":R(r).format(w)})()),H=e=>{const r=g.findIndex(t=>t);m?D.isNull(C)?(i.current.rangeDate[r]=e,i.current.rangeDate.every(t=>!D.isNull(t))&&(i.current.focusAnother=q(i.current.rangeDate),i.current.focusAnother&&i.current.rangeDate.reverse(),i.current.inputValue=[void 0,void 0],z(i.current.rangeDate))):(i.current.inputValue=[void 0,void 0],z(t=>{t[r]=e,i.current.focusAnother=q(t),i.current.focusAnother&&t.reverse()})):(i.current.inputValue=[void 0,void 0],z(e)),U()},[xe=I("TimePicker",m?"Start time":"Select time"),be=I("TimePicker","End time")]=m?G??[]:[G],{size:ye,disabled:M}=Ne({size:me,disabled:fe||(p==null?void 0:p.control.disabled)}),we=Ie(k),Ee=`calc(var(--${N}-zindex-fixed) + ${we})`,y=ze(()=>{if(k&&_.current&&f.current){const e=f.current.offsetHeight,r=We.windowSize.width-ne*2,t=Math.min(f.current.scrollWidth,r),v=Be(_.current,{width:t,height:e},{placement:"bottom-left",inWindow:ne});f.current.style.setProperty("--popup-down-transform-origin",v.transformOrigin),f.current.style.top=v.top+"px",f.current.style.left=v.left+"px",f.current.style.maxWidth=r+"px"}});Me(_,y,!k),W(_,y,void 0,!k),W(f,y,void 0,!k),W(ge,y,void 0,!k),d.useImperativeHandle(ce,()=>({updatePosition:y}),[y]),Fe(()=>{if(_.current&&V.current){let e=!1;const r=_.current.getBoundingClientRect();if(E.current&&document.activeElement===E.current){const t=E.current.getBoundingClientRect();V.current.style.cssText=`left:${t.left-r.left}px;width:${t.width}px;opacity:1;`,e=!0}if(S.current&&document.activeElement===S.current){const t=S.current.getBoundingClientRect();V.current.style.cssText=`left:${t.left-r.left}px;width:${t.width}px;opacity:1;`,e=!0}e||(V.current.style.cssText+="opacity:0;")}}),d.useEffect(()=>{if(i.current.focusAnother&&document.activeElement){const e=document.activeElement.parentElement;for(let r=0;r<e.childElementCount;r++){const t=e.children.item(r);if(t.tagName.toLowerCase()==="input"&&t!==document.activeElement){t.focus({preventScroll:!0});break}}}i.current.focusAnother=!1});const Q=e=>{var r;if(m){const t=g.findIndex(v=>v);D.isNull(t===0?b:x)?(i.current.focusAnother=!0,U()):A(!1)}else A(!1);i.current.focusAnother||(r=s.current)==null||r.call(s,e)},X=pe&&!D.isNull(C)&&!k&&!M,Y=e=>{const r=e?0:1,t=e?x:b,v=e?E:S;return n.jsx(Xe,{...l==null?void 0:l[r],...h("time-picker__input"),...p==null?void 0:p.inputAria,ref:o=>{var u;v.current=o;const c=Ke((u=l==null?void 0:l[r])==null?void 0:u.ref,o);return()=>{v.current=null,c()}},type:"text",autoComplete:"off",value:B[r],size:10,placeholder:e?xe:be,disabled:M,onValueChange:o=>{var c;if(U(),i.current.inputValue[r]=o,R(o,w,!0).isValid()){const u=R(o,w).toDate();H(u),(c=s.current)==null||c.call(s,u)}},onKeyDown:o=>{var c,u;if((u=(c=l==null?void 0:l[r])==null?void 0:c.onKeyDown)==null||u.call(c,o),o.code==="Escape")k&&ke&&(o.stopPropagation(),o.preventDefault(),A(!1));else if(o.code==="Enter"&&B[r]&&R(B[r],w,!0).isValid()){o.preventDefault();const $=R(B[r],w).toDate();Q($)}},onFocus:o=>{var c,u,$,ee,te;(u=(c=l==null?void 0:l[r])==null?void 0:c.onFocus)==null||u.call(c,o),(ee=($=i.current).clearTid)==null||ee.call($),J(re=>{re.fill(!1),re[e?0:1]=!0}),i.current.inputValue=[void 0,void 0],k&&m&&t&&((te=s.current)==null||te.call(s,t))},onBlur:o=>{var c,u;(u=(c=l==null?void 0:l[r])==null?void 0:c.onBlur)==null||u.call(c,o),i.current.clearTid=_e.setTimeout(()=>{J([!1,!1]),A(!1)},20)}})},F=e=>{(document.activeElement===E.current||document.activeElement===S.current)&&e.target!==E.current&&e.target!==S.current&&e.button===0&&e.preventDefault()},De=$e({compose:{disabled:M},form:p});return n.jsxs(n.Fragment,{children:[n.jsxs("div",{...a,...L(h("time-picker",`time-picker--${ye}`,{"time-picker.is-disabled":M}),{className:a.className,style:a.style}),...De,ref:e=>(_.current=e,()=>{_.current=null}),onMouseDown:e=>{var r;(r=a.onMouseDown)==null||r.call(a,e),F(e)},onMouseUp:e=>{var r;(r=a.onMouseUp)==null||r.call(a,e),F(e)},onClick:e=>{var r,t;(r=a.onClick)==null||r.call(a,e),g.some(v=>v)||(t=E.current)==null||t.focus({preventScroll:!0}),A(!0)},children:[Y(!0),m&&n.jsxs(n.Fragment,{children:[n.jsx("div",{...h("time-picker__indicator"),ref:e=>(V.current=e,()=>{V.current=null})}),n.jsx("div",{...h("time-picker__separator"),children:n.jsx(K,{children:n.jsx(qe,{})})}),Y(!1)]}),X&&n.jsx("div",{...h("time-picker__clear"),role:"button","aria-label":I("Clear"),onClick:e=>{e.stopPropagation(),i.current.inputValue=[void 0,void 0],z(null),O==null||O()},children:n.jsx(K,{children:n.jsx(Ge,{})})}),n.jsx("div",{...L(h("time-picker__icon"),{style:{visibility:X?"hidden":void 0}}),children:n.jsx(K,{children:n.jsx(Ye,{})})})]}),n.jsx(Pe,{selector:()=>{let e=document.getElementById(`${N}-time-picker-root`);return e||(e=document.createElement("div"),e.id=`${N}-time-picker-root`,document.body.appendChild(e)),e},children:n.jsx(Oe,{enter:k,name:`${N}-popup-down`,duration:Ue,onSkipEnter:()=>{y();const e=()=>{var t;const r=g[0]?x:b;r&&((t=s.current)==null||t.call(s,r))};m?e():i.current.onceVisible||(i.current.onceVisible=!0,e())},onBeforeEnter:()=>{y();const e=()=>{var t;const r=g[0]?x:b;r&&((t=s.current)==null||t.call(s,r))};m?e():i.current.onceVisible||(i.current.onceVisible=!0,e())},onAfterEnter:()=>{j==null||j(!0)},onAfterLeave:()=>{j==null||j(!1)},children:(e,r)=>n.jsxs("div",{...L(h("time-picker-popup"),{style:{zIndex:Ee,...r?{display:"none"}:void 0}}),ref:t=>(f.current=t,e(t),()=>{f.current=null,e(null)}),onMouseDown:t=>{F(t)},onMouseUp:t=>{F(t)},children:[n.jsx(Je,{ref:t=>(s.current=t,()=>{s.current=null}),styled:h,time:i.current.latestFocused==="start"?x:b,format:w,config:Z?(...t)=>Z(...t,i.current.latestFocused,[x,b]):void 0,onTimeChange:t=>{H(t)}}),n.jsx("div",{...h("time-picker__footer"),children:n.jsx(He,{pattern:"link",onClick:()=>{const t=new Date;H(t),Q(t)},children:I("TimePicker","Now")})})]})})})]})}export{ot as T};
