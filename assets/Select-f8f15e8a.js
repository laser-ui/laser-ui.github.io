import{u as dt,a as ut,b as pt,w as ft,r as p,d as _t,c as _e,l as y,z as ht,F as mt,G as se,H as xt,f as bt,R as ke,W as le,J as De,h as vt,i as he,j as l,p as gt,I as G,K as St,M as jt,m as F,q as Ce,P as yt,k as wt,N as Et,V as It}from"./index-552cf36d.js";import{s as kt}from"./scrollIntoViewIfNeeded-1a86a4ce.js";import{s as Dt}from"./setRef-2413c11d.js";import{S as Ct}from"./cancel-b83fd65f.js";import{S as Rt}from"./add-22c7128a.js";import{S as Nt}from"./keyboard_arrow_down-9917dd5a.js";import{S as Wt}from"./search-2a521a2f.js";import{T as Re}from"./Tag-8ce7c52a.js";import{i as Mt}from"./isPrintableCharacter-1b5c27a6.js";import{B as zt}from"./BaseInput-aa17ca81.js";import{C as At}from"./Checkbox-267c7d9b.js";import{E as Ne}from"./Empty-8ec76c5e.js";const Ft={select:"^select","select.is-expanded":"is-expanded","select.is-disabled":"is-disabled","select--small":"^select--small","select--medium":"^select--medium","select--large":"^select--large",select__container:"^select__container",select__content:"^select__content",select__search:"^select__search","select__placeholder-wrapper":"^select__placeholder-wrapper",select__placeholder:"^select__placeholder","select__multiple-count":"^select__multiple-count",select__close:"^select__close",select__clear:"^select__clear",select__icon:"^select__icon",select__arrow:"^select__arrow","select-popup":"^select-popup","select-popup__content":"^select-popup__content","select-popup__loading":"^select-popup__loading","select-popup__loading--empty":"^select-popup__loading--empty",select__list:"^select__list",select__option:"^select__option","select__option.is-selected":"is-selected","select__option.is-disabled":"is-disabled","select__option-prefix":"^select__option-prefix","select__option-content":"^select__option-content","select__option-group":"^select__option-group","select__option-group-label":"^select__option-group-label",select__empty:"^select__empty"},V=Symbol();function Jt(We){const{ref:Me,styleOverrides:ze,styleProvider:D,formControl:b,list:C,model:Ae,defaultModel:Fe,visible:Ve,defaultVisible:Te,placeholder:me,multiple:f=!1,searchable:R=!1,searchValue:$e,defaultSearchValue:Be,clearable:Le=!1,loading:q=!1,size:Ue,disabled:Oe=!1,monospaced:Pe=!0,virtual:N=!1,escClosable:He=!0,customItem:xe,customSelected:J,customSearch:w,createItem:ne,inputProps:r,popupRender:be,onModelChange:ce,onVisibleChange:Ke,onSearch:Ge,onClear:oe,onCreateItem:re,onScrollBottom:qe,afterVisibleChange:W,...h}=dt("Select",We),E=ut(),o=pt(Ft,{select:D==null?void 0:D.select,"select-popup":D==null?void 0:D["select-popup"]},ze),{t:Z}=ft(),ve=p.useId(),ge=`${E}-select-list-${ve}`,T=e=>`${E}-select-item-${e}-${ve}`,{contentResizeRef:Je}=_t(),v=p.useRef(null),i=p.useRef(null),g=p.useRef(null),$=p.useRef(null),M=p.useRef(null),B=p.useMemo(()=>{const e=new Map,t=s=>{for(const n of s)e.set(n.value,n),n.children&&t(n.children)};return t(C),e},[C]),[_,S]=_e(Te??!1,Ve,Ke),[L,Ze]=_e(Be??"",$e,Ge),I=p.useCallback(e=>!e.disabled&&!e.children,[]),[Q,X]=_e(Fe??(f?[]:null),Ae,e=>{ce&&(f?ce(e,e.map(t=>B.get(t))):ce(e,y.isNull(e)?null:B.get(e)))},void 0,b==null?void 0:b.control),x=p.useMemo(()=>f?new Set(Q):Q,[Q,f]),Y=e=>{f?X(t=>{const s=t.findIndex(n=>n===e);s!==-1?t.splice(s,1):t.push(e)}):(X(e),S(!1))},{size:ie,disabled:z}=ht({size:Ue,disabled:Oe||(b==null?void 0:b.control.disabled)}),U=L.length>0,ae=f?x.size>0:!y.isNull(x),de=(()=>{if(!U)return[];const e=y.isUndefined(w==null?void 0:w.filter)?c=>c.label.includes(L):c=>w.filter(L,c),t=w==null?void 0:w.sort;let s=ne==null?void 0:ne(L);s&&(s={...s,[V]:!0});let n=[];return C.forEach(c=>{if(!c.children)s&&c.value===s.value&&(s=void 0),e(c)&&n.push(c);else{const a=[];c.children.forEach(d=>{s&&d.value===s.value&&(s=void 0),e(d)&&a.push(d)}),n=n.concat(a)}}),t&&n.sort(t),s&&n.unshift(s),n})(),O=U?de:C,[Qe,ue]=mt(e=>e.startsWith("Arrow")||["Home","End","Enter","Space"].includes(e)),[Se,Xe]=p.useState(),Ye=(()=>{let e;return Se&&(e=B.get(Se.value),e&&I(e))||(ae&&(e=se(C,t=>I(t)&&f?x.has(t.value):x===t.value)),y.isUndefined(e)&&(e=se(C,t=>I(t)))),e})(),[pe,et]=p.useState(),tt=(()=>{if(pe&&se(de,e=>I(e)&&e.value===pe.value))return pe;if(U)return se(de,e=>I(e))})(),m=U?tt:Ye,je=e=>{U?et(e):Xe(e)},ye=e=>{if(!y.isUndefined(e)){const t=Object.assign({},e);delete t[V],re==null||re(t)}},st=xt(_),lt=`calc(var(--${E}-zindex-fixed) + ${st})`,j=bt(()=>{if(_&&v.current&&i.current)if(Pe){const e=Math.min(v.current.offsetWidth,ke.windowSize.width-le*2),t=i.current.offsetHeight,s=De(v.current,{width:e,height:t},{placement:"bottom",inWindow:le});i.current.style.setProperty("--popup-down-transform-origin",s.transformOrigin),i.current.style.top=s.top+"px",i.current.style.left=s.left+"px",i.current.style.width=e+"px",i.current.style.minWidth="",i.current.style.maxWidth=""}else{const e=v.current.offsetWidth,t=i.current.offsetHeight,s=ke.windowSize.width-le*2,n=Math.min(Math.max(i.current.scrollWidth,e),s),c=De(v.current,{width:n,height:t},{placement:"bottom-left",inWindow:le});i.current.style.setProperty("--popup-down-transform-origin",c.transformOrigin),i.current.style.top=c.top+"px",i.current.style.left=c.left+"px",i.current.style.width="",i.current.style.minWidth=Math.min(e,s)+"px",i.current.style.maxWidth=s+"px"}});vt(v,j,!_),he(v,j,void 0,!_),he(i,j,void 0,!_),he(Je,j,void 0,!_),p.useImperativeHandle(Me,()=>({updatePosition:j}),[j]);const ee=e=>{document.activeElement===$.current&&e.target!==$.current&&e.button===0&&e.preventDefault()},P=p.useRef(()=>{}),te=R&&_,we=Le&&ae&&!_&&!q&&!z,[nt,ct,ot]=(()=>{let e=null,t=null,s;if(f){const n=Q.map(c=>{const a=B.get(c);return{value:c,label:J?J(c,a):a?a.label:String(c),item:a}});t=l.jsx(gt,{list:n.map(({value:c,label:a,item:d})=>({id:c,title:a,type:"item",disabled:d==null?void 0:d.disabled})),virtual:N,onClick:c=>(Y(c),!1),children:c=>l.jsx(Re,{...c,tabIndex:-1,size:ie,children:x.size})}),e=n.map(({value:c,label:a,item:d})=>l.jsxs(Re,{size:ie,children:[a,!(d!=null&&d.disabled||z)&&l.jsx("div",{...o("select__close"),role:"button","aria-label":Z("Close"),onClick:k=>{k.stopPropagation(),Y(c)},children:l.jsx(G,{children:l.jsx(St,{})})})]},c))}else if(!y.isNull(x)){const n=B.get(x);e=s=J?J(x,n):n?n.label:String(x)}return[e,t,s]})(),rt=jt({compose:{disabled:z},form:b}),it=p.useMemo(()=>({list:O,itemKey:e=>e.value,itemSize:y.isNumber(N)?N:32,itemEmptySize:32,itemNested:e=>e.children,itemFocusable:I}),[I,O,N]);return l.jsxs(l.Fragment,{children:[l.jsxs("div",{...h,...F(o("select",`select--${ie}`,{"select.is-expanded":_,"select.is-disabled":z}),{className:h.className,style:h.style}),...rt,ref:e=>(v.current=e,()=>{v.current=null}),onMouseDown:e=>{var t;(t=h.onMouseDown)==null||t.call(h,e),ee(e)},onMouseUp:e=>{var t;(t=h.onMouseUp)==null||t.call(h,e),ee(e)},onClick:e=>{var t,s;(t=h.onClick)==null||t.call(h,e),(s=$.current)==null||s.focus({preventScroll:!0}),S(n=>R?!0:!n)},children:[l.jsxs("div",{...o("select__container"),title:ot,children:[(()=>{const e=Object.assign({...r,...F(o("select__search"),{style:{opacity:te?void 0:0,zIndex:te?void 0:-1}}),...b==null?void 0:b.inputAria,ref:t=>{$.current=t;const s=Dt(r==null?void 0:r.ref,t);return()=>{$.current=null,s()}},tabIndex:z?-1:0,role:"combobox","aria-haspopup":"listbox","aria-expanded":_,"aria-controls":ge,onFocus:t=>{var s;(s=r==null?void 0:r.onFocus)==null||s.call(r,t),ue.onFocus(t)},onBlur:t=>{var s;(s=r==null?void 0:r.onBlur)==null||s.call(r,t),ue.onBlur(t),S(!1)},onKeyDown:t=>{var s;if((s=r==null?void 0:r.onKeyDown)==null||s.call(r,t),ue.onKeyDown(t),t.code==="Escape")_&&He&&(t.stopPropagation(),t.preventDefault(),S(!1));else{const n=c=>{var a,d,k,H;if(g.current){let u;switch(c){case"next":u=(a=M.current)==null?void 0:a.scrollToStep(g.current,1);break;case"prev":u=(d=M.current)==null?void 0:d.scrollToStep(g.current,-1);break;case"first":u=(k=M.current)==null?void 0:k.scrollToStart(g.current);break;case"last":u=(H=M.current)==null?void 0:H.scrollToEnd(g.current);break}u&&(je(u),N===!1&&(P.current=()=>{P.current=()=>{};const A=document.getElementById(T(u.value));A&&kt(A,g.current)},_&&P.current()))}};if(_)switch(t.code){case"ArrowUp":{t.preventDefault(),n("prev");break}case"ArrowDown":{t.preventDefault(),n("next");break}case"Home":{t.preventDefault(),n("first");break}case"End":{t.preventDefault(),n("last");break}default:{(t.code==="Enter"||t.code==="Space"&&!R)&&(t.preventDefault(),m&&(m[V]&&ye(m),Y(m.value)));break}}else if(!(R&&["Home","End","Enter","Space"].includes(t.code)))switch(t.code){case"End":case"ArrowUp":{t.preventDefault(),S(!0),n("last");break}case"Home":case"ArrowDown":{t.preventDefault(),S(!0),n("first");break}case"Enter":case"Space":{t.preventDefault(),S(!0);break}default:{Mt(t.key)&&S(!0);break}}}}},R?{type:"text",value:L,autoComplete:"off",disabled:z,onValueChange:t=>{Ze(t)}}:{});return R?l.jsx(zt,{...e}):l.jsx("div",{...e})})(),!te&&(ae?l.jsx("div",{...o("select__content"),children:nt}):me?l.jsx("div",{...o("select__placeholder-wrapper"),children:l.jsx("div",{...o("select__placeholder"),children:me})}):null)]}),f&&l.jsx("div",{...o("select__multiple-count"),onClick:e=>{e.stopPropagation()},children:ct}),we&&l.jsx("div",{...o("select__clear"),role:"button","aria-label":Z("Clear"),onClick:e=>{e.stopPropagation(),X(f?[]:null),oe==null||oe()},children:l.jsx(G,{children:l.jsx(Ct,{})})}),l.jsx("div",{...F(o("select__icon"),{style:{visibility:we?"hidden":void 0}}),children:l.jsx(G,{children:q?l.jsx(Ce,{}):te?l.jsx(Wt,{}):l.jsx(Nt,{...o("select__arrow")})})})]}),l.jsx(yt,{selector:()=>{let e=document.getElementById(`${E}-select-root`);return e||(e=document.createElement("div"),e.id=`${E}-select-root`,document.body.appendChild(e)),e},children:l.jsx(wt,{enter:_,name:`${E}-popup-down`,duration:Et,onSkipEnter:()=>{j(),P.current()},onBeforeEnter:()=>{j(),P.current()},onAfterEnter:()=>{W==null||W(!0)},onAfterLeave:()=>{W==null||W(!1)},children:(e,t)=>l.jsx("div",{...F(o("select-popup"),{style:{zIndex:lt,...t?{display:"none"}:void 0}}),ref:s=>(i.current=s,e(s),()=>{i.current=null,e(null)}),onMouseDown:s=>{ee(s)},onMouseUp:s=>{ee(s)},children:(()=>{const s=l.jsxs("div",{...o("select-popup__content"),children:[q&&l.jsx("div",{...o("select-popup__loading",{"select-popup__loading--empty":O.length===0}),children:l.jsx(G,{children:l.jsx(Ce,{})})}),q&&O.length===0?null:l.jsx(It,{...it,ref:n=>(M.current=n,()=>{M.current=null}),enable:N!==!1,listSize:264,listPadding:4,itemRender:(n,c,a,d,k)=>{const{label:H,value:u,disabled:A}=n,Ee=xe?xe(n):H;if(k){const at=(()=>{let Ie=1;for(let fe=d.length-1;fe>-1;fe--)d[fe].children&&(Ie+=1);return Ie})();return l.jsxs(p.Fragment,{children:[l.jsx("li",{...o("select__option-group-label"),id:T(u),role:"presentation",children:l.jsx("div",{...o("select__option-content"),children:Ee})}),l.jsx("ul",{...F(o("select__option-group"),{style:{"--level":at}}),role:"group","aria-labelledby":T(u),children:k})]},u)}let K=!1;return f?K=x.has(u):K=x===u,p.createElement("li",{...o("select__option",{"select__option.is-selected":!f&&K,"select__option.is-disabled":A}),...a,key:u,id:T(u),title:(n[V]?Z("Create")+" ":"")+H,role:"option","aria-selected":K,"aria-disabled":A,onClick:()=>{n[V]&&ye(n),je(n),Y(u)}},Qe&&(m==null?void 0:m.value)===u&&l.jsx("div",{className:`${E}-focus-outline`}),n[V]?l.jsx("div",{...o("select__option-prefix"),children:l.jsx(G,{theme:"primary",children:l.jsx(Rt,{})})}):f?l.jsx("div",{...o("select__option-prefix"),children:l.jsx(At,{model:K,disabled:A})}):null,l.jsx("div",{...o("select__option-content"),children:Ee}))},itemFocused:m==null?void 0:m.value,itemEmptyRender:()=>l.jsx("li",{...F(o("select__empty"),{style:{paddingLeft:20}}),children:l.jsx("div",{...o("select__option-content"),children:Z("No data")})}),itemInAriaSetsize:n=>!n.children,placeholder:"li",onScrollEnd:qe,children:(n,c)=>l.jsx("ul",{...o("select__list"),ref:a=>(g.current=a,()=>{g.current=null}),id:ge,tabIndex:-1,role:"listbox","aria-multiselectable":f,"aria-activedescendant":y.isUndefined(m)?void 0:T(m.value),onScroll:c,children:O.length===0?l.jsx(Ne,{style:{padding:"12px 0"},image:Ne.SIMPLE_IMG}):n})})]});return be?be(s):s})()})})})]})}export{Jt as S};
