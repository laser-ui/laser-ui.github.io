import{r as i,u as ht,a as mt,b as bt,d as gt,v as xt,e as vt,c as fe,l as j,x as St,F as jt,G as se,H as yt,g as wt,R as Re,W as le,J as De,h as Et,i as It,k as _e,m as W,j as l,p as kt,I as B,K as Rt,L as Dt,q as Ce,P as Ct,n as Mt,M as he,A as Nt}from"./index-c9b2dbe1.js";import{u as Pt}from"./useForkRef-6becedc9.js";import{S as Wt}from"./cancel-db1e49af.js";import{S as Lt}from"./add-90962039.js";import{S as zt}from"./keyboard_arrow_down-4e2cf67d.js";import{S as At}from"./search-27acc594.js";import{i as Tt}from"./isPrintableCharacter-1b5c27a6.js";import{T as Me}from"./Tag-fa4ed9b6.js";import{V as $t}from"./VirtualScroll-f395908e.js";import{C as Ft}from"./Checkbox-14cb154c.js";import{E as Ne}from"./Empty-98d82b26.js";const Ot={select:"^select","select.is-expanded":"is-expanded","select.is-disabled":"is-disabled","select--small":"^select--small","select--medium":"^select--medium","select--large":"^select--large",select__container:"^select__container",select__content:"^select__content",select__search:"^select__search","select__placeholder-wrapper":"^select__placeholder-wrapper",select__placeholder:"^select__placeholder","select__multiple-count":"^select__multiple-count",select__close:"^select__close",select__clear:"^select__clear",select__icon:"^select__icon",select__arrow:"^select__arrow","select-popup":"^select-popup","select-popup__content":"^select-popup__content","select-popup__loading":"^select-popup__loading","select-popup__loading--empty":"^select-popup__loading--empty",select__list:"^select__list",select__option:"^select__option","select__option.is-selected":"is-selected","select__option.is-disabled":"is-disabled","select__option-prefix":"^select__option-prefix","select__option-content":"^select__option-content","select__option-group":"^select__option-group","select__option-group-label":"^select__option-group-label",select__empty:"^select__empty"},L=Symbol();function Vt(Pe,We){const{styleOverrides:Le,styleProvider:D,formControl:m,list:C,model:ze,defaultModel:Ae,visible:Te,defaultVisible:$e,placeholder:me,multiple:u=!1,searchable:y=!1,searchValue:Fe,defaultSearchValue:Oe,clearable:Ve=!1,loading:G=!1,size:Ue,disabled:He=!1,monospaced:Be=!0,virtual:z=!1,escClosable:Ge=!0,customItem:be,customSelected:K,customSearch:w,createItem:ne,inputRef:Ke,inputRender:ge,popupRender:xe,onModelChange:oe,onVisibleChange:qe,onSearch:Je,onClear:ce,onCreateItem:ie,onScrollBottom:Ye,afterVisibleChange:M,...p}=ht("Select",Pe),N=mt(),c=bt(Ot,{select:D==null?void 0:D.select,"select-popup":D==null?void 0:D["select-popup"]},Le),x=gt(),{t:q}=xt(),ve=i.useId(),Se=`${N}-select-list-${ve}`,A=e=>`${N}-select-item-${e}-${ve}`,{pageScrollRef:Ze,contentResizeRef:Qe}=vt(),E=i.useRef(null),b=i.useRef(null),I=i.useRef(null),J=i.useRef(null),Xe=Pt(J,Ke),T=i.useRef(null),$=i.useMemo(()=>{const e=new Map,t=s=>{for(const n of s)e.set(n.value,n),n.children&&t(n.children)};return t(C),e},[C]),[d,v]=fe($e??!1,Te,qe),[F,et]=fe(Oe??"",Fe,Je),k=i.useCallback(e=>!e.disabled&&!e.children,[]),[Y,Z]=fe(Ae??(u?[]:null),ze,e=>{oe&&(u?oe(e,e.map(t=>$.get(t))):oe(e,j.isNull(e)?null:$.get(e)))},void 0,m==null?void 0:m.control),h=i.useMemo(()=>u?new Set(Y):Y,[Y,u]),Q=e=>{u?Z(t=>{const s=t.findIndex(n=>n===e);s!==-1?t.splice(s,1):t.push(e)}):(Z(e),v(!1))},{size:re,disabled:P}=St({size:Ue,disabled:He||(m==null?void 0:m.control.disabled)}),O=F.length>0,ae=u?h.size>0:!j.isNull(h),de=(()=>{if(!O)return[];const e=j.isUndefined(w==null?void 0:w.filter)?o=>o.label.includes(F):o=>w.filter(F,o),t=w==null?void 0:w.sort;let s=ne==null?void 0:ne(F);s&&(s={...s,[L]:!0});let n=[];return C.forEach(o=>{if(!o.children)s&&o.value===s.value&&(s=void 0),e(o)&&n.push(o);else{const r=[];o.children.forEach(a=>{s&&a.value===s.value&&(s=void 0),e(a)&&r.push(a)}),n=n.concat(r)}}),t&&n.sort(t),s&&n.unshift(s),n})(),V=O?de:C,[tt,st]=jt(e=>e.startsWith("Arrow")||["Home","End","Enter","Space"].includes(e)),[je,lt]=i.useState(),nt=(()=>{let e;return je&&(e=$.get(je.value),e&&k(e))||(ae&&(e=se(C,t=>k(t)&&u?h.has(t.value):h===t.value)),j.isUndefined(e)&&(e=se(C,t=>k(t)))),e})(),[ue,ot]=i.useState(),ct=(()=>{if(ue&&se(de,e=>k(e)&&e.value===ue.value))return ue;if(O)return se(de,e=>k(e))})(),f=O?ct:nt,ye=e=>{O?ot(e):lt(e)},we=e=>{if(!j.isUndefined(e)){const t=Object.assign({},e);delete t[L],ie==null||ie(t)}},it=yt(d),rt=`calc(var(--${N}-zindex-fixed) + ${it})`,X=i.useRef(),S=wt(()=>{if(d&&E.current&&b.current)if(Be){const e=Math.min(E.current.offsetWidth,Re.windowSize.width-le*2),t=b.current.offsetHeight,s=De(E.current,{width:e,height:t},{placement:"bottom",inWindow:le});X.current=s.transformOrigin,x.classes.position&&b.current.classList.toggle(x.classes.position,!1),x.replaceRule("position",{top:s.top,left:s.left,width:e}),b.current.classList.toggle(x.classes.position,!0)}else{const e=E.current.offsetWidth,t=b.current.offsetHeight,s=Re.windowSize.width-le*2,n=Math.min(Math.max(b.current.scrollWidth,e),s),o=De(E.current,{width:n,height:t},{placement:"bottom-left",inWindow:le});X.current=o.transformOrigin,x.classes.position&&b.current.classList.toggle(x.classes.position,!1),x.replaceRule("position",{top:o.top,left:o.left,minWidth:Math.min(e,s),maxWidth:s}),b.current.classList.toggle(x.classes.position,!0)}}),at=Et(S,!d);It(Ze,"scroll",S,{passive:!0},!d||at),_e(E,S,void 0,!d),_e(b,S,void 0,!d),_e(Qe,S,void 0,!d),i.useImperativeHandle(We,()=>({updatePosition:S}),[S]);const ee=e=>{document.activeElement===J.current&&e.target!==J.current&&e.button===0&&e.preventDefault()},R=i.useRef(),te=y&&d,Ee=Ve&&ae&&!d&&!G&&!P,Ie=st(i.createElement(y?"input":"div",Object.assign({...W(c("select__search"),{style:{opacity:te?void 0:0,zIndex:te?void 0:-1}}),...m==null?void 0:m.inputAria,ref:Xe,tabIndex:P?-1:0,role:"combobox","aria-haspopup":"listbox","aria-expanded":d,"aria-controls":Se,onBlur:()=>{v(!1)},onKeyDown:e=>{if(e.code==="Escape")d&&Ge&&(e.stopPropagation(),e.preventDefault(),v(!1));else{const t=s=>{var n,o,r,a;if(I.current){let _;switch(s){case"next":_=(n=T.current)==null?void 0:n.scrollToStep(I.current,1);break;case"prev":_=(o=T.current)==null?void 0:o.scrollToStep(I.current,-1);break;case"first":_=(r=T.current)==null?void 0:r.scrollToStart(I.current);break;case"last":_=(a=T.current)==null?void 0:a.scrollToEnd(I.current);break}_&&(ye(_),z===!1&&(R.current=()=>{const U=document.getElementById(A(_.value));U&&Nt(U,I.current)},d&&(R.current(),R.current=void 0)))}};if(d)switch(e.code){case"ArrowUp":{e.preventDefault(),t("prev");break}case"ArrowDown":{e.preventDefault(),t("next");break}case"Home":{e.preventDefault(),t("first");break}case"End":{e.preventDefault(),t("last");break}default:{(e.code==="Enter"||e.code==="Space"&&!y)&&(e.preventDefault(),f&&(f[L]&&we(f),Q(f.value)));break}}else if(!(y&&["Home","End","Enter","Space"].includes(e.code)))switch(e.code){case"End":case"ArrowUp":{e.preventDefault(),v(!0),t("last");break}case"Home":case"ArrowDown":{e.preventDefault(),v(!0),t("first");break}case"Enter":case"Space":{e.preventDefault(),v(!0);break}default:{Tt(e.key)&&v(!0);break}}}},onChange:e=>{y&&et(e.currentTarget.value)}},y?{type:"text",value:F,autoComplete:"off",disabled:P}:{}))),[dt,ut,pt]=(()=>{let e=null,t=null,s;if(u){const n=Y.map(o=>{const r=$.get(o);return{value:o,label:K?K(o,r):r?r.label:String(o),item:r}});t=l.jsx(kt,{list:n.map(({value:o,label:r,item:a})=>({id:o,title:r,type:"item",disabled:a==null?void 0:a.disabled})),onClick:o=>(Q(o),!1),children:l.jsx(Me,{tabIndex:-1,size:re,children:h.size})}),e=n.map(({value:o,label:r,item:a})=>l.jsxs(Me,{size:re,children:[r,!(a!=null&&a.disabled||P)&&l.jsx("div",{...c("select__close"),role:"button","aria-label":q("Close"),onClick:_=>{_.stopPropagation(),Q(o)},children:l.jsx(B,{children:l.jsx(Rt,{})})})]},o))}else if(!j.isNull(h)){const n=$.get(h);e=s=K?K(h,n):n?n.label:String(h)}return[e,t,s]})(),ft=Dt({compose:{disabled:P},form:m}),_t=i.useMemo(()=>({list:V,itemKey:e=>e.value,itemSize:j.isNumber(z)?z:32,itemEmptySize:32,itemNested:e=>e.children,itemFocusable:k}),[k,V,z]);return l.jsxs(l.Fragment,{children:[l.jsxs("div",{...p,...W(c("select",`select--${re}`,{"select.is-expanded":d,"select.is-disabled":P}),{className:p.className,style:p.style}),...ft,ref:E,onMouseDown:e=>{var t;(t=p.onMouseDown)==null||t.call(p,e),ee(e)},onMouseUp:e=>{var t;(t=p.onMouseUp)==null||t.call(p,e),ee(e)},onClick:e=>{var t,s;(t=p.onClick)==null||t.call(p,e),(s=J.current)==null||s.focus({preventScroll:!0}),v(n=>y?!0:!n)},children:[l.jsxs("div",{...c("select__container"),title:pt,children:[ge?ge(Ie):Ie,!te&&(ae?l.jsx("div",{...c("select__content"),children:dt}):me?l.jsx("div",{...c("select__placeholder-wrapper"),children:l.jsx("div",{...c("select__placeholder"),children:me})}):null)]}),u&&l.jsx("div",{...c("select__multiple-count"),onClick:e=>{e.stopPropagation()},children:ut}),Ee&&l.jsx("div",{...c("select__clear"),role:"button","aria-label":q("Clear"),onClick:e=>{e.stopPropagation(),Z(u?[]:null),ce==null||ce()},children:l.jsx(B,{children:l.jsx(Wt,{})})}),l.jsx("div",{...W(c("select__icon"),{style:{visibility:Ee?"hidden":void 0}}),children:l.jsx(B,{children:G?l.jsx(Ce,{}):te?l.jsx(At,{}):l.jsx(zt,{...c("select__arrow")})})})]}),l.jsx(Ct,{selector:()=>{let e=document.getElementById(`${N}-select-root`);return e||(e=document.createElement("div"),e.id=`${N}-select-root`,document.body.appendChild(e)),e},children:l.jsx(Mt,{enter:d,during:he,afterRender:()=>{var e;S(),(e=R.current)==null||e.call(R),R.current=void 0},afterEnter:()=>{M==null||M(!0)},afterLeave:()=>{M==null||M(!1)},children:e=>{let t={};switch(e){case"enter":t={transform:"scaleY(0.7)",opacity:0};break;case"entering":t={transition:["transform","opacity"].map(s=>`${s} ${he}ms ease-out`).join(", "),transformOrigin:X.current};break;case"leaving":t={transform:"scaleY(0.7)",opacity:0,transition:["transform","opacity"].map(s=>`${s} ${he}ms ease-in`).join(", "),transformOrigin:X.current};break;case"leaved":t={display:"none"};break}return l.jsx("div",{...W(c("select-popup"),{style:{zIndex:rt,...t}}),ref:b,onMouseDown:s=>{ee(s)},onMouseUp:s=>{ee(s)},children:(()=>{const s=l.jsxs("div",{...c("select-popup__content"),children:[G&&l.jsx("div",{...c("select-popup__loading",{"select-popup__loading--empty":V.length===0}),children:l.jsx(B,{children:l.jsx(Ce,{})})}),G&&V.length===0?null:l.jsx($t,{..._t,ref:T,enable:z!==!1,listSize:264,listPadding:4,itemRender:(n,o,r,a,_)=>{const{label:U,value:g,disabled:pe}=n,ke=be?be(n):U;if(_)return i.createElement("ul",{...c("select__option-group"),key:g,role:"group","aria-labelledby":A(g)},i.createElement("li",{...c("select__option-group-label"),key:g,id:A(g),role:"presentation"},l.jsx("div",{...c("select__option-content"),children:ke})),_);let H=!1;return u?H=h.has(g):H=h===g,i.createElement("li",{...W(c("select__option",{"select__option.is-selected":!u&&H,"select__option.is-disabled":pe}),{style:{paddingLeft:a.length===0?void 0:20}}),...r,key:g,id:A(g),title:(n[L]?q("Create")+" ":"")+U,role:"option","aria-selected":H,"aria-disabled":pe,onClick:()=>{n[L]&&we(n),ye(n),Q(g)}},tt&&(f==null?void 0:f.value)===g&&l.jsx("div",{className:`${N}-focus-outline`}),n[L]?l.jsx("div",{...c("select__option-prefix"),children:l.jsx(B,{theme:"primary",children:l.jsx(Lt,{})})}):u?l.jsx("div",{...c("select__option-prefix"),children:l.jsx(Ft,{model:H,disabled:pe})}):null,l.jsx("div",{...c("select__option-content"),children:ke}))},itemFocused:f==null?void 0:f.value,itemEmptyRender:()=>l.jsx("li",{...W(c("select__empty"),{style:{paddingLeft:20}}),children:l.jsx("div",{...c("select__option-content"),children:q("No Data")})}),itemInAriaSetsize:n=>!n.children,placeholder:"li",onScrollEnd:Ye,children:(n,o)=>l.jsx("ul",{...c("select__list"),ref:I,id:Se,tabIndex:-1,role:"listbox","aria-multiselectable":u,"aria-activedescendant":j.isUndefined(f)?void 0:A(f.value),onScroll:o,children:V.length===0?l.jsx(Ne,{style:{padding:"12px 0"},image:Ne.SIMPLE_IMG}):n})})]});return xe?xe(s):s})()})}})})]})}const es=i.forwardRef(Vt);export{es as S};
