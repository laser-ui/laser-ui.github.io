import{r as d,u as D,b as P,w as X,l as k,j as e,m as C,I as L,q as te,C as ne,T as se,a as ce,k as pe,c as _e,t as me,f as he}from"./index-411ef933.js";import{s as ve}from"./setRef-2f566a1f.js";import{F as xe}from"./file_download-bffc4b27.js";import{S as ge}from"./add-8fdae788.js";import{S as be}from"./visibility-44283ce5.js";import{u as je}from"./Route-383e0c94.js";import{P as ie}from"./Progress-43faf5ae.js";function fe(c,f){const h=document.createElement("a");document.body.appendChild(h),h.style.display="none",h.href=c,h.download=f,h.click(),document.body.removeChild(h)}const we=c=>d.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",...c},d.createElement("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM8 9h8v10H8V9zm7.5-5-1-1h-5l-1 1H5v2h14V4h-3.5z"})),Ue={upload:"^upload"},ye={"upload-button":"^upload-button","upload-button.is-disabled":"is-disabled","upload-button--load":"^upload-button--load","upload-button--error":"^upload-button--error","upload-button--progress":"^upload-button--progress","upload-button__thumbnail":"^upload-button__thumbnail","upload-button__name":"^upload-button__name","upload-button__actions":"^upload-button__actions","upload-button__icon":"^upload-button__icon","upload-button__text":"^upload-button__text"},ue={"upload-action":"^upload-action","upload-action.is-disabled":"is-disabled","upload-action--light":"^upload-action--light","upload-action--preview":"^upload-action--preview"},Se={"upload-list":"^upload-list","upload-list__row":"^upload-list__row","upload-list__item":"^upload-list__item","upload-list__item--load":"^upload-list__item--load","upload-list__item--error":"^upload-list__item--error","upload-list__item--progress":"^upload-list__item--progress","upload-list__icon":"^upload-list__icon","upload-list__link":"^upload-list__link","upload-list__link.is-active":"is-active","upload-list__actions":"^upload-list__actions","upload-list__progress-wrapper":"^upload-list__progress-wrapper"},ke={"upload-picture":"^upload-picture","upload-picture__row":"^upload-picture__row","upload-picture__item":"^upload-picture__item","upload-picture__item.is-disabled":"is-disabled","upload-picture__item--load":"^upload-picture__item--load","upload-picture__item--error":"^upload-picture__item--error","upload-picture__item--progress":"^upload-picture__item--progress","upload-picture__thumbnail":"^upload-picture__thumbnail","upload-picture__name":"^upload-picture__name","upload-picture__actions":"^upload-picture__actions","upload-picture__progress-text":"^upload-picture__progress-text"},Fe={"upload-picture-list":"^upload-picture-list","upload-picture-list__row":"^upload-picture-list__row","upload-picture-list__item":"^upload-picture-list__item","upload-picture-list__item--load":"^upload-picture-list__item--load","upload-picture-list__item--error":"^upload-picture-list__item--error","upload-picture-list__item--progress":"^upload-picture-list__item--progress","upload-picture-list__thumbnail":"^upload-picture-list__thumbnail","upload-picture-list__thumbnail-img":"^upload-picture-list__thumbnail-img","upload-picture-list__link":"^upload-picture-list__link","upload-picture-list__link.is-active":"is-active","upload-picture-list__actions":"^upload-picture-list__actions","upload-picture-list__progress-wrapper":"^upload-picture-list__progress-wrapper"},J=d.createContext({files:[],onRemove:()=>{}}),V=d.createContext(void 0);function B(c){const{ref:f,styleOverrides:h,styleProvider:v,children:i,preset:p,disabled:o=!1,...x}=D("UploadAction",c),g=P(ue,{"upload-action":v==null?void 0:v["upload-action"]},h),{t:s}=X(),a=d.use(V),b=p==="download"?o||k.isUndefined(a==null?void 0:a.file.url):o;return e.jsx("div",{...x,...C(g("upload-action",{"upload-action.is-disabled":b,"upload-action--light":a==null?void 0:a.light}),{className:x.className,style:x.style}),ref:f,role:x.role??"button",tabIndex:x.tabIndex??(b?-1:0),title:x.title??p==="download"?s("Upload","Download file"):p==="remove"?s("Upload","Remove file"):void 0,onClick:_=>{var t,m,r;(t=x.onClick)==null||t.call(x,_),_.stopPropagation(),a&&(p==="download"?(m=a.defaultActions)!=null&&m.download?a.defaultActions.download(a.file):fe(a.file.url,a.file.name):p==="remove"&&((r=a.onRemove)==null||r.call(a)))},children:i??(p==="download"?e.jsx(L,{children:e.jsx(xe,{})}):p==="remove"?e.jsx(L,{children:e.jsx(we,{})}):null)})}const re=c=>d.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",...c},d.createElement("path",{d:"M13 4H6v16h12V9h-5z",opacity:.3}),d.createElement("path",{d:"m20 8-6-6H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8zm-2 12H6V4h7v5h5v11z"}));function oe(c){const{ref:f,styleOverrides:h,styleProvider:v,children:i,disabled:p=!1,...o}=D("UploadPreviewAction",c),x=P(ue,{"upload-action":v==null?void 0:v["upload-action"]},h),{t:g}=X(),s=d.use(V);return e.jsx("a",{...o,...C(x("upload-action","upload-action--preview",{"upload-action.is-disabled":p||k.isUndefined(s==null?void 0:s.file.url),"upload-action--light":s==null?void 0:s.light}),{className:o.className,style:o.style}),ref:f,href:s==null?void 0:s.file.url,target:o.target??"_blank",title:o.title??g("Upload","Preview file"),onClick:a=>{var b,_;(b=o.onClick)==null||b.call(o,a),a.stopPropagation(),s&&(_=s.defaultActions)!=null&&_.preview&&(a.preventDefault(),s.defaultActions.preview(s.file))},children:i??e.jsx(L,{children:e.jsx(be,{})})})}function Ee(c){const{ref:f,styleOverrides:h,styleProvider:v,file:i,actions:p,defaultActions:o,onRemove:x,...g}=D("UploadButton",c),s=P(ye,{"upload-button":v==null?void 0:v["upload-button"]},h),{t:a}=X(),b=i&&i.state==="progress";return e.jsx("div",{...g,...C(s("upload-button",{"upload-button.is-disabled":b,[`upload-button--${i==null?void 0:i.state}`]:i}),{className:g.className,style:g.style}),ref:f,tabIndex:g.tabIndex??(b?-1:0),children:i&&i.state!=="progress"?e.jsxs(e.Fragment,{children:[i.thumbUrl?e.jsx("img",{...s("upload-button__thumbnail"),src:i.thumbUrl,alt:i.name}):e.jsxs(e.Fragment,{children:[e.jsx(L,{theme:i.state==="error"?"danger":"primary",children:e.jsx(re,{})}),e.jsx("div",{...s("upload-button__name"),children:i.name})]}),e.jsx("div",{...s("upload-button__actions"),children:e.jsx(V,{value:{file:i,defaultActions:o,light:!0,onRemove:x},children:(p??[e.jsx(oe,{}),e.jsx(B,{preset:"remove"})]).map((_,t)=>{const{id:m,action:r}=k.has(_,["id","action"])?_:{id:t,action:_};return e.jsx(d.Fragment,{children:r},m)})})})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{...s("upload-button__icon"),children:e.jsx(L,{children:b?e.jsx(te,{}):e.jsx(ge,{})})}),e.jsx("div",{...s("upload-button__text"),children:a("Upload",b?"Uploading":"Upload")})]})})}const Le=c=>d.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",...c},d.createElement("path",{d:"M16.5 6v11.5c0 2.21-1.79 4-4 4s-4-1.79-4-4V5a2.5 2.5 0 0 1 5 0v10.5c0 .55-.45 1-1 1s-1-.45-1-1V6H10v9.5a2.5 2.5 0 0 0 5 0V5c0-2.21-1.79-4-4-4S7 2.79 7 5v12.5c0 3.04 2.46 5.5 5.5 5.5s5.5-2.46 5.5-5.5V6h-1.5z"}));function le(){const c=d.useRef(!1);return je(()=>{c.current=!0}),c}function Re(c){var b,_;const{styleOverrides:f,styleProvider:h,actions:v,defaultActions:i,...p}=D("UploadList",c),o=P(Se,{"upload-list":h==null?void 0:h["upload-list"]},f),{files:x,onRemove:g}=d.use(J),s=d.useRef(x);{const t=x.map(r=>Object.assign({},r));let m=-1;for(const r of s.current)m+=1,r.__removing&&((b=s.current[m-1])==null?void 0:b.uid)===((_=t[m-1])==null?void 0:_.uid)&&t.splice(m,0,r);s.current=t}const a=le();return e.jsx("ul",{...p,...C(o("upload-list"),{className:p.className,style:p.style}),children:e.jsx("div",{...o("upload-list__row"),children:s.current.map((t,m)=>e.jsx(ne,{height:0,enter:!t.__removing,duration:se,skipFirstTransition:!a.current,onAfterLeave:()=>{const r=s.current.findIndex(l=>l.uid===t.uid);r!==-1&&s.current.splice(r,1)},children:(r,l)=>l?null:e.jsx("div",{ref:n=>(r(n),()=>{r(null)}),children:e.jsxs("li",{...o("upload-list__item",{[`upload-list__item--${t.state}`]:t.state}),children:[e.jsx("div",{...o("upload-list__icon"),children:t.state==="progress"?e.jsx(L,{children:e.jsx(te,{})}):e.jsx(L,{rotate:45,children:e.jsx(Le,{})})}),e.jsx("a",{...o("upload-list__link",{"upload-list__link.is-active":t.state==="load"&&!k.isUndefined(t.url)}),href:t.url,target:"_blank",rel:"noreferrer",title:t.name,onClick:n=>{i&&i.preview&&(n.preventDefault(),i.preview(t))},children:t.name}),e.jsx("div",{...o("upload-list__actions"),children:e.jsx(V,{value:{file:t,defaultActions:i,onRemove:()=>{t.__removing=!0,g(t)}},children:(v?v(t,m):[e.jsx(B,{preset:"remove"})]).map((n,j)=>{const{id:y,action:w}=k.has(n,["id","action"])?n:{id:j,action:n};return e.jsx(d.Fragment,{children:w},y)})})}),e.jsx("div",{...o("upload-list__progress-wrapper"),children:k.isNumber(t.percent)&&e.jsx(ie,{percent:t.percent,label:!1,lineWidth:2})})]})})},t.uid))})})}function Te(c){var m,r;const{children:f,styleOverrides:h,styleProvider:v,actions:i,defaultActions:p,...o}=D("UploadPicture",c),x=ce(),g=P(ke,{"upload-picture":v==null?void 0:v["upload-picture"]},h),{t:s}=X(),{files:a,onRemove:b}=d.use(J),_=d.useRef(a);{const l=a.map(j=>Object.assign({},j));let n=-1;for(const j of _.current)n+=1,j.__removing&&((m=_.current[n-1])==null?void 0:m.uid)===((r=l[n-1])==null?void 0:r.uid)&&l.splice(n,0,j);_.current=l}const t=le();return e.jsx("ul",{...o,...C(g("upload-picture"),{className:o.className,style:o.style}),children:e.jsxs("div",{...g("upload-picture__row"),children:[_.current.map((l,n)=>e.jsx(pe,{enter:!l.__removing,name:`${x}-upload-picture`,duration:se,skipFirstTransition:!t.current,onAfterLeave:()=>{const j=_.current.findIndex(y=>y.uid===l.uid);j!==-1&&_.current.splice(j,1)},children:(j,y)=>y?null:e.jsx("div",{ref:w=>(j(w),()=>{j(null)}),children:e.jsx("li",{...g("upload-picture__item",{[`upload-picture__item--${l.state}`]:l.state,"upload-picture__item.is-disabled":l&&l.state==="progress"}),children:l.state!=="progress"?e.jsxs(e.Fragment,{children:[l.thumbUrl?e.jsx("img",{...g("upload-picture__thumbnail"),src:l.thumbUrl,alt:l.name}):e.jsxs(e.Fragment,{children:[e.jsx(L,{size:28,theme:l.state==="error"?"danger":"primary",children:e.jsx(re,{})}),e.jsx("div",{...g("upload-picture__name"),children:l.name})]}),e.jsx("div",{...g("upload-picture__actions"),children:e.jsx(V,{value:{file:l,defaultActions:p,light:!0,onRemove:()=>{l.__removing=!0,b(l)}},children:(i?i(l,n):[e.jsx(oe,{}),e.jsx(B,{preset:"remove"})]).map((w,$)=>{const{id:q,action:K}=k.has(w,["id","action"])?w:{id:$,action:w};return e.jsx(d.Fragment,{children:K},q)})})})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{...g("upload-picture__progress-text"),children:s("Upload","Uploading")}),k.isNumber(l.percent)&&e.jsx(ie,{style:{width:"100%"},percent:l.percent,label:!1,lineWidth:2})]})})})},l.uid)),e.jsx("div",{children:f})]})})}function Ne(c){var b,_;const{styleOverrides:f,styleProvider:h,actions:v,defaultActions:i,...p}=D("UploadPictureList",c),o=P(Fe,{"upload-picture-list":h==null?void 0:h["upload-picture-list"]},f),{files:x,onRemove:g}=d.use(J),s=d.useRef(x);{const t=x.map(r=>Object.assign({},r));let m=-1;for(const r of s.current)m+=1,r.__removing&&((b=s.current[m-1])==null?void 0:b.uid)===((_=t[m-1])==null?void 0:_.uid)&&t.splice(m,0,r);s.current=t}const a=le();return e.jsx("ul",{...p,...C(o("upload-picture-list"),{className:p.className,style:p.style}),children:e.jsx("div",{...o("upload-picture-list__row"),children:s.current.map((t,m)=>e.jsx(ne,{height:0,enter:!t.__removing,duration:se,skipFirstTransition:!a.current,onAfterLeave:()=>{const r=s.current.findIndex(l=>l.uid===t.uid);r!==-1&&s.current.splice(r,1)},children:(r,l)=>l?null:e.jsx("div",{ref:n=>(r(n),()=>{r(null)}),children:e.jsxs("li",{...o("upload-picture-list__item",{[`upload-picture-list__item--${t.state}`]:t.state}),children:[e.jsx("div",{...o("upload-picture-list__thumbnail"),children:t.state==="progress"?e.jsx(L,{size:28,children:e.jsx(te,{})}):t.thumbUrl?e.jsx("img",{...o("upload-picture-list__thumbnail-img"),src:t.thumbUrl,alt:t.name}):e.jsx(L,{size:28,theme:t.state==="error"?"danger":"primary",children:e.jsx(re,{})})}),e.jsx("a",{...o("upload-picture-list__link",{"upload-picture-list__link.is-active":t.state==="load"&&!k.isUndefined(t.url)}),href:t.url,target:"_blank",rel:"noreferrer",title:t.name,onClick:n=>{i&&i.preview&&(n.preventDefault(),i.preview(t))},children:t.name}),e.jsx("div",{...o("upload-picture-list__actions"),children:e.jsx(V,{value:{file:t,defaultActions:i,onRemove:()=>{t.__removing=!0,g(t)}},children:(v?v(t,m):[e.jsx(B,{preset:"remove"})]).map((n,j)=>{const{id:y,action:w}=k.has(n,["id","action"])?n:{id:j,action:n};return e.jsx(d.Fragment,{children:w},y)})})}),e.jsx("div",{...o("upload-picture-list__progress-wrapper"),children:k.isNumber(t.percent)&&e.jsx(ie,{percent:t.percent,label:!1,lineWidth:2})})]})})},t.uid))})})}const z=c=>{const{ref:f,children:h,styleOverrides:v,styleProvider:i,formControl:p,model:o,defaultModel:x,request:g,max:s,drag:a=!1,customUpload:b,beforeUpload:_,onModelChange:t,onRemove:m,...r}=D("Upload",c),l=P(Ue,{upload:i==null?void 0:i.upload,"upload-list":i==null?void 0:i["upload-list"]},v),n=d.useRef(null),j=d.useRef([]),[y,w]=_e(x??[],o,void 0,void 0,p==null?void 0:p.control);me(()=>{j.current.forEach(u=>{URL.revokeObjectURL(u)})});const $=u=>{if(b)b(u);else{let R=Date.now();const U=[];for(let N=0;N<u.length;N++){const F=u.item(N);if(F){const S=new XMLHttpRequest;let M=++R;const ae=T=>{const A=URL.createObjectURL(F);j.current.push(A);const E={uid:M,name:F.name,url:A,thumbUrl:F.type.startsWith("image")?A:void 0,originFile:F,response:S.response,...T};if(k.isNumber(s)&&y.length+U.length>=s){if(s===1){M=E.uid=y[0].uid,w([E]),t==null||t([E],{type:"update",files:[E]});return}return!0}U.push(E)},Q=T=>{let A=!0;const E=w(O=>{const H=O.findIndex(Z=>Z.uid===M);H!==-1?O[H]=Object.assign(O[H],{response:S.response,...T}):A=!1});A&&(t==null||t(E,{type:"update",files:[E.find(O=>O.uid===M)]}))},Y=T=>{if(T===!1)ae({state:null});else{if(ae({state:"progress",percent:0}))return;S.upload.addEventListener("progress",I=>{if(I.lengthComputable){const G=Math.round(I.loaded*100/I.total);Q({state:"progress",percent:G})}}),S.addEventListener("error",()=>{Q({state:"error",percent:void 0})}),S.addEventListener("load",()=>{Q({state:S.status>=200&&S.status<300?"load":"error",percent:void 0})});const{url:E,method:O="POST",responseType:H="json",header:Z={},body:de=I=>{const G=new FormData;return G.append("file",I),G},custom:ee}=g;S.open(O,E),S.responseType=H,Object.entries(Z).forEach(I=>{S.setRequestHeader(...I)}),ee==null||ee(S),S.send(de(T===!0?F:T))}};let W=!0;_?(W=_(F,u),W instanceof Promise?W.then(T=>{Y(T)}):Y(W)):Y(!0)}}if(U.length>0){const N=w(F=>F.concat(U));t==null||t(N,{type:"add",files:U})}}},q=he(u=>{m==null||m(u);const R=w(U=>{const N=U.findIndex(F=>F.uid===u.uid);U.splice(N,1)});t==null||t(R,{type:"remove",files:[u]})}),K=d.useMemo(()=>({files:y,onRemove:q}),[y,q]);return e.jsxs(e.Fragment,{children:[e.jsx(J,{value:K,children:h({onClick:()=>{n.current&&n.current.click()},...a?{onDragEnter:u=>{u.stopPropagation(),u.preventDefault()},onDragOver:u=>{u.stopPropagation(),u.preventDefault()},onDrop:u=>{u.stopPropagation(),u.preventDefault();const U=u.dataTransfer.files;$(U)}}:void 0})}),e.jsx("input",{...r,...C(l("upload"),{className:r.className,style:r.style}),ref:u=>{const R=ve(f,u);return n.current=u,()=>{R(),n.current=null}},type:r.type??"file",onChange:u=>{var U;(U=r.onChange)==null||U.call(r,u);const R=u.currentTarget.files;R&&$(R),u.currentTarget.value=""}})]})};z.Button=Ee;z.Action=B;z.PreviewAction=oe;z.List=Re;z.Picture=Te;z.PictureList=Ne;const ze=c=>d.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",...c},d.createElement("path",{d:"M18 15v3H6v-3H4v3c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2v-3h-2zM7 9l1.41 1.41L11 7.83V16h2V7.83l2.59 2.58L17 9l-5-5-5 5z"}));export{ze as S,z as U};
