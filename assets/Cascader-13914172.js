import{r as n,f as Re,l as F,V as Ke,j as s,I as se,q as Ie,W as pa,u as fa,a as _a,b as ha,N as ba,d as ma,c as ye,Q as va,X as xa,Y as Ee,Z as ga,_ as Sa,$ as Ve,a0 as ka,h as ja,i as ya,k as we,m as he,p as Ea,a1 as wa,a2 as Ca,a3 as Ia,n as Ra,a4 as Ce}from"./index-a3b6559e.js";import{u as Da}from"./useForkRef-7b0e428d.js";import{S as Na}from"./cancel-07861f12.js";import{S as Pa}from"./keyboard_arrow_down-694ba12c.js";import{S as Ta}from"./search-c1e0104a.js";import{V as Oe}from"./VirtualScroll-f00e1ec5.js";import{C as Be}from"./Checkbox-ef31ba0a.js";import{E as me}from"./Empty-404e8337.js";import{g as be}from"./utils-c2ed83c6.js";import{T as D,M as Ma,S as Aa}from"./single-node-19c90d0d.js";import{i as La}from"./isPrintableCharacter-1b5c27a6.js";import{T as Ue}from"./Tag-80b03511.js";function Fa(B,Q){const{namespace:X,styled:p,id:g,list:E,customItem:H,itemId:V,itemSelected:k,itemFocused:_,multiple:P,virtual:l,focusVisible:I,onFocus:G,onClick:j,_root:w=!0}=B,m=n.useRef(null),S=n.useRef(null),d=n.useRef(null),T=_&&E.findIndex(a=>a.id===_.id)!==-1,o=(()=>{if(_)for(const a of E){if(_.id===a.id)return a;let f=_;for(;f.parent;)if(f=f.parent,f.id===a.id)return a}})(),h=Re(a=>{var f,Y,W,y,ce,re,q;if(m.current){let b;if(w&&F.isUndefined(_))switch(a){case"first":case"next":b=(f=S.current)==null?void 0:f.scrollToStart(m.current);break;case"last":case"prev":b=(Y=S.current)==null?void 0:Y.scrollToEnd(m.current);break}else if(T)switch(a){case"next":b=(W=S.current)==null?void 0:W.scrollToStep(m.current,1);break;case"prev":b=(y=S.current)==null?void 0:y.scrollToStep(m.current,-1);break;case"first":b=(ce=S.current)==null?void 0:ce.scrollToStart(m.current);break;case"last":b=(re=S.current)==null?void 0:re.scrollToEnd(m.current);break;case"prev-level":o&&o.parent&&(b=o.parent);break;case"next-level":if(o&&o.children){for(const M of o.children)if(M.enabled){b=M;break}}break;default:a instanceof HTMLElement&&m.current&&Ke(a,m.current);break}else b=(q=d.current)==null?void 0:q.call(d,a);return b}});n.useImperativeHandle(Q,()=>h,[h]);const N=n.useMemo(()=>({list:E,itemKey:a=>a.id,itemSize:F.isNumber(l)?l:32,itemFocusable:a=>a.enabled}),[E,l]);return s.jsxs(s.Fragment,{children:[s.jsx(Oe,{...N,ref:S,enable:l!==!1,listSize:264,listPadding:4,itemRender:(a,f,Y)=>{let W=!1;if(a.children&&k){let y=k;for(;y.parent;)if(y=y.parent,y.id===a.id){W=!0;break}}return n.createElement("li",{...p("cascader__option",{"cascader__option.is-focused":a.id===(o==null?void 0:o.id),"cascader__option.is-selected":!P&&a.checked,"cascader__option.is-disabled":a.disabled}),...Y,key:a.id,id:V(a.id),title:a.origin.label,role:"option","aria-selected":a.checked,"aria-disabled":a.disabled,onClick:()=>{G(a),P&&!a.isLeaf||j(a)}},I&&(_==null?void 0:_.id)===a.id&&s.jsx("div",{className:`${X}-focus-outline`}),W&&s.jsx("div",{...p("cascader__option-dot")}),P&&s.jsx("div",{...p("cascader__option-prefix"),children:s.jsx(Be,{model:a.checked,disabled:a.disabled,indeterminate:a.indeterminate,onClick:y=>{y.stopPropagation(),G(a),j(a)}})}),s.jsx("div",{...p("cascader__option-content"),children:H?H(a.origin):a.origin.label}),!a.isLeaf&&s.jsx("div",{...p("cascader__option-icon"),children:s.jsx(se,{children:a.origin.loading?s.jsx(Ie,{}):s.jsx(pa,{})})}))},itemFocused:o==null?void 0:o.id,placeholder:"li",children:(a,f)=>s.jsx("ul",{...p("cascader__list","cascader__list--inline"),ref:m,id:g,tabIndex:-1,role:"listbox","aria-multiselectable":P,"aria-activedescendant":w&&!F.isUndefined(_)?V(_.id):void 0,onScroll:f,children:E.length===0?s.jsx(me,{style:{padding:"12px 28px"},image:me.SIMPLE_IMG}):a})}),o&&!o.origin.loading&&o.children&&s.jsx(Ge,{...B,_root:!1,ref:d,id:void 0,list:o.children})]})}const Ge=n.forwardRef(Fa);function Wa(B,Q){const{namespace:X,styled:p,id:g,list:E,customItem:H,itemId:V,itemFocused:k,multiple:_,onlyLeafSelectable:P,virtual:l,focusVisible:I,onClick:G}=B,j=n.useRef(null),w=n.useRef(null),m=Re(d=>{var T,o,h,N;if(j.current){let a;switch(d){case"next":a=(T=w.current)==null?void 0:T.scrollToStep(j.current,1);break;case"prev":a=(o=w.current)==null?void 0:o.scrollToStep(j.current,-1);break;case"first":a=(h=w.current)==null?void 0:h.scrollToStart(j.current);break;case"last":a=(N=w.current)==null?void 0:N.scrollToEnd(j.current);break;default:d instanceof HTMLElement&&j.current&&Ke(d,j.current);break}return a}});n.useImperativeHandle(Q,()=>m,[m]);const S=n.useMemo(()=>({list:E,itemKey:d=>d.value,itemSize:F.isNumber(l)?l:32,itemFocusable:d=>d[D].enabled}),[E,l]);return s.jsx(Oe,{...S,ref:w,enable:l!==!1,listSize:264,listPadding:4,itemRender:(d,T,o)=>{const h=d[D];let N=h.checked;if(!P){let a=h;for(;a.parent;)if(a=a.parent,a.id===d.value){N=!0;break}}return n.createElement("li",{...p("cascader__option",{"cascader__option.is-selected":!_&&N,"cascader__option.is-disabled":h.disabled}),...o,key:d.value,id:V(d.value),title:d.label,role:"option","aria-selected":h.checked,"aria-disabled":h.disabled,onClick:()=>{G(d)}},I&&(k==null?void 0:k.value)===d.value&&s.jsx("div",{className:`${X}-focus-outline`}),_&&s.jsx("div",{...p("cascader__option-prefix"),children:s.jsx(Be,{model:h.checked,disabled:h.disabled})}),s.jsx("div",{...p("cascader__option-content"),children:H?H(h.origin):be(h)}))},itemFocused:k==null?void 0:k.value,placeholder:"li",children:(d,T)=>s.jsx("ul",{...p("cascader__list"),ref:j,id:g,tabIndex:-1,role:"listbox","aria-multiselectable":_,"aria-activedescendant":F.isUndefined(k)?void 0:V(k.value),onScroll:T,children:E.length===0?s.jsx(me,{style:{padding:"12px 28px"},image:me.SIMPLE_IMG}):d})})}const $a=n.forwardRef(Wa),za={cascader:"^cascader","cascader.is-expanded":"is-expanded","cascader.is-disabled":"is-disabled","cascader--small":"^cascader--small","cascader--medium":"^cascader--medium","cascader--large":"^cascader--large",cascader__container:"^cascader__container",cascader__content:"^cascader__content",cascader__search:"^cascader__search","cascader__placeholder-wrapper":"^cascader__placeholder-wrapper",cascader__placeholder:"^cascader__placeholder","cascader__multiple-count":"^cascader__multiple-count",cascader__close:"^cascader__close",cascader__clear:"^cascader__clear",cascader__icon:"^cascader__icon",cascader__arrow:"^cascader__arrow","cascader-popup":"^cascader-popup","cascader-popup__loading":"^cascader-popup__loading","cascader-popup__loading--empty":"^cascader-popup__loading--empty",cascader__list:"^cascader__list","cascader__list--inline":"^cascader__list--inline",cascader__option:"^cascader__option","cascader__option.is-focused":"is-focused","cascader__option.is-selected":"is-selected","cascader__option.is-disabled":"is-disabled","cascader__option-dot":"^cascader__option-dot","cascader__option-prefix":"^cascader__option-prefix","cascader__option-content":"^cascader__option-content","cascader__option-icon":"^cascader__option-icon",cascader__empty:"^cascader__empty"};function Ha(B,Q){const{styleOverrides:X,styleProvider:p,formControl:g,list:E,model:H,defaultModel:V,visible:k,defaultVisible:_,placeholder:P,multiple:l=!1,searchable:I=!1,searchValue:G,defaultSearchValue:j,onlyLeafSelectable:w=!0,clearable:m=!1,loading:S=!1,size:d,disabled:T=!1,virtual:o=!1,escClosable:h=!0,customItem:N,customSelected:a,customSearch:f,inputRef:Y,inputRender:W,onModelChange:y,onVisibleChange:ce,onSearch:re,onClear:q,onFirstFocus:b,afterVisibleChange:M,...C}=fa("Cascader",B),U=_a(),v=ha(za,{cascader:p==null?void 0:p.cascader,"cascader-popup":p==null?void 0:p["cascader-popup"]},X),{t:De}=ba(),Ne=n.useId(),ve=`${U}-cascader-list-${Ne}`,xe=e=>`${U}-cascader-item-${e}-${Ne}`,{pageScrollRef:Ye,contentResizeRef:qe}=ma(),te=n.useRef(null),J=n.useRef(null),ie=n.useRef(null),Ze=Da(ie,Y),ee=n.useRef(null),ne=n.useRef({itemFocused:new Set}),[le,K]=n.useMemo(()=>{const e=E.map(i=>l?new Ma(i,r=>r.value,{disabled:i.disabled}):new Aa(i,r=>r.value,{disabled:i.disabled})),c=new Map,t=i=>{for(const r of i)c.set(r.id,r),r.children&&t(r.children)};return t(e),[e,c]},[E,l]),[x,A]=ye(_??!1,k,ce),[oe,Qe]=ye(j??"",G,re),[de,$]=ye(V??(l?[]:null),H,e=>{y&&(l?y(e,e.map(c=>K.get(c).origin)):y(e,F.isNull(e)?null:K.get(e).origin))},void 0,g==null?void 0:g.control),R=n.useMemo(()=>l?new Set(de):de,[de,l]),Pe=e=>{if(l){const c=e.changeStatus(e.checked?"UNCHECKED":"CHECKED",R);$(Array.from(c.keys()))}else(e.isLeaf||!w)&&$(e.id),e.isLeaf&&A(!1)},Te=e=>{if(l){const c=e[D].changeStatus(e[D].checked?"UNCHECKED":"CHECKED",R);$(Array.from(c.keys()))}else $(e[D].id),A(!1)};K.forEach(e=>{e.updateStatus(R)});const{size:ge,disabled:Z}=va({size:d,disabled:T||(g==null?void 0:g.control.disabled)}),L=oe.length>0,ue=l?R.size>0:!F.isNull(R),pe=(()=>{if(!L)return[];const e=F.isUndefined(f==null?void 0:f.filter)?r=>r.label.includes(oe):r=>f.filter(oe,r),c=f==null?void 0:f.sort,t=[],i=r=>{r.forEach(u=>{(!l&&!w||u.isLeaf)&&e(u.origin)&&t.push({label:be(u),value:u.id,disabled:u.disabled,[D]:u}),u.children&&i(u.children)})};return i(le),c&&t.sort((r,u)=>c(r[D].origin,u[D].origin)),t})(),Me=L?pe.length===0:le.length===0,[Ae,Xe]=xa(e=>e.startsWith("Arrow")||["Home","End","Enter","Space"].includes(e)),[Le,Je]=n.useState(),Fe=e=>{ne.current.itemFocused.has(e.id)||(ne.current.itemFocused.add(e.id),b==null||b(e.id,e.origin)),Je(e)},Se=(()=>{if(Le){const e=K.get(Le.id);if(e&&e.enabled)return e}if(ue)return Ee(le,e=>e.enabled&&e.checked)})(),[ke,ea]=n.useState(),We=e=>{ne.current.itemFocused.has(e.value)||(ne.current.itemFocused.add(e.value),b==null||b(e.value,e[D].origin)),ea(e)},je=(()=>{if(ke&&Ee(pe,e=>e[D].enabled&&e.value===ke.value))return ke;if(L)return Ee(pe,e=>e[D].enabled)})(),aa=ga(x),sa=`calc(var(--${U}-zindex-fixed) + ${aa})`,[$e,ca]=n.useState(),[ra,ta]=n.useState({top:"-200vh",left:"-200vw"}),z=Re(()=>{if(x&&te.current&&J.current){const e=J.current.offsetHeight,c=Sa.windowSize.width-Ve*2,t=Math.min(J.current.scrollWidth,c),i=ka(te.current,{width:t,height:e},{placement:"bottom-left",inWindow:Ve});ca(i.transformOrigin),ta({top:i.top,left:i.left,maxWidth:c})}}),ia=ja(z,!x);ya(Ye,"scroll",z,{passive:!0},!x||ia),we(te,z,void 0,!x),we(J,z,void 0,!x),we(qe,z,void 0,!x),n.useImperativeHandle(Q,()=>({updatePosition:z}),[z]);const fe=e=>{document.activeElement===ie.current&&e.target!==ie.current&&e.button===0&&e.preventDefault()},O=n.useRef(),_e=I&&x,ze=m&&ue&&!x&&!S&&!Z,He=Xe(n.createElement(I?"input":"div",Object.assign({...he(v("cascader__search"),{style:{opacity:_e?void 0:0,zIndex:_e?void 0:-1}}),...g==null?void 0:g.inputAria,ref:Ze,tabIndex:Z?-1:0,role:"combobox","aria-haspopup":"listbox","aria-expanded":x,"aria-controls":ve,onBlur:()=>{A(!1)},onKeyDown:e=>{if(e.code==="Escape")x&&h&&(e.stopPropagation(),e.preventDefault(),A(!1));else{const c=t=>{if(ee.current){const i=ee.current(t);i&&(L?We(i):Fe(i),o===!1&&!t.includes("level")&&(O.current=()=>{const r=document.getElementById(xe(L?i.value:i.id));r&&ee.current(r)},x&&(O.current(),O.current=void 0)))}};if(x)switch(e.code){case"ArrowUp":{e.preventDefault(),c("prev");break}case"ArrowDown":{e.preventDefault(),c("next");break}case"ArrowLeft":{L||(e.preventDefault(),c("prev-level"));break}case"ArrowRight":{L||(e.preventDefault(),c("next-level"));break}case"Home":{e.preventDefault(),c("first");break}case"End":{e.preventDefault(),c("last");break}default:{(e.code==="Enter"||e.code==="Space"&&!I)&&(e.preventDefault(),L?je&&Te(je):Se&&Pe(Se));break}}else if(!(I&&["Home","End","Enter","Space"].includes(e.code)))switch(e.code){case"End":case"ArrowUp":{e.preventDefault(),A(!0),c("last");break}case"Home":case"ArrowDown":{e.preventDefault(),A(!0),c("first");break}case"Enter":case"Space":{e.preventDefault(),A(!0);break}default:{La(e.key)&&A(!0);break}}}},onChange:e=>{I&&Qe(e.currentTarget.value)}},I?{type:"text",value:oe,autoComplete:"off",disabled:Z}:{}))),[na,la,oa]=(()=>{let e=null,c=null,t;if(l){const i=[];for(const r of de){const u=K.get(r);u&&i.push(u)}c=s.jsx(Ea,{list:i.map(r=>{const{value:u,disabled:ae}=r.origin,ua=a?a(r.origin):be(r);return{id:u,title:ua,type:"item",disabled:ae,node:r}}),onClick:(r,u)=>{const ae=u.node.changeStatus("UNCHECKED",R);return $(Array.from(ae.keys())),!1},children:s.jsx(Ue,{tabIndex:-1,size:ge,children:R.size})}),e=i.map(r=>s.jsxs(Ue,{size:ge,children:[a?a(r.origin):r.origin.label,!(r.disabled||Z)&&s.jsx("div",{...v("cascader__close"),role:"button","aria-label":De("Close"),onClick:u=>{u.stopPropagation();const ae=r.changeStatus("UNCHECKED",R);$(Array.from(ae.keys()))},children:s.jsx(se,{children:s.jsx(wa,{})})})]},r.id))}else if(!F.isNull(R)){const i=K.get(R);i&&(t=be(i),e=a?a(i.origin):t)}return[e,c,t]})(),da=Ca({compose:{disabled:Z},form:g});return s.jsxs(s.Fragment,{children:[s.jsxs("div",{...C,...he(v("cascader",`cascader--${ge}`,{"cascader.is-expanded":x,"cascader.is-disabled":Z}),{className:C.className,style:C.style}),...da,ref:te,onMouseDown:e=>{var c;(c=C.onMouseDown)==null||c.call(C,e),fe(e)},onMouseUp:e=>{var c;(c=C.onMouseUp)==null||c.call(C,e),fe(e)},onClick:e=>{var c,t;(c=C.onClick)==null||c.call(C,e),(t=ie.current)==null||t.focus({preventScroll:!0}),A(i=>I?!0:!i)},children:[s.jsxs("div",{...v("cascader__container"),title:oa,children:[W?W(He):He,!_e&&(ue?s.jsx("div",{...v("cascader__content"),children:na}):P?s.jsx("div",{...v("cascader__placeholder-wrapper"),children:s.jsx("div",{...v("cascader__placeholder"),children:P})}):null)]}),l&&s.jsx("div",{...v("cascader__multiple-count"),onClick:e=>{e.stopPropagation()},children:la}),ze&&s.jsx("div",{...v("cascader__clear"),role:"button","aria-label":De("Clear"),onClick:e=>{e.stopPropagation(),q==null||q(),$(l?[]:null)},children:s.jsx(se,{children:s.jsx(Na,{})})}),s.jsx("div",{...he(v("cascader__icon"),{style:{visibility:ze?"hidden":void 0}}),children:s.jsx(se,{children:S?s.jsx(Ie,{}):_e?s.jsx(Ta,{}):s.jsx(Pa,{...v("cascader__arrow")})})})]}),s.jsx(Ia,{selector:()=>{let e=document.getElementById(`${U}-cascader-root`);return e||(e=document.createElement("div"),e.id=`${U}-cascader-root`,document.body.appendChild(e)),e},children:s.jsx(Ra,{enter:x,during:Ce,afterRender:()=>{var e;z(),(e=O.current)==null||e.call(O),O.current=void 0},afterEnter:()=>{M==null||M(!0)},afterLeave:()=>{M==null||M(!1)},children:e=>{let c={};switch(e){case"enter":c={transform:"scaleY(0.7)",opacity:0};break;case"entering":c={transition:["transform","opacity"].map(t=>`${t} ${Ce}ms ease-out`).join(", "),transformOrigin:$e};break;case"leaving":c={transform:"scaleY(0.7)",opacity:0,transition:["transform","opacity"].map(t=>`${t} ${Ce}ms ease-in`).join(", "),transformOrigin:$e};break;case"leaved":c={display:"none"};break}return s.jsxs("div",{...he(v("cascader-popup"),{style:{zIndex:sa,...ra,...c}}),ref:J,onMouseDown:t=>{fe(t)},onMouseUp:t=>{fe(t)},children:[S&&s.jsx("div",{...v("cascader-popup__loading",{"cascader-popup__loading--empty":Me}),children:s.jsx(se,{children:s.jsx(Ie,{})})}),S&&Me?null:L?s.jsx($a,{ref:ee,namespace:U,styled:v,id:ve,list:pe,customItem:N,itemId:xe,itemFocused:je,multiple:l,onlyLeafSelectable:w,virtual:o,focusVisible:Ae,onClick:t=>{We(t),Te(t)}}):s.jsx(Ge,{ref:ee,namespace:U,styled:v,id:ve,list:le,customItem:N,itemId:xe,itemSelected:!l&&ue?K.get(R):void 0,itemFocused:Se,multiple:l,virtual:o,focusVisible:Ae,onFocus:Fe,onClick:Pe})]})}})})]})}const es=n.forwardRef(Ha);export{es as C};
