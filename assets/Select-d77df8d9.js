import{r as c,u as ft,a as _t,b as ht,d as mt,v as bt,e as vt,c as pe,l as j,x as xt,F as gt,G as te,H as St,g as jt,R as Ie,W as se,J as ke,h as yt,i as wt,k as fe,m as W,j as l,p as Et,I as B,K as It,L as kt,q as Re,P as Rt,n as Dt,M as _e,A as Ct}from"./index-c3c40a13.js";import{u as Mt}from"./useForkRef-a3b85d85.js";import{S as Nt}from"./cancel-f87f223b.js";import{S as Lt}from"./add-445f0967.js";import{S as Pt}from"./keyboard_arrow_down-fb3f0949.js";import{S as Wt}from"./search-449e38bd.js";import{i as zt}from"./isPrintableCharacter-1b5c27a6.js";import{T as De}from"./Tag-44fff292.js";import{V as At}from"./VirtualScroll-8630f3df.js";import{C as Tt}from"./Checkbox-9890b3d3.js";import{E as Ce}from"./Empty-babf2027.js";const $t={select:"^select","select.is-expanded":"is-expanded","select.is-disabled":"is-disabled","select--small":"^select--small","select--medium":"^select--medium","select--large":"^select--large",select__container:"^select__container",select__content:"^select__content",select__search:"^select__search","select__placeholder-wrapper":"^select__placeholder-wrapper",select__placeholder:"^select__placeholder","select__multiple-count":"^select__multiple-count",select__close:"^select__close",select__clear:"^select__clear",select__icon:"^select__icon",select__arrow:"^select__arrow","select-popup":"^select-popup","select-popup__loading":"^select-popup__loading","select-popup__loading--empty":"^select-popup__loading--empty",select__list:"^select__list",select__option:"^select__option","select__option.is-selected":"is-selected","select__option.is-disabled":"is-disabled","select__option-prefix":"^select__option-prefix","select__option-content":"^select__option-content","select__option-group":"^select__option-group","select__option-group-label":"^select__option-group-label",select__empty:"^select__empty"},z=Symbol();function Ft(Me,Ne){const{styleOverrides:Le,styleProvider:D,formControl:m,list:C,model:Pe,defaultModel:We,visible:ze,defaultVisible:Ae,placeholder:he,multiple:d=!1,searchable:y=!1,searchValue:Te,defaultSearchValue:$e,clearable:Fe=!1,loading:G=!1,size:Ve,disabled:Oe=!1,monospaced:Ue=!0,virtual:A=!1,escClosable:He=!0,customItem:me,customSelected:M,customSearch:w,createItem:le,inputRef:Be,inputRender:be,onModelChange:ne,onVisibleChange:Ge,onSearch:Ke,onClear:ie,onCreateItem:oe,onScrollBottom:qe,afterVisibleChange:N,...p}=ft("Select",Me),L=_t(),o=ht($t,{select:D==null?void 0:D.select,"select-popup":D==null?void 0:D["select-popup"]},Le),x=mt(),{t:K}=bt(),ve=c.useId(),xe=`${L}-select-list-${ve}`,T=e=>`${L}-select-item-${e}-${ve}`,{pageScrollRef:Je,contentResizeRef:Ye}=vt(),E=c.useRef(null),b=c.useRef(null),I=c.useRef(null),q=c.useRef(null),Ze=Mt(q,Be),$=c.useRef(null),F=c.useMemo(()=>{const e=new Map,s=t=>{for(const n of t)e.set(n.value,n),n.children&&s(n.children)};return s(C),e},[C]),[r,g]=pe(Ae??!1,ze,Ge),[V,Qe]=pe($e??"",Te,Ke),k=c.useCallback(e=>!e.disabled&&!e.children,[]),[J,Y]=pe(We??(d?[]:null),Pe,e=>{ne&&(d?ne(e,e.map(s=>F.get(s))):ne(e,j.isNull(e)?null:F.get(e)))},void 0,m==null?void 0:m.control),v=c.useMemo(()=>d?new Set(J):J,[J,d]),Z=e=>{d?Y(s=>{const t=s.findIndex(n=>n===e);t!==-1?s.splice(t,1):s.push(e)}):(Y(e),g(!1))},{size:ce,disabled:P}=xt({size:Ve,disabled:Oe||(m==null?void 0:m.control.disabled)}),O=V.length>0,re=d?v.size>0:!j.isNull(v),ae=(()=>{if(!O)return[];const e=j.isUndefined(w==null?void 0:w.filter)?i=>i.label.includes(V):i=>w.filter(V,i),s=w==null?void 0:w.sort;let t=le==null?void 0:le(V);t&&(t={...t,[z]:!0});let n=[];return C.forEach(i=>{if(!i.children)t&&i.value===t.value&&(t=void 0),e(i)&&n.push(i);else{const u=[];i.children.forEach(h=>{t&&h.value===t.value&&(t=void 0),e(h)&&u.push(h)}),n=n.concat(u)}}),s&&n.sort(s),t&&n.unshift(t),n})(),U=O?ae:C,[Xe,et]=gt(e=>e.startsWith("Arrow")||["Home","End","Enter","Space"].includes(e)),[ge,tt]=c.useState(),st=(()=>{let e;return ge&&(e=F.get(ge.value),e&&k(e))||(re&&(e=te(C,s=>k(s)&&d?v.has(s.value):v===s.value)),j.isUndefined(e)&&(e=te(C,s=>k(s)))),e})(),[de,lt]=c.useState(),nt=(()=>{if(de&&te(ae,e=>k(e)&&e.value===de.value))return de;if(O)return te(ae,e=>k(e))})(),f=O?nt:st,Se=e=>{O?lt(e):tt(e)},je=e=>{if(!j.isUndefined(e)){const s=Object.assign({},e);delete s[z],oe==null||oe(s)}},it=St(r),ot=`calc(var(--${L}-zindex-fixed) + ${it})`,Q=c.useRef(),S=jt(()=>{if(r&&E.current&&b.current)if(Ue){const e=Math.min(E.current.offsetWidth,Ie.windowSize.width-se*2),s=b.current.offsetHeight,t=ke(E.current,{width:e,height:s},{placement:"bottom",inWindow:se});Q.current=t.transformOrigin,x.classes.position&&b.current.classList.toggle(x.classes.position,!1),x.replaceRule("position",{top:t.top,left:t.left,width:e}),b.current.classList.toggle(x.classes.position,!0)}else{const e=E.current.offsetWidth,s=b.current.offsetHeight,t=Ie.windowSize.width-se*2,n=Math.min(Math.max(b.current.scrollWidth,e),t),i=ke(E.current,{width:n,height:s},{placement:"bottom-left",inWindow:se});Q.current=i.transformOrigin,x.classes.position&&b.current.classList.toggle(x.classes.position,!1),x.replaceRule("position",{top:i.top,left:i.left,minWidth:Math.min(e,t),maxWidth:t}),b.current.classList.toggle(x.classes.position,!0)}}),ct=yt(S,!r);wt(Je,"scroll",S,{passive:!0},!r||ct),fe(E,S,void 0,!r),fe(b,S,void 0,!r),fe(Ye,S,void 0,!r),c.useImperativeHandle(Ne,()=>({updatePosition:S}),[S]);const X=e=>{document.activeElement===q.current&&e.target!==q.current&&e.button===0&&e.preventDefault()},R=c.useRef(),ee=y&&r,ye=Fe&&re&&!r&&!G&&!P,we=et(c.createElement(y?"input":"div",Object.assign({...W(o("select__search"),{style:{opacity:ee?void 0:0,zIndex:ee?void 0:-1}}),...m==null?void 0:m.inputAria,ref:Ze,tabIndex:P?-1:0,role:"combobox","aria-haspopup":"listbox","aria-expanded":r,"aria-controls":xe,onBlur:()=>{g(!1)},onKeyDown:e=>{if(e.code==="Escape")r&&He&&(e.stopPropagation(),e.preventDefault(),g(!1));else{const s=t=>{var n,i,u,h;if(I.current){let _;switch(t){case"next":_=(n=$.current)==null?void 0:n.scrollToStep(I.current,1);break;case"prev":_=(i=$.current)==null?void 0:i.scrollToStep(I.current,-1);break;case"first":_=(u=$.current)==null?void 0:u.scrollToStart(I.current);break;case"last":_=(h=$.current)==null?void 0:h.scrollToEnd(I.current);break}_&&(Se(_),A===!1&&(R.current=()=>{const a=document.getElementById(T(_.value));a&&Ct(a,I.current)},r&&(R.current(),R.current=void 0)))}};if(r)switch(e.code){case"ArrowUp":{e.preventDefault(),s("prev");break}case"ArrowDown":{e.preventDefault(),s("next");break}case"Home":{e.preventDefault(),s("first");break}case"End":{e.preventDefault(),s("last");break}default:{(e.code==="Enter"||e.code==="Space"&&!y)&&(e.preventDefault(),f&&(f[z]&&je(f),Z(f.value)));break}}else if(!(y&&["Home","End","Enter","Space"].includes(e.code)))switch(e.code){case"End":case"ArrowUp":{e.preventDefault(),g(!0),s("last");break}case"Home":case"ArrowDown":{e.preventDefault(),g(!0),s("first");break}case"Enter":case"Space":{e.preventDefault(),g(!0);break}default:{zt(e.key)&&g(!0);break}}}},onChange:e=>{y&&Qe(e.currentTarget.value)}},y?{type:"text",value:V,autoComplete:"off",disabled:P}:{}))),[rt,at,dt]=(()=>{let e=null,s=null,t;if(d){const n=[];for(const i of J){const u=F.get(i);u&&n.push(u)}s=l.jsx(Et,{list:n.map(i=>{const{label:u,value:h,disabled:_}=i,a=M?M(i):u;return{id:h,title:a,type:"item",disabled:_}}),onClick:i=>(Z(i),!1),children:l.jsx(De,{tabIndex:-1,size:ce,children:v.size})}),e=n.map(i=>l.jsxs(De,{size:ce,children:[M?M(i):i.label,!(i.disabled||P)&&l.jsx("div",{...o("select__close"),role:"button","aria-label":K("Close"),onClick:u=>{u.stopPropagation(),Z(i.value)},children:l.jsx(B,{children:l.jsx(It,{})})})]},i.value))}else if(!j.isNull(v)){const n=F.get(v);n&&(t=n.label,e=M?M(n):t)}return[e,s,t]})(),ut=kt({compose:{disabled:P},form:m}),pt=c.useMemo(()=>({list:U,itemKey:e=>e.value,itemSize:j.isNumber(A)?A:32,itemEmptySize:32,itemNested:e=>e.children,itemFocusable:k}),[k,U,A]);return l.jsxs(l.Fragment,{children:[l.jsxs("div",{...p,...W(o("select",`select--${ce}`,{"select.is-expanded":r,"select.is-disabled":P}),{className:p.className,style:p.style}),...ut,ref:E,onMouseDown:e=>{var s;(s=p.onMouseDown)==null||s.call(p,e),X(e)},onMouseUp:e=>{var s;(s=p.onMouseUp)==null||s.call(p,e),X(e)},onClick:e=>{var s,t;(s=p.onClick)==null||s.call(p,e),(t=q.current)==null||t.focus({preventScroll:!0}),g(n=>y?!0:!n)},children:[l.jsxs("div",{...o("select__container"),title:dt,children:[be?be(we):we,!ee&&(re?l.jsx("div",{...o("select__content"),children:rt}):he?l.jsx("div",{...o("select__placeholder-wrapper"),children:l.jsx("div",{...o("select__placeholder"),children:he})}):null)]}),d&&l.jsx("div",{...o("select__multiple-count"),onClick:e=>{e.stopPropagation()},children:at}),ye&&l.jsx("div",{...o("select__clear"),role:"button","aria-label":K("Clear"),onClick:e=>{e.stopPropagation(),Y(d?[]:null),ie==null||ie()},children:l.jsx(B,{children:l.jsx(Nt,{})})}),l.jsx("div",{...W(o("select__icon"),{style:{visibility:ye?"hidden":void 0}}),children:l.jsx(B,{children:G?l.jsx(Re,{}):ee?l.jsx(Wt,{}):l.jsx(Pt,{...o("select__arrow")})})})]}),l.jsx(Rt,{selector:()=>{let e=document.getElementById(`${L}-select-root`);return e||(e=document.createElement("div"),e.id=`${L}-select-root`,document.body.appendChild(e)),e},children:l.jsx(Dt,{enter:r,during:_e,afterRender:()=>{var e;S(),(e=R.current)==null||e.call(R),R.current=void 0},afterEnter:()=>{N==null||N(!0)},afterLeave:()=>{N==null||N(!1)},children:e=>{let s={};switch(e){case"enter":s={transform:"scaleY(0.7)",opacity:0};break;case"entering":s={transition:["transform","opacity"].map(t=>`${t} ${_e}ms ease-out`).join(", "),transformOrigin:Q.current};break;case"leaving":s={transform:"scaleY(0.7)",opacity:0,transition:["transform","opacity"].map(t=>`${t} ${_e}ms ease-in`).join(", "),transformOrigin:Q.current};break;case"leaved":s={display:"none"};break}return l.jsxs("div",{...W(o("select-popup"),{style:{zIndex:ot,...s}}),ref:b,onMouseDown:t=>{X(t)},onMouseUp:t=>{X(t)},children:[G&&l.jsx("div",{...o("select-popup__loading",{"select-popup__loading--empty":U.length===0}),children:l.jsx(B,{children:l.jsx(Re,{})})}),G&&U.length===0?null:l.jsx(At,{...pt,ref:$,enable:A!==!1,listSize:264,listPadding:4,itemRender:(t,n,i,u,h)=>{const{label:_,value:a,disabled:ue}=t,Ee=me?me(t):_;if(h)return c.createElement("ul",{...o("select__option-group"),key:a,role:"group","aria-labelledby":T(a)},c.createElement("li",{...o("select__option-group-label"),key:a,id:T(a),role:"presentation"},l.jsx("div",{...o("select__option-content"),children:Ee})),h);let H=!1;return d?H=v.has(a):H=v===a,c.createElement("li",{...W(o("select__option",{"select__option.is-selected":!d&&H,"select__option.is-disabled":ue}),{style:{paddingLeft:u.length===0?void 0:12+8}}),...i,key:a,id:T(a),title:(t[z]?K("Create")+" ":"")+_,role:"option","aria-selected":H,"aria-disabled":ue,onClick:()=>{t[z]&&je(t),Se(t),Z(a)}},Xe&&(f==null?void 0:f.value)===a&&l.jsx("div",{className:`${L}-focus-outline`}),t[z]?l.jsx("div",{...o("select__option-prefix"),children:l.jsx(B,{theme:"primary",children:l.jsx(Lt,{})})}):d?l.jsx("div",{...o("select__option-prefix"),children:l.jsx(Tt,{model:H,disabled:ue})}):null,l.jsx("div",{...o("select__option-content"),children:Ee}))},itemFocused:f==null?void 0:f.value,itemEmptyRender:()=>l.jsx("li",{...W(o("select__empty"),{style:{paddingLeft:12+8}}),children:l.jsx("div",{...o("select__option-content"),children:K("No Data")})}),itemInAriaSetsize:t=>!t.children,placeholder:"li",onScrollEnd:qe,children:(t,n)=>l.jsx("ul",{...o("select__list"),ref:I,id:xe,tabIndex:-1,role:"listbox","aria-multiselectable":d,"aria-activedescendant":j.isUndefined(f)?void 0:T(f.value),onScroll:n,children:U.length===0?l.jsx(Ce,{style:{padding:"12px 0"},image:Ce.SIMPLE_IMG}):t})})]})}})})]})}const Qt=c.forwardRef(Ft);export{Qt as S};
