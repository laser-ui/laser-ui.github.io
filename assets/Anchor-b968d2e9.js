import{r as o,u as M,b as U,d as q,e as J,f as K,g as Q,h as V,i as W,k as X,j as s,m as Y,l as g}from"./index-31205732.js";import{g as m}from"./getOffsetToRoot-f9d238cc.js";import{s as Z}from"./scrollTo-6e16e504.js";import{t as j}from"./toPx-46d8e116.js";const tt={anchor:"^anchor",anchor__link:"^anchor__link","anchor__link.is-active":"is-active","anchor__indicator-track":"^anchor__indicator-track","anchor__indicator-wrapper":"^anchor__indicator-wrapper","anchor__dot-indicator":"^anchor__dot-indicator","anchor__line-indicator":"^anchor__line-indicator"},A=Symbol(),L=Symbol();function et(O,b){const{styleOverrides:D,styleProvider:R,list:S,page:w,distance:l=0,scrollBehavior:B="instant",indicator:T=A,onClick:x,...k}=M("Anchor",O),u=U(tt,{anchor:R==null?void 0:R.anchor},D),{pageScrollRef:$,contentResizeRef:P}=q(),v=o.useRef(null),_=o.useRef(null),y=o.useRef(null),n=J(w??(()=>$.current)),C=o.useRef({}),[E,z]=o.useState(null),d=K(()=>{if(n.current){const r=m(n.current);let t;const c=f=>{f.forEach(({href:e,children:p})=>{const i=document.getElementById(e);if(i&&n.current){const a=m(i),I=g.isString(l)?j(l,!0):l;Math.ceil(n.current.scrollTop)+I>=a-r&&(g.isUndefined(t)?t=[e,a]:a>t[1]&&(t=[e,a]))}g.isArray(p)&&c(p)})};c(S);const h=t?t[0]:null;z(h)}});Q(()=>{d()},[]);const F=V(d);W(n,"scroll",d,{passive:!0},F),X(P,d),o.useEffect(()=>{if(v.current&&_.current)if(y.current){const r=y.current.getBoundingClientRect(),t=r.top-v.current.getBoundingClientRect().top+r.height/2;_.current.style.cssText=`opacity:1;top:${t}px;`}else _.current.style.cssText+="opacity:0;"}),o.useImperativeHandle(b,()=>({active:E,updateAnchor:d}),[E,d]);const G=r=>{var t,c;if(n.current){const h=m(n.current),f=n.current.scrollTop;window.location.hash=`#${r}`,n.current.scrollTop=f;const e=document.getElementById(r);if(e){const p=m(e),i=g.isString(l)?j(l,!0):l;(c=(t=C.current).clearTid)==null||c.call(t),C.current.clearTid=Z(n.current,{top:p-h-i,behavior:B})}}},H=(()=>{const r=(t,c=0)=>t.map(h=>{const{title:f,href:e,target:p,children:i}=h,a=e===E;return s.jsxs(o.Fragment,{children:[s.jsx("li",{...u("anchor__link",{"anchor__link.is-active":a}),ref:a?y:void 0,children:s.jsx("a",{style:{paddingLeft:16+c*16},href:`#${e}`,target:p,onClick:I=>{I.preventDefault(),G(e),x==null||x(e,h)},children:f??e})}),i&&r(i,c+1)]},`${e}-${c}`)});return r(S)})();return s.jsxs("ul",{...k,...Y(u("anchor"),{className:k.className,style:k.style}),ref:v,children:[s.jsx("div",{...u("anchor__indicator-track"),children:s.jsx("div",{...u("anchor__indicator-wrapper"),ref:_,children:T===A?s.jsx("div",{...u("anchor__dot-indicator")}):T===L?s.jsx("div",{...u("anchor__line-indicator")}):T})}),H]})}const N=o.forwardRef(et);N.DOT_INDICATOR=A;N.LINE_INDICATOR=L;export{N as A};
