import{w as ue,r as p,l as ae,j as t,X as he,I as k,q as _e,V as pe,u as ge,a as Se,b as be,c as D,y as xe,K as me,m as je,B as Z,A as ve}from"./index-e9d20fad.js";import{S as Ce}from"./keyboard_arrow_left-fd4da903.js";import{S as ye}from"./search-e04f3ea1.js";import{C as ee}from"./Checkbox-253f3a43.js";import{I as Ee}from"./Input-c337278b.js";import{E as se}from"./Empty-24c7320c.js";const Ie={transfer:"^transfer","transfer.is-disabled":"is-disabled",transfer__panel:"^transfer__panel",transfer__actions:"^transfer__actions",transfer__header:"^transfer__header","transfer__header-title":"^transfer__header-title",transfer__search:"^transfer__search","transfer__list-container":"^transfer__list-container",transfer__list:"^transfer__list",transfer__loading:"^transfer__loading",transfer__option:"^transfer__option","transfer__option.is-disabled":"is-disabled","transfer__option-prefix":"^transfer__option-prefix","transfer__option-content":"^transfer__option-content"},_=Symbol(),ne=Symbol();function te(T){const{namespace:N,styled:i,list:d,selectedCount:x,state:C,title:y,loading:K,searchable:B,virtual:g,customItem:E,onSelectedChange:m,onAllSelectedChange:f,onSearch:I,onScrollBottom:F}=T,{t:w}=ue(),j=p.useRef(null),c=p.useId(),A=e=>`${N}-transfer-item-${e}-${c}`,v=p.useCallback(e=>!e.disabled,[]),L=p.useMemo(()=>({list:d,itemKey:e=>e.value,itemSize:ae.isNumber(g)?g:32,itemFocusable:v}),[v,d,g]);return t.jsxs("div",{...i("transfer__panel"),children:[t.jsxs("div",{...i("transfer__header"),children:[t.jsxs(ee,{model:C===!0,indeterminate:C==="mixed",disabled:d.length===0,onModelChange:e=>{f(e)},children:[x,"/",d.length]}),he(y)&&t.jsx("div",{...i("transfer__header-title"),children:y})]}),B&&t.jsx("div",{...i("transfer__search"),children:t.jsx(Ee,{style:{display:"flex"},placeholder:w("Search"),prefix:t.jsx(k,{children:t.jsx(ye,{})}),clearable:!0,onModelChange:I})}),t.jsxs("div",{...i("transfer__list-container"),children:[K&&t.jsx("div",{...i("transfer__loading"),children:t.jsx(k,{children:t.jsx(_e,{})})}),t.jsx(pe,{...L,ref:e=>(j.current=e,()=>{j.current=null}),enable:g!==!1,listSize:192+32*2,listPadding:0,itemRender:(e,S,M)=>p.createElement("li",{...i("transfer__option",{"transfer__option.is-disabled":e.disabled}),...M,key:e.value,id:A(e.value),title:e.label,onClick:()=>{e.disabled||m==null||m(e.value)}},t.jsx("div",{...i("transfer__option-prefix"),children:t.jsx(ee,{model:e[_],disabled:e.disabled})}),t.jsx("div",{...i("transfer__option-content"),children:E?E(e.value,e[ne]?void 0:e):e.label})),placeholder:"li",onScrollEnd:F,children:(e,S)=>t.jsx("ul",{...i("transfer__list"),onScroll:S,children:d.length===0?t.jsx(se,{style:{marginTop:32},image:se.SIMPLE_IMG}):e})})]})]})}function ke(T){const{styleOverrides:N,styleProvider:i,formControl:d,list:x,model:C,defaultModel:y,selected:K,defaultSelected:B,searchable:g=!1,searchValue:E,defaultSearchValue:m,title:f,loading:I=[!1,!1],disabled:F=!1,virtual:w=!1,customItem:j,customSearch:c,onModelChange:A,onSelectedChange:v,onSearch:L,onScrollBottom:e,...S}=ge("Transfer",T),M=Se(),P=be(Ie,{transfer:i==null?void 0:i.transfer},N),O=p.useMemo(()=>new Map(x.map(s=>[s.value,s])),[x]),[$,re]=D(y??[],C,s=>{A&&A(s,s.map(a=>O.get(a)))},void 0,d==null?void 0:d.control),le=p.useMemo(()=>new Set($),[$]),[G,q]=D(B??[],K,s=>{v&&v(s,s.map(a=>O.get(a)))}),oe=p.useMemo(()=>new Set(G),[G]),[b,H]=D(m??["",""],E,L),{disabled:ie}=xe({disabled:F||(d==null?void 0:d.control.disabled)}),[u,U,R]=(()=>{const s=[[],[]],a=[0,0],l=[!0,!0],r=[!0,!0],h=[!1,!1],W=ae.isUndefined(c==null?void 0:c.filter)?(n,o)=>n.label.includes(o):(n,o)=>c.filter(o,n),V=c==null?void 0:c.sort,z=(n,o,fe)=>{const Y=Object.assign({[_]:!1,[ne]:fe},n);oe.has(n.value)?(Y[_]=!0,a[o]+=1,n.disabled||(h[o]=!0)):n.disabled||(r[o]=!1),s[o].push(Y),n.disabled||(l[o]=!1)};x.forEach(n=>{le.has(n.value)||(!b[0]||W(n,b[0]))&&z(n,0,!1)}),$.forEach(n=>{const o=O.get(n);b[1]?o&&W(o,b[1])&&z(o,1,!1):z(o??{label:n,value:n},1,!o)}),b[0]&&V&&s[0].sort(V),b[1]&&V&&s[1].sort(V);const ce=[0,1].map(n=>l[n]?!1:r[n]?!0:h[n]?"mixed":!1);return[s,a,ce]})(),X=s=>{q(a=>{const l=a.findIndex(r=>r===s);l!==-1?a.splice(l,1):a.push(s)})},J=(s,a)=>{q(l=>{const r=new Set(l);for(const h of a?u[0]:u[1])h.disabled||(s&&!h[_]?r.add(h.value):!s&&h[_]&&r.delete(h.value));return Array.from(r)})},Q=s=>{re(a=>{if(s){const l=new Set;return u[0].forEach(r=>{r[_]&&l.add(r.value)}),Array.from(l).concat(a)}else{const l=new Set(a);return u[1].forEach(r=>{r[_]&&l.delete(r.value)}),Array.from(l)}}),q(a=>{const l=new Set(a);return(s?u[0]:u[1]).forEach(r=>{r[_]&&l.delete(r.value)}),Array.from(l)})},de=me({form:d});return t.jsxs("div",{...S,...je(P("transfer",{"transfer.is-disabled":ie}),{className:S.className,style:S.style}),...de,children:[t.jsx(te,{namespace:M,styled:P,list:u[0],selectedCount:U[0],state:R[0],title:f==null?void 0:f[0],loading:I[0]??!1,searchable:g,virtual:w,customItem:j,onSelectedChange:X,onAllSelectedChange:s=>{J(s,!0)},onSearch:s=>{H(a=>{a[0]=s})},onScrollBottom:()=>{e==null||e("left")}}),t.jsxs("div",{...P("transfer__actions"),children:[t.jsx(Z,{disabled:R[0]===!1,pattern:"secondary",icon:t.jsx(k,{children:t.jsx(ve,{})}),onClick:()=>{Q(!0)}}),t.jsx(Z,{disabled:R[1]===!1,pattern:"secondary",icon:t.jsx(k,{children:t.jsx(Ce,{})}),onClick:()=>{Q(!1)}})]}),t.jsx(te,{namespace:M,styled:P,list:u[1],selectedCount:U[1],state:R[1],title:f==null?void 0:f[1],loading:I[1]??!1,searchable:g,virtual:w,customItem:j,onSelectedChange:X,onAllSelectedChange:s=>{J(s,!1)},onSearch:s=>{H(a=>{a[1]=s})},onScrollBottom:()=>{e==null||e("right")}})]})}export{ke as T};
