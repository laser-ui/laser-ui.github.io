import{r as c,u as ft,a as _t,b as ht,d as mt,v as bt,e as xt,c as fe,l as j,x as gt,F as vt,G as se,H as St,g as jt,R as Re,W as le,J as De,h as yt,i as _e,m as W,j as l,o as wt,I as H,K as Et,L as It,p as Ce,P as kt,k as Rt,M as he,A as Dt}from"./index-20025430.js";import{u as Ct}from"./useForkRef-82c6d308.js";import{S as Mt}from"./cancel-364802a6.js";import{S as Nt}from"./add-65ba78fe.js";import{S as Pt}from"./keyboard_arrow_down-c3ed5ad1.js";import{S as Wt}from"./search-f90602e1.js";import{B as zt}from"./BaseInput-8f47ba92.js";import{i as At}from"./isPrintableCharacter-1b5c27a6.js";import{T as Me}from"./Tag-43ae57ba.js";import{V as Lt}from"./VirtualScroll-3656e625.js";import{C as $t}from"./Checkbox-8fe35fa5.js";import{E as Ne}from"./Empty-3bbcb181.js";const Ft={select:"^select","select.is-expanded":"is-expanded","select.is-disabled":"is-disabled","select--small":"^select--small","select--medium":"^select--medium","select--large":"^select--large",select__container:"^select__container",select__content:"^select__content",select__search:"^select__search","select__placeholder-wrapper":"^select__placeholder-wrapper",select__placeholder:"^select__placeholder","select__multiple-count":"^select__multiple-count",select__close:"^select__close",select__clear:"^select__clear",select__icon:"^select__icon",select__arrow:"^select__arrow","select-popup":"^select-popup","select-popup__content":"^select-popup__content","select-popup__loading":"^select-popup__loading","select-popup__loading--empty":"^select-popup__loading--empty",select__list:"^select__list",select__option:"^select__option","select__option.is-selected":"is-selected","select__option.is-disabled":"is-disabled","select__option-prefix":"^select__option-prefix","select__option-content":"^select__option-content","select__option-group":"^select__option-group","select__option-group-label":"^select__option-group-label",select__empty:"^select__empty"},z=Symbol();function Tt(Pe,We){const{styleOverrides:ze,styleProvider:R,formControl:m,list:D,model:Ae,defaultModel:Le,visible:$e,defaultVisible:Fe,placeholder:me,multiple:d=!1,searchable:C=!1,searchValue:Te,defaultSearchValue:Ve,clearable:Oe=!1,loading:K=!1,size:Ue,disabled:Be=!1,monospaced:He=!0,virtual:A=!1,escClosable:Ke=!0,customItem:be,customSelected:G,customSearch:y,createItem:ne,inputRef:Ge,inputRender:xe,popupRender:ge,onModelChange:oe,onVisibleChange:Je,onSearch:Ye,onClear:ie,onCreateItem:ce,onScrollBottom:qe,afterVisibleChange:M,...p}=ft("Select",Pe),N=_t(),i=ht(Ft,{select:R==null?void 0:R.select,"select-popup":R==null?void 0:R["select-popup"]},ze),g=mt(),{t:J}=bt(),ve=c.useId(),Se=`${N}-select-list-${ve}`,L=e=>`${N}-select-item-${e}-${ve}`,{contentResizeRef:Ze}=xt(),v=c.useRef(null),b=c.useRef(null),w=c.useRef(null),Y=c.useRef(null),Qe=Ct(Y,Ge),$=c.useRef(null),F=c.useMemo(()=>{const e=new Map,t=s=>{for(const n of s)e.set(n.value,n),n.children&&t(n.children)};return t(D),e},[D]),[u,S]=fe(Fe??!1,$e,Je),[T,Xe]=fe(Ve??"",Te,Ye),E=c.useCallback(e=>!e.disabled&&!e.children,[]),[q,Z]=fe(Le??(d?[]:null),Ae,e=>{oe&&(d?oe(e,e.map(t=>F.get(t))):oe(e,j.isNull(e)?null:F.get(e)))},void 0,m==null?void 0:m.control),h=c.useMemo(()=>d?new Set(q):q,[q,d]),Q=e=>{d?Z(t=>{const s=t.findIndex(n=>n===e);s!==-1?t.splice(s,1):t.push(e)}):(Z(e),S(!1))},{size:re,disabled:P}=gt({size:Ue,disabled:Be||(m==null?void 0:m.control.disabled)}),V=T.length>0,ae=d?h.size>0:!j.isNull(h),de=(()=>{if(!V)return[];const e=j.isUndefined(y==null?void 0:y.filter)?o=>o.label.includes(T):o=>y.filter(T,o),t=y==null?void 0:y.sort;let s=ne==null?void 0:ne(T);s&&(s={...s,[z]:!0});let n=[];return D.forEach(o=>{if(!o.children)s&&o.value===s.value&&(s=void 0),e(o)&&n.push(o);else{const r=[];o.children.forEach(a=>{s&&a.value===s.value&&(s=void 0),e(a)&&r.push(a)}),n=n.concat(r)}}),t&&n.sort(t),s&&n.unshift(s),n})(),O=V?de:D,[et,tt]=vt(e=>e.startsWith("Arrow")||["Home","End","Enter","Space"].includes(e)),[je,st]=c.useState(),lt=(()=>{let e;return je&&(e=F.get(je.value),e&&E(e))||(ae&&(e=se(D,t=>E(t)&&d?h.has(t.value):h===t.value)),j.isUndefined(e)&&(e=se(D,t=>E(t)))),e})(),[ue,nt]=c.useState(),ot=(()=>{if(ue&&se(de,e=>E(e)&&e.value===ue.value))return ue;if(V)return se(de,e=>E(e))})(),f=V?ot:lt,ye=e=>{V?nt(e):st(e)},we=e=>{if(!j.isUndefined(e)){const t=Object.assign({},e);delete t[z],ce==null||ce(t)}},it=St(u),ct=`calc(var(--${N}-zindex-fixed) + ${it})`,X=c.useRef(),I=jt(()=>{if(u&&v.current&&b.current)if(He){const e=Math.min(v.current.offsetWidth,Re.windowSize.width-le*2),t=b.current.offsetHeight,s=De(v.current,{width:e,height:t},{placement:"bottom",inWindow:le});X.current=s.transformOrigin,g.classes.position&&b.current.classList.toggle(g.classes.position,!1),g.replaceRule("position",{top:s.top,left:s.left,width:e}),b.current.classList.toggle(g.classes.position,!0)}else{const e=v.current.offsetWidth,t=b.current.offsetHeight,s=Re.windowSize.width-le*2,n=Math.min(Math.max(b.current.scrollWidth,e),s),o=De(v.current,{width:n,height:t},{placement:"bottom-left",inWindow:le});X.current=o.transformOrigin,g.classes.position&&b.current.classList.toggle(g.classes.position,!1),g.replaceRule("position",{top:o.top,left:o.left,minWidth:Math.min(e,s),maxWidth:s}),b.current.classList.toggle(g.classes.position,!0)}});yt(v,I,!u),_e(v,I,void 0,!u),_e(b,I,void 0,!u),_e(Ze,I,void 0,!u),c.useImperativeHandle(We,()=>({updatePosition:I}),[I]);const ee=e=>{document.activeElement===Y.current&&e.target!==Y.current&&e.button===0&&e.preventDefault()},k=c.useRef(),te=C&&u,Ee=Oe&&ae&&!u&&!K&&!P,Ie=tt(c.createElement(C?zt:"div",Object.assign({...W(i("select__search"),{style:{opacity:te?void 0:0,zIndex:te?void 0:-1}}),...m==null?void 0:m.inputAria,ref:Qe,tabIndex:P?-1:0,role:"combobox","aria-haspopup":"listbox","aria-expanded":u,"aria-controls":Se,onBlur:()=>{S(!1)},onKeyDown:e=>{if(e.code==="Escape")u&&Ke&&(e.stopPropagation(),e.preventDefault(),S(!1));else{const t=s=>{var n,o,r,a;if(w.current){let _;switch(s){case"next":_=(n=$.current)==null?void 0:n.scrollToStep(w.current,1);break;case"prev":_=(o=$.current)==null?void 0:o.scrollToStep(w.current,-1);break;case"first":_=(r=$.current)==null?void 0:r.scrollToStart(w.current);break;case"last":_=(a=$.current)==null?void 0:a.scrollToEnd(w.current);break}_&&(ye(_),A===!1&&(k.current=()=>{const U=document.getElementById(L(_.value));U&&Dt(U,w.current)},u&&(k.current(),k.current=void 0)))}};if(u)switch(e.code){case"ArrowUp":{e.preventDefault(),t("prev");break}case"ArrowDown":{e.preventDefault(),t("next");break}case"Home":{e.preventDefault(),t("first");break}case"End":{e.preventDefault(),t("last");break}default:{(e.code==="Enter"||e.code==="Space"&&!C)&&(e.preventDefault(),f&&(f[z]&&we(f),Q(f.value)));break}}else if(!(C&&["Home","End","Enter","Space"].includes(e.code)))switch(e.code){case"End":case"ArrowUp":{e.preventDefault(),S(!0),t("last");break}case"Home":case"ArrowDown":{e.preventDefault(),S(!0),t("first");break}case"Enter":case"Space":{e.preventDefault(),S(!0);break}default:{At(e.key)&&S(!0);break}}}}},C?{type:"text",value:T,autoComplete:"off",disabled:P,onValueChange:e=>{Xe(e)}}:{}))),[rt,at,dt]=(()=>{let e=null,t=null,s;if(d){const n=q.map(o=>{const r=F.get(o);return{value:o,label:G?G(o,r):r?r.label:String(o),item:r}});t=l.jsx(wt,{list:n.map(({value:o,label:r,item:a})=>({id:o,title:r,type:"item",disabled:a==null?void 0:a.disabled})),onClick:o=>(Q(o),!1),children:l.jsx(Me,{tabIndex:-1,size:re,children:h.size})}),e=n.map(({value:o,label:r,item:a})=>l.jsxs(Me,{size:re,children:[r,!(a!=null&&a.disabled||P)&&l.jsx("div",{...i("select__close"),role:"button","aria-label":J("Close"),onClick:_=>{_.stopPropagation(),Q(o)},children:l.jsx(H,{children:l.jsx(Et,{})})})]},o))}else if(!j.isNull(h)){const n=F.get(h);e=s=G?G(h,n):n?n.label:String(h)}return[e,t,s]})(),ut=It({compose:{disabled:P},form:m}),pt=c.useMemo(()=>({list:O,itemKey:e=>e.value,itemSize:j.isNumber(A)?A:32,itemEmptySize:32,itemNested:e=>e.children,itemFocusable:E}),[E,O,A]);return l.jsxs(l.Fragment,{children:[l.jsxs("div",{...p,...W(i("select",`select--${re}`,{"select.is-expanded":u,"select.is-disabled":P}),{className:p.className,style:p.style}),...ut,ref:v,onMouseDown:e=>{var t;(t=p.onMouseDown)==null||t.call(p,e),ee(e)},onMouseUp:e=>{var t;(t=p.onMouseUp)==null||t.call(p,e),ee(e)},onClick:e=>{var t,s;(t=p.onClick)==null||t.call(p,e),(s=Y.current)==null||s.focus({preventScroll:!0}),S(n=>C?!0:!n)},children:[l.jsxs("div",{...i("select__container"),title:dt,children:[xe?xe(Ie):Ie,!te&&(ae?l.jsx("div",{...i("select__content"),children:rt}):me?l.jsx("div",{...i("select__placeholder-wrapper"),children:l.jsx("div",{...i("select__placeholder"),children:me})}):null)]}),d&&l.jsx("div",{...i("select__multiple-count"),onClick:e=>{e.stopPropagation()},children:at}),Ee&&l.jsx("div",{...i("select__clear"),role:"button","aria-label":J("Clear"),onClick:e=>{e.stopPropagation(),Z(d?[]:null),ie==null||ie()},children:l.jsx(H,{children:l.jsx(Mt,{})})}),l.jsx("div",{...W(i("select__icon"),{style:{visibility:Ee?"hidden":void 0}}),children:l.jsx(H,{children:K?l.jsx(Ce,{}):te?l.jsx(Wt,{}):l.jsx(Pt,{...i("select__arrow")})})})]}),l.jsx(kt,{selector:()=>{let e=document.getElementById(`${N}-select-root`);return e||(e=document.createElement("div"),e.id=`${N}-select-root`,document.body.appendChild(e)),e},children:l.jsx(Rt,{enter:u,during:he,afterRender:()=>{var e;I(),(e=k.current)==null||e.call(k),k.current=void 0},afterEnter:()=>{M==null||M(!0)},afterLeave:()=>{M==null||M(!1)},children:e=>{let t={};switch(e){case"enter":t={transform:"scaleY(0.7)",opacity:0};break;case"entering":t={transition:["transform","opacity"].map(s=>`${s} ${he}ms ease-out`).join(", "),transformOrigin:X.current};break;case"leaving":t={transform:"scaleY(0.7)",opacity:0,transition:["transform","opacity"].map(s=>`${s} ${he}ms ease-in`).join(", "),transformOrigin:X.current};break;case"leaved":t={display:"none"};break}return l.jsx("div",{...W(i("select-popup"),{style:{zIndex:ct,...t}}),ref:b,onMouseDown:s=>{ee(s)},onMouseUp:s=>{ee(s)},children:(()=>{const s=l.jsxs("div",{...i("select-popup__content"),children:[K&&l.jsx("div",{...i("select-popup__loading",{"select-popup__loading--empty":O.length===0}),children:l.jsx(H,{children:l.jsx(Ce,{})})}),K&&O.length===0?null:l.jsx(Lt,{...pt,ref:$,enable:A!==!1,listSize:264,listPadding:4,itemRender:(n,o,r,a,_)=>{const{label:U,value:x,disabled:pe}=n,ke=be?be(n):U;if(_)return c.createElement("ul",{...i("select__option-group"),key:x,role:"group","aria-labelledby":L(x)},c.createElement("li",{...i("select__option-group-label"),key:x,id:L(x),role:"presentation"},l.jsx("div",{...i("select__option-content"),children:ke})),_);let B=!1;return d?B=h.has(x):B=h===x,c.createElement("li",{...W(i("select__option",{"select__option.is-selected":!d&&B,"select__option.is-disabled":pe}),{style:{paddingLeft:a.length===0?void 0:20}}),...r,key:x,id:L(x),title:(n[z]?J("Create")+" ":"")+U,role:"option","aria-selected":B,"aria-disabled":pe,onClick:()=>{n[z]&&we(n),ye(n),Q(x)}},et&&(f==null?void 0:f.value)===x&&l.jsx("div",{className:`${N}-focus-outline`}),n[z]?l.jsx("div",{...i("select__option-prefix"),children:l.jsx(H,{theme:"primary",children:l.jsx(Nt,{})})}):d?l.jsx("div",{...i("select__option-prefix"),children:l.jsx($t,{model:B,disabled:pe})}):null,l.jsx("div",{...i("select__option-content"),children:ke}))},itemFocused:f==null?void 0:f.value,itemEmptyRender:()=>l.jsx("li",{...W(i("select__empty"),{style:{paddingLeft:20}}),children:l.jsx("div",{...i("select__option-content"),children:J("No Data")})}),itemInAriaSetsize:n=>!n.children,placeholder:"li",onScrollEnd:qe,children:(n,o)=>l.jsx("ul",{...i("select__list"),ref:w,id:Se,tabIndex:-1,role:"listbox","aria-multiselectable":d,"aria-activedescendant":j.isUndefined(f)?void 0:L(f.value),onScroll:o,children:O.length===0?l.jsx(Ne,{style:{padding:"12px 0"},image:Ne.SIMPLE_IMG}):n})})]});return ge?ge(s):s})()})}})})]})}const Xt=c.forwardRef(Tt);export{Xt as S};
