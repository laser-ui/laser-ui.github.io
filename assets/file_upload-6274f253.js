import{r as v,d as te,u as V,b as z,x as J,l as L,m as H,j as t,I as N,s as se,C as ue,T as ie,a as pe,n as me,c as _e,v as he,g as ve}from"./index-10b5111c.js";import{s as xe}from"./setRef-7888271b.js";import{F as ge}from"./file_download-f0f31c00.js";import{S as fe}from"./add-994f9dab.js";import{S as be}from"./visibility-f146c88d.js";import{u as je}from"./Route-ee2bc93c.js";import{P as re}from"./Progress-392ad08a.js";function we(h,e){const d=document.createElement("a");document.body.appendChild(d),d.style.display="none",d.href=h,d.download=e,d.click(),document.body.removeChild(d)}const Ue=h=>v.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",...h},v.createElement("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM8 9h8v10H8V9zm7.5-5-1-1h-5l-1 1H5v2h14V4h-3.5z"})),ye={upload:"^upload"},Se={"upload-button":"^upload-button","upload-button.is-disabled":"is-disabled","upload-button--load":"^upload-button--load","upload-button--error":"^upload-button--error","upload-button--progress":"^upload-button--progress","upload-button__thumbnail":"^upload-button__thumbnail","upload-button__name":"^upload-button__name","upload-button__actions":"^upload-button__actions","upload-button__icon":"^upload-button__icon","upload-button__text":"^upload-button__text"},de={"upload-action":"^upload-action","upload-action.is-disabled":"is-disabled","upload-action--light":"^upload-action--light","upload-action--preview":"^upload-action--preview"},ke={"upload-list":"^upload-list","upload-list__row":"^upload-list__row","upload-list__item":"^upload-list__item","upload-list__item--load":"^upload-list__item--load","upload-list__item--error":"^upload-list__item--error","upload-list__item--progress":"^upload-list__item--progress","upload-list__icon":"^upload-list__icon","upload-list__link":"^upload-list__link","upload-list__link.is-active":"is-active","upload-list__actions":"^upload-list__actions","upload-list__progress-wrapper":"^upload-list__progress-wrapper"},Ee={"upload-picture":"^upload-picture","upload-picture__row":"^upload-picture__row","upload-picture__item":"^upload-picture__item","upload-picture__item.is-disabled":"is-disabled","upload-picture__item--load":"^upload-picture__item--load","upload-picture__item--error":"^upload-picture__item--error","upload-picture__item--progress":"^upload-picture__item--progress","upload-picture__thumbnail":"^upload-picture__thumbnail","upload-picture__name":"^upload-picture__name","upload-picture__actions":"^upload-picture__actions","upload-picture__progress-text":"^upload-picture__progress-text"},Fe={"upload-picture-list":"^upload-picture-list","upload-picture-list__row":"^upload-picture-list__row","upload-picture-list__item":"^upload-picture-list__item","upload-picture-list__item--load":"^upload-picture-list__item--load","upload-picture-list__item--error":"^upload-picture-list__item--error","upload-picture-list__item--progress":"^upload-picture-list__item--progress","upload-picture-list__thumbnail":"^upload-picture-list__thumbnail","upload-picture-list__thumbnail-img":"^upload-picture-list__thumbnail-img","upload-picture-list__link":"^upload-picture-list__link","upload-picture-list__link.is-active":"is-active","upload-picture-list__actions":"^upload-picture-list__actions","upload-picture-list__progress-wrapper":"^upload-picture-list__progress-wrapper"},K=v.createContext({files:[],onRemove:()=>{}}),B=v.createContext(void 0);function W(h){const e=te.c(22),{ref:d,styleOverrides:w,styleProvider:r,children:b,preset:l,disabled:m,...u}=V("UploadAction",h),c=m===void 0?!1:m,U=r==null?void 0:r["upload-action"];let j;e[0]!==U?(j={"upload-action":U},e[0]=U,e[1]=j):j=e[1];const f=z(de,j,w),{t:s}=J(),i=v.use(B),o=l==="download"?c||L.isUndefined(i==null?void 0:i.file.url):c,n=H(f("upload-action",{"upload-action.is-disabled":o,"upload-action--light":i==null?void 0:i.light}),{className:u.className,style:u.style}),a=u.role??"button",_=u.tabIndex??(o?-1:0);let x;e[2]!==l||e[3]!==u.title||e[4]!==s?(x=u.title??l==="download"?s("Upload","Download file"):l==="remove"?s("Upload","Remove file"):void 0,e[2]=l,e[3]=u.title,e[4]=s,e[5]=x):x=e[5];let g;e[6]!==l||e[7]!==u||e[8]!==i?(g=A=>{var p,E,y;(p=u.onClick)==null||p.call(u,A),A.stopPropagation(),i&&(l==="download"?(E=i.defaultActions)!=null&&E.download?i.defaultActions.download(i.file):we(i.file.url,i.file.name):l==="remove"&&((y=i.onRemove)==null||y.call(i)))},e[6]=l,e[7]=u,e[8]=i,e[9]=g):g=e[9];let S;e[10]!==b||e[11]!==l?(S=b??(l==="download"?t.jsx(N,{children:t.jsx(ge,{})}):l==="remove"?t.jsx(N,{children:t.jsx(Ue,{})}):null),e[10]=b,e[11]=l,e[12]=S):S=e[12];let k;return e[13]!==d||e[14]!==u||e[15]!==n||e[16]!==a||e[17]!==_||e[18]!==x||e[19]!==g||e[20]!==S?(k=t.jsx("div",{...u,...n,ref:d,role:a,tabIndex:_,title:x,onClick:g,children:S}),e[13]=d,e[14]=u,e[15]=n,e[16]=a,e[17]=_,e[18]=x,e[19]=g,e[20]=S,e[21]=k):k=e[21],k}const le=h=>v.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",...h},v.createElement("path",{d:"M13 4H6v16h12V9h-5z",opacity:.3}),v.createElement("path",{d:"m20 8-6-6H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8zm-2 12H6V4h7v5h5v11z"}));function oe(h){const e=te.c(19),{ref:d,styleOverrides:w,styleProvider:r,children:b,disabled:l,...m}=V("UploadPreviewAction",h),u=l===void 0?!1:l,c=r==null?void 0:r["upload-action"];let U;e[0]!==c?(U={"upload-action":c},e[0]=c,e[1]=U):U=e[1];const j=z(de,U,w),{t:f}=J(),s=v.use(B),i=H(j("upload-action","upload-action--preview",{"upload-action.is-disabled":u||L.isUndefined(s==null?void 0:s.file.url),"upload-action--light":s==null?void 0:s.light}),{className:m.className,style:m.style}),o=s==null?void 0:s.file.url,n=m.target??"_blank";let a;e[2]!==m.title||e[3]!==f?(a=m.title??f("Upload","Preview file"),e[2]=m.title,e[3]=f,e[4]=a):a=e[4];let _;e[5]!==m||e[6]!==s?(_=S=>{var k,A;(k=m.onClick)==null||k.call(m,S),S.stopPropagation(),s&&(A=s.defaultActions)!=null&&A.preview&&(S.preventDefault(),s.defaultActions.preview(s.file))},e[5]=m,e[6]=s,e[7]=_):_=e[7];let x;e[8]!==b?(x=b??t.jsx(N,{children:t.jsx(be,{})}),e[8]=b,e[9]=x):x=e[9];let g;return e[10]!==d||e[11]!==m||e[12]!==i||e[13]!==o||e[14]!==n||e[15]!==a||e[16]!==_||e[17]!==x?(g=t.jsx("a",{...m,...i,ref:d,href:o,target:n,title:a,onClick:_,children:x}),e[10]=d,e[11]=m,e[12]=i,e[13]=o,e[14]=n,e[15]=a,e[16]=_,e[17]=x,e[18]=g):g=e[18],g}function Le(h){const{ref:e,styleOverrides:d,styleProvider:w,file:r,actions:b,defaultActions:l,onRemove:m,...u}=V("UploadButton",h),c=z(Se,{"upload-button":w==null?void 0:w["upload-button"]},d),{t:U}=J(),j=r&&r.state==="progress";return t.jsx("div",{...u,...H(c("upload-button",{"upload-button.is-disabled":j,[`upload-button--${r==null?void 0:r.state}`]:r}),{className:u.className,style:u.style}),ref:e,tabIndex:u.tabIndex??(j?-1:0),children:r&&r.state!=="progress"?t.jsxs(t.Fragment,{children:[r.thumbUrl?t.jsx("img",{...c("upload-button__thumbnail"),src:r.thumbUrl,alt:r.name}):t.jsxs(t.Fragment,{children:[t.jsx(N,{theme:r.state==="error"?"danger":"primary",children:t.jsx(le,{})}),t.jsx("div",{...c("upload-button__name"),children:r.name})]}),t.jsx("div",{...c("upload-button__actions"),children:t.jsx(B,{value:{file:r,defaultActions:l,light:!0,onRemove:m},children:(b??[t.jsx(oe,{}),t.jsx(W,{preset:"remove"})]).map((f,s)=>{const{id:i,action:o}=L.has(f,["id","action"])?f:{id:s,action:f};return t.jsx(v.Fragment,{children:o},i)})})})]}):t.jsxs(t.Fragment,{children:[t.jsx("div",{...c("upload-button__icon"),children:t.jsx(N,{children:j?t.jsx(se,{}):t.jsx(fe,{})})}),t.jsx("div",{...c("upload-button__text"),children:U("Upload",j?"Uploading":"Upload")})]})})}const Re=h=>v.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",...h},v.createElement("path",{d:"M16.5 6v11.5c0 2.21-1.79 4-4 4s-4-1.79-4-4V5a2.5 2.5 0 0 1 5 0v10.5c0 .55-.45 1-1 1s-1-.45-1-1V6H10v9.5a2.5 2.5 0 0 0 5 0V5c0-2.21-1.79-4-4-4S7 2.79 7 5v12.5c0 3.04 2.46 5.5 5.5 5.5s5.5-2.46 5.5-5.5V6h-1.5z"}));function ne(){const h=te.c(1),e=v.useRef(!1);let d;return h[0]===Symbol.for("react.memo_cache_sentinel")?(d=()=>{e.current=!0},h[0]=d):d=h[0],je(d),e}function Te(h){var j,f;const{styleOverrides:e,styleProvider:d,actions:w,defaultActions:r,...b}=V("UploadList",h),l=z(ke,{"upload-list":d==null?void 0:d["upload-list"]},e),{files:m,onRemove:u}=v.use(K),c=v.useRef(m);{const s=m.map(o=>Object.assign({},o));let i=-1;for(const o of c.current)i+=1,o.__removing&&((j=c.current[i-1])==null?void 0:j.uid)===((f=s[i-1])==null?void 0:f.uid)&&s.splice(i,0,o);c.current=s}const U=ne();return t.jsx("ul",{...b,...H(l("upload-list"),{className:b.className,style:b.style}),children:t.jsx("div",{...l("upload-list__row"),children:c.current.map((s,i)=>t.jsx(ue,{height:0,enter:!s.__removing,duration:ie,skipFirstTransition:!U.current,onAfterLeave:()=>{const o=c.current.findIndex(n=>n.uid===s.uid);o!==-1&&c.current.splice(o,1)},children:(o,n)=>n?null:t.jsx("div",{ref:a=>(o(a),()=>{o(null)}),children:t.jsxs("li",{...l("upload-list__item",{[`upload-list__item--${s.state}`]:s.state}),children:[t.jsx("div",{...l("upload-list__icon"),children:s.state==="progress"?t.jsx(N,{children:t.jsx(se,{})}):t.jsx(N,{rotate:45,children:t.jsx(Re,{})})}),t.jsx("a",{...l("upload-list__link",{"upload-list__link.is-active":s.state==="load"&&!L.isUndefined(s.url)}),href:s.url,target:"_blank",rel:"noreferrer",title:s.name,onClick:a=>{r&&r.preview&&(a.preventDefault(),r.preview(s))},children:s.name}),t.jsx("div",{...l("upload-list__actions"),children:t.jsx(B,{value:{file:s,defaultActions:r,onRemove:()=>{s.__removing=!0,u(s)}},children:(w?w(s,i):[t.jsx(W,{preset:"remove"})]).map((a,_)=>{const{id:x,action:g}=L.has(a,["id","action"])?a:{id:_,action:a};return t.jsx(v.Fragment,{children:g},x)})})}),t.jsx("div",{...l("upload-list__progress-wrapper"),children:L.isNumber(s.percent)&&t.jsx(re,{percent:s.percent,label:!1,lineWidth:2})})]})})},s.uid))})})}function Ne(h){var i,o;const{children:e,styleOverrides:d,styleProvider:w,actions:r,defaultActions:b,...l}=V("UploadPicture",h),m=pe(),u=z(Ee,{"upload-picture":w==null?void 0:w["upload-picture"]},d),{t:c}=J(),{files:U,onRemove:j}=v.use(K),f=v.useRef(U);{const n=U.map(_=>Object.assign({},_));let a=-1;for(const _ of f.current)a+=1,_.__removing&&((i=f.current[a-1])==null?void 0:i.uid)===((o=n[a-1])==null?void 0:o.uid)&&n.splice(a,0,_);f.current=n}const s=ne();return t.jsx("ul",{...l,...H(u("upload-picture"),{className:l.className,style:l.style}),children:t.jsxs("div",{...u("upload-picture__row"),children:[f.current.map((n,a)=>t.jsx(me,{enter:!n.__removing,name:`${m}-upload-picture`,duration:ie,skipFirstTransition:!s.current,onAfterLeave:()=>{const _=f.current.findIndex(x=>x.uid===n.uid);_!==-1&&f.current.splice(_,1)},children:(_,x)=>x?null:t.jsx("div",{ref:g=>(_(g),()=>{_(null)}),children:t.jsx("li",{...u("upload-picture__item",{[`upload-picture__item--${n.state}`]:n.state,"upload-picture__item.is-disabled":n&&n.state==="progress"}),children:n.state!=="progress"?t.jsxs(t.Fragment,{children:[n.thumbUrl?t.jsx("img",{...u("upload-picture__thumbnail"),src:n.thumbUrl,alt:n.name}):t.jsxs(t.Fragment,{children:[t.jsx(N,{size:28,theme:n.state==="error"?"danger":"primary",children:t.jsx(le,{})}),t.jsx("div",{...u("upload-picture__name"),children:n.name})]}),t.jsx("div",{...u("upload-picture__actions"),children:t.jsx(B,{value:{file:n,defaultActions:b,light:!0,onRemove:()=>{n.__removing=!0,j(n)}},children:(r?r(n,a):[t.jsx(oe,{}),t.jsx(W,{preset:"remove"})]).map((g,S)=>{const{id:k,action:A}=L.has(g,["id","action"])?g:{id:S,action:g};return t.jsx(v.Fragment,{children:A},k)})})})]}):t.jsxs(t.Fragment,{children:[t.jsx("div",{...u("upload-picture__progress-text"),children:c("Upload","Uploading")}),L.isNumber(n.percent)&&t.jsx(re,{style:{width:"100%"},percent:n.percent,label:!1,lineWidth:2})]})})})},n.uid)),t.jsx("div",{children:e})]})})}function Ae(h){var j,f;const{styleOverrides:e,styleProvider:d,actions:w,defaultActions:r,...b}=V("UploadPictureList",h),l=z(Fe,{"upload-picture-list":d==null?void 0:d["upload-picture-list"]},e),{files:m,onRemove:u}=v.use(K),c=v.useRef(m);{const s=m.map(o=>Object.assign({},o));let i=-1;for(const o of c.current)i+=1,o.__removing&&((j=c.current[i-1])==null?void 0:j.uid)===((f=s[i-1])==null?void 0:f.uid)&&s.splice(i,0,o);c.current=s}const U=ne();return t.jsx("ul",{...b,...H(l("upload-picture-list"),{className:b.className,style:b.style}),children:t.jsx("div",{...l("upload-picture-list__row"),children:c.current.map((s,i)=>t.jsx(ue,{height:0,enter:!s.__removing,duration:ie,skipFirstTransition:!U.current,onAfterLeave:()=>{const o=c.current.findIndex(n=>n.uid===s.uid);o!==-1&&c.current.splice(o,1)},children:(o,n)=>n?null:t.jsx("div",{ref:a=>(o(a),()=>{o(null)}),children:t.jsxs("li",{...l("upload-picture-list__item",{[`upload-picture-list__item--${s.state}`]:s.state}),children:[t.jsx("div",{...l("upload-picture-list__thumbnail"),children:s.state==="progress"?t.jsx(N,{size:28,children:t.jsx(se,{})}):s.thumbUrl?t.jsx("img",{...l("upload-picture-list__thumbnail-img"),src:s.thumbUrl,alt:s.name}):t.jsx(N,{size:28,theme:s.state==="error"?"danger":"primary",children:t.jsx(le,{})})}),t.jsx("a",{...l("upload-picture-list__link",{"upload-picture-list__link.is-active":s.state==="load"&&!L.isUndefined(s.url)}),href:s.url,target:"_blank",rel:"noreferrer",title:s.name,onClick:a=>{r&&r.preview&&(a.preventDefault(),r.preview(s))},children:s.name}),t.jsx("div",{...l("upload-picture-list__actions"),children:t.jsx(B,{value:{file:s,defaultActions:r,onRemove:()=>{s.__removing=!0,u(s)}},children:(w?w(s,i):[t.jsx(W,{preset:"remove"})]).map((a,_)=>{const{id:x,action:g}=L.has(a,["id","action"])?a:{id:_,action:a};return t.jsx(v.Fragment,{children:g},x)})})}),t.jsx("div",{...l("upload-picture-list__progress-wrapper"),children:L.isNumber(s.percent)&&t.jsx(re,{percent:s.percent,label:!1,lineWidth:2})})]})})},s.uid))})})}const $=h=>{const{ref:e,children:d,styleOverrides:w,styleProvider:r,formControl:b,model:l,defaultModel:m,request:u,max:c,drag:U=!1,customUpload:j,beforeUpload:f,onModelChange:s,onRemove:i,...o}=V("Upload",h),n=z(ye,{upload:r==null?void 0:r.upload,"upload-list":r==null?void 0:r["upload-list"]},w),a=v.useRef(null),_=v.useRef([]),[x,g]=_e(m??[],l,void 0,void 0,b==null?void 0:b.control);he(()=>{_.current.forEach(p=>{URL.revokeObjectURL(p)})});const S=p=>{if(j)j(p);else{let E=Date.now();const y=[];for(let I=0;I<p.length;I++){const R=p.item(I);if(R){const F=new XMLHttpRequest;let q=++E;const ae=O=>{const D=URL.createObjectURL(R);_.current.push(D);const T={uid:q,name:R.name,url:D,thumbUrl:R.type.startsWith("image")?D:void 0,originFile:R,response:F.response,...O};if(L.isNumber(c)&&x.length+y.length>=c){if(c===1){q=T.uid=x[0].uid,g([T]),s==null||s([T],{type:"update",files:[T]});return}return!0}y.push(T)},Q=O=>{let D=!0;const T=g(P=>{const M=P.findIndex(Z=>Z.uid===q);M!==-1?P[M]=Object.assign(P[M],{response:F.response,...O}):D=!1});D&&(s==null||s(T,{type:"update",files:[T.find(P=>P.uid===q)]}))},Y=O=>{if(O===!1)ae({state:null});else{if(ae({state:"progress",percent:0}))return;F.upload.addEventListener("progress",C=>{if(C.lengthComputable){const X=Math.round(C.loaded*100/C.total);Q({state:"progress",percent:X})}}),F.addEventListener("error",()=>{Q({state:"error",percent:void 0})}),F.addEventListener("load",()=>{Q({state:F.status>=200&&F.status<300?"load":"error",percent:void 0})});const{url:T,method:P="POST",responseType:M="json",header:Z={},body:ce=C=>{const X=new FormData;return X.append("file",C),X},custom:ee}=u;F.open(P,T),F.responseType=M,Object.entries(Z).forEach(C=>{F.setRequestHeader(...C)}),ee==null||ee(F),F.send(ce(O===!0?R:O))}};let G=!0;f?(G=f(R,p),G instanceof Promise?G.then(O=>{Y(O)}):Y(G)):Y(!0)}}if(y.length>0){const I=g(R=>R.concat(y));s==null||s(I,{type:"add",files:y})}}},k=ve(p=>{i==null||i(p);const E=g(y=>{const I=y.findIndex(R=>R.uid===p.uid);y.splice(I,1)});s==null||s(E,{type:"remove",files:[p]})}),A=v.useMemo(()=>({files:x,onRemove:k}),[x,k]);return t.jsxs(t.Fragment,{children:[t.jsx(K,{value:A,children:d({onClick:()=>{a.current&&a.current.click()},...U?{onDragEnter:p=>{p.stopPropagation(),p.preventDefault()},onDragOver:p=>{p.stopPropagation(),p.preventDefault()},onDrop:p=>{p.stopPropagation(),p.preventDefault();const y=p.dataTransfer.files;S(y)}}:void 0})}),t.jsx("input",{...o,...H(n("upload"),{className:o.className,style:o.style}),ref:p=>{const E=xe(e,p);return a.current=p,()=>{E(),a.current=null}},type:o.type??"file",onChange:p=>{var y;(y=o.onChange)==null||y.call(o,p);const E=p.currentTarget.files;E&&S(E),p.currentTarget.value=""}})]})};$.Button=Le;$.Action=W;$.PreviewAction=oe;$.List=Te;$.Picture=Ne;$.PictureList=Ae;const He=h=>v.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",...h},v.createElement("path",{d:"M18 15v3H6v-3H4v3c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2v-3h-2zM7 9l1.41 1.41L11 7.83V16h2V7.83l2.59 2.58L17 9l-5-5-5 5z"}));export{He as S,$ as U};
