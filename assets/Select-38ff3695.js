import{r as c,u as ht,a as mt,b as bt,d as vt,v as xt,e as gt,c as fe,l as j,x as St,F as jt,G as se,H as yt,g as wt,R as Re,W as le,J as De,h as Et,i as It,k as _e,m as z,j as l,p as kt,I as G,K as Rt,L as Dt,q as Ce,P as Ct,n as Mt,M as he,A as Nt}from"./index-a0198d41.js";import{u as Lt}from"./useForkRef-070b1e4b.js";import{S as Pt}from"./cancel-d7fa6c65.js";import{S as Wt}from"./add-0cd046b6.js";import{S as zt}from"./keyboard_arrow_down-32513994.js";import{S as At}from"./search-d22ec4d1.js";import{i as Tt}from"./isPrintableCharacter-1b5c27a6.js";import{T as Me}from"./Tag-f32fa4ef.js";import{V as $t}from"./VirtualScroll-bb23d3d6.js";import{C as Ft}from"./Checkbox-221fb836.js";import{E as Ne}from"./Empty-9540f036.js";const Vt={select:"^select","select.is-expanded":"is-expanded","select.is-disabled":"is-disabled","select--small":"^select--small","select--medium":"^select--medium","select--large":"^select--large",select__container:"^select__container",select__content:"^select__content",select__search:"^select__search","select__placeholder-wrapper":"^select__placeholder-wrapper",select__placeholder:"^select__placeholder","select__multiple-count":"^select__multiple-count",select__close:"^select__close",select__clear:"^select__clear",select__icon:"^select__icon",select__arrow:"^select__arrow","select-popup":"^select-popup","select-popup__content":"^select-popup__content","select-popup__loading":"^select-popup__loading","select-popup__loading--empty":"^select-popup__loading--empty",select__list:"^select__list",select__option:"^select__option","select__option.is-selected":"is-selected","select__option.is-disabled":"is-disabled","select__option-prefix":"^select__option-prefix","select__option-content":"^select__option-content","select__option-group":"^select__option-group","select__option-group-label":"^select__option-group-label",select__empty:"^select__empty"},A=Symbol();function Ot(Le,Pe){const{styleOverrides:We,styleProvider:C,formControl:_,list:M,model:ze,defaultModel:Ae,visible:Te,defaultVisible:$e,placeholder:me,multiple:a=!1,searchable:y=!1,searchValue:Fe,defaultSearchValue:Ve,clearable:Oe=!1,loading:K=!1,size:Ue,disabled:He=!1,monospaced:Be=!0,virtual:T=!1,escClosable:Ge=!0,customItem:be,customSelected:N,customSearch:w,createItem:ne,inputRef:Ke,inputRender:ve,popupRender:xe,onModelChange:oe,onVisibleChange:qe,onSearch:Je,onClear:ie,onCreateItem:ce,onScrollBottom:Ye,afterVisibleChange:L,...u}=ht("Select",Le),P=mt(),i=bt(Vt,{select:C==null?void 0:C.select,"select-popup":C==null?void 0:C["select-popup"]},We),x=vt(),{t:q}=xt(),ge=c.useId(),Se=`${P}-select-list-${ge}`,$=e=>`${P}-select-item-${e}-${ge}`,{pageScrollRef:Ze,contentResizeRef:Qe}=gt(),E=c.useRef(null),h=c.useRef(null),I=c.useRef(null),J=c.useRef(null),Xe=Lt(J,Ke),F=c.useRef(null),V=c.useMemo(()=>{const e=new Map,t=s=>{for(const n of s)e.set(n.value,n),n.children&&t(n.children)};return t(M),e},[M]),[r,g]=fe($e??!1,Te,qe),[O,et]=fe(Ve??"",Fe,Je),k=c.useCallback(e=>!e.disabled&&!e.children,[]),[Y,Z]=fe(Ae??(a?[]:null),ze,e=>{oe&&(a?oe(e,e.map(t=>V.get(t))):oe(e,j.isNull(e)?null:V.get(e)))},void 0,_==null?void 0:_.control),v=c.useMemo(()=>a?new Set(Y):Y,[Y,a]),Q=e=>{a?Z(t=>{const s=t.findIndex(n=>n===e);s!==-1?t.splice(s,1):t.push(e)}):(Z(e),g(!1))},{size:re,disabled:W}=St({size:Ue,disabled:He||(_==null?void 0:_.control.disabled)}),U=O.length>0,ae=a?v.size>0:!j.isNull(v),de=(()=>{if(!U)return[];const e=j.isUndefined(w==null?void 0:w.filter)?o=>o.label.includes(O):o=>w.filter(O,o),t=w==null?void 0:w.sort;let s=ne==null?void 0:ne(O);s&&(s={...s,[A]:!0});let n=[];return M.forEach(o=>{if(!o.children)s&&o.value===s.value&&(s=void 0),e(o)&&n.push(o);else{const d=[];o.children.forEach(m=>{s&&m.value===s.value&&(s=void 0),e(m)&&d.push(m)}),n=n.concat(d)}}),t&&n.sort(t),s&&n.unshift(s),n})(),H=U?de:M,[tt,st]=jt(e=>e.startsWith("Arrow")||["Home","End","Enter","Space"].includes(e)),[je,lt]=c.useState(),nt=(()=>{let e;return je&&(e=V.get(je.value),e&&k(e))||(ae&&(e=se(M,t=>k(t)&&a?v.has(t.value):v===t.value)),j.isUndefined(e)&&(e=se(M,t=>k(t)))),e})(),[ue,ot]=c.useState(),it=(()=>{if(ue&&se(de,e=>k(e)&&e.value===ue.value))return ue;if(U)return se(de,e=>k(e))})(),p=U?it:nt,ye=e=>{U?ot(e):lt(e)},we=e=>{if(!j.isUndefined(e)){const t=Object.assign({},e);delete t[A],ce==null||ce(t)}},ct=yt(r),rt=`calc(var(--${P}-zindex-fixed) + ${ct})`,X=c.useRef(),S=wt(()=>{if(r&&E.current&&h.current)if(Be){const e=Math.min(E.current.offsetWidth,Re.windowSize.width-le*2),t=h.current.offsetHeight,s=De(E.current,{width:e,height:t},{placement:"bottom",inWindow:le});X.current=s.transformOrigin,x.classes.position&&h.current.classList.toggle(x.classes.position,!1),x.replaceRule("position",{top:s.top,left:s.left,width:e}),h.current.classList.toggle(x.classes.position,!0)}else{const e=E.current.offsetWidth,t=h.current.offsetHeight,s=Re.windowSize.width-le*2,n=Math.min(Math.max(h.current.scrollWidth,e),s),o=De(E.current,{width:n,height:t},{placement:"bottom-left",inWindow:le});X.current=o.transformOrigin,x.classes.position&&h.current.classList.toggle(x.classes.position,!1),x.replaceRule("position",{top:o.top,left:o.left,minWidth:Math.min(e,s),maxWidth:s}),h.current.classList.toggle(x.classes.position,!0)}}),at=Et(S,!r);It(Ze,"scroll",S,{passive:!0},!r||at),_e(E,S,void 0,!r),_e(h,S,void 0,!r),_e(Qe,S,void 0,!r),c.useImperativeHandle(Pe,()=>({updatePosition:S}),[S]);const ee=e=>{document.activeElement===J.current&&e.target!==J.current&&e.button===0&&e.preventDefault()},R=c.useRef(),te=y&&r,Ee=Oe&&ae&&!r&&!K&&!W,Ie=st(c.createElement(y?"input":"div",Object.assign({...z(i("select__search"),{style:{opacity:te?void 0:0,zIndex:te?void 0:-1}}),..._==null?void 0:_.inputAria,ref:Xe,tabIndex:W?-1:0,role:"combobox","aria-haspopup":"listbox","aria-expanded":r,"aria-controls":Se,onBlur:()=>{g(!1)},onKeyDown:e=>{if(e.code==="Escape")r&&Ge&&(e.stopPropagation(),e.preventDefault(),g(!1));else{const t=s=>{var n,o,d,m;if(I.current){let f;switch(s){case"next":f=(n=F.current)==null?void 0:n.scrollToStep(I.current,1);break;case"prev":f=(o=F.current)==null?void 0:o.scrollToStep(I.current,-1);break;case"first":f=(d=F.current)==null?void 0:d.scrollToStart(I.current);break;case"last":f=(m=F.current)==null?void 0:m.scrollToEnd(I.current);break}f&&(ye(f),T===!1&&(R.current=()=>{const D=document.getElementById($(f.value));D&&Nt(D,I.current)},r&&(R.current(),R.current=void 0)))}};if(r)switch(e.code){case"ArrowUp":{e.preventDefault(),t("prev");break}case"ArrowDown":{e.preventDefault(),t("next");break}case"Home":{e.preventDefault(),t("first");break}case"End":{e.preventDefault(),t("last");break}default:{(e.code==="Enter"||e.code==="Space"&&!y)&&(e.preventDefault(),p&&(p[A]&&we(p),Q(p.value)));break}}else if(!(y&&["Home","End","Enter","Space"].includes(e.code)))switch(e.code){case"End":case"ArrowUp":{e.preventDefault(),g(!0),t("last");break}case"Home":case"ArrowDown":{e.preventDefault(),g(!0),t("first");break}case"Enter":case"Space":{e.preventDefault(),g(!0);break}default:{Tt(e.key)&&g(!0);break}}}},onChange:e=>{y&&et(e.currentTarget.value)}},y?{type:"text",value:O,autoComplete:"off",disabled:W}:{}))),[dt,ut,pt]=(()=>{let e=null,t=null,s;if(a){const n=[];for(const o of Y){const d=V.get(o);d&&n.push(d)}t=l.jsx(kt,{list:n.map(o=>{const{label:d,value:m,disabled:f}=o,D=N?N(o):d;return{id:m,title:D,type:"item",disabled:f}}),onClick:o=>(Q(o),!1),children:l.jsx(Me,{tabIndex:-1,size:re,children:v.size})}),e=n.map(o=>l.jsxs(Me,{size:re,children:[N?N(o):o.label,!(o.disabled||W)&&l.jsx("div",{...i("select__close"),role:"button","aria-label":q("Close"),onClick:d=>{d.stopPropagation(),Q(o.value)},children:l.jsx(G,{children:l.jsx(Rt,{})})})]},o.value))}else if(!j.isNull(v)){const n=V.get(v);n&&(s=n.label,e=N?N(n):s)}return[e,t,s]})(),ft=Dt({compose:{disabled:W},form:_}),_t=c.useMemo(()=>({list:H,itemKey:e=>e.value,itemSize:j.isNumber(T)?T:32,itemEmptySize:32,itemNested:e=>e.children,itemFocusable:k}),[k,H,T]);return l.jsxs(l.Fragment,{children:[l.jsxs("div",{...u,...z(i("select",`select--${re}`,{"select.is-expanded":r,"select.is-disabled":W}),{className:u.className,style:u.style}),...ft,ref:E,onMouseDown:e=>{var t;(t=u.onMouseDown)==null||t.call(u,e),ee(e)},onMouseUp:e=>{var t;(t=u.onMouseUp)==null||t.call(u,e),ee(e)},onClick:e=>{var t,s;(t=u.onClick)==null||t.call(u,e),(s=J.current)==null||s.focus({preventScroll:!0}),g(n=>y?!0:!n)},children:[l.jsxs("div",{...i("select__container"),title:pt,children:[ve?ve(Ie):Ie,!te&&(ae?l.jsx("div",{...i("select__content"),children:dt}):me?l.jsx("div",{...i("select__placeholder-wrapper"),children:l.jsx("div",{...i("select__placeholder"),children:me})}):null)]}),a&&l.jsx("div",{...i("select__multiple-count"),onClick:e=>{e.stopPropagation()},children:ut}),Ee&&l.jsx("div",{...i("select__clear"),role:"button","aria-label":q("Clear"),onClick:e=>{e.stopPropagation(),Z(a?[]:null),ie==null||ie()},children:l.jsx(G,{children:l.jsx(Pt,{})})}),l.jsx("div",{...z(i("select__icon"),{style:{visibility:Ee?"hidden":void 0}}),children:l.jsx(G,{children:K?l.jsx(Ce,{}):te?l.jsx(At,{}):l.jsx(zt,{...i("select__arrow")})})})]}),l.jsx(Ct,{selector:()=>{let e=document.getElementById(`${P}-select-root`);return e||(e=document.createElement("div"),e.id=`${P}-select-root`,document.body.appendChild(e)),e},children:l.jsx(Mt,{enter:r,during:he,afterRender:()=>{var e;S(),(e=R.current)==null||e.call(R),R.current=void 0},afterEnter:()=>{L==null||L(!0)},afterLeave:()=>{L==null||L(!1)},children:e=>{let t={};switch(e){case"enter":t={transform:"scaleY(0.7)",opacity:0};break;case"entering":t={transition:["transform","opacity"].map(s=>`${s} ${he}ms ease-out`).join(", "),transformOrigin:X.current};break;case"leaving":t={transform:"scaleY(0.7)",opacity:0,transition:["transform","opacity"].map(s=>`${s} ${he}ms ease-in`).join(", "),transformOrigin:X.current};break;case"leaved":t={display:"none"};break}return l.jsx("div",{...z(i("select-popup"),{style:{zIndex:rt,...t}}),ref:h,onMouseDown:s=>{ee(s)},onMouseUp:s=>{ee(s)},children:(()=>{const s=l.jsxs("div",{...i("select-popup__content"),children:[K&&l.jsx("div",{...i("select-popup__loading",{"select-popup__loading--empty":H.length===0}),children:l.jsx(G,{children:l.jsx(Ce,{})})}),K&&H.length===0?null:l.jsx($t,{..._t,ref:F,enable:T!==!1,listSize:264,listPadding:4,itemRender:(n,o,d,m,f)=>{const{label:D,value:b,disabled:pe}=n,ke=be?be(n):D;if(f)return c.createElement("ul",{...i("select__option-group"),key:b,role:"group","aria-labelledby":$(b)},c.createElement("li",{...i("select__option-group-label"),key:b,id:$(b),role:"presentation"},l.jsx("div",{...i("select__option-content"),children:ke})),f);let B=!1;return a?B=v.has(b):B=v===b,c.createElement("li",{...z(i("select__option",{"select__option.is-selected":!a&&B,"select__option.is-disabled":pe}),{style:{paddingLeft:m.length===0?void 0:20}}),...d,key:b,id:$(b),title:(n[A]?q("Create")+" ":"")+D,role:"option","aria-selected":B,"aria-disabled":pe,onClick:()=>{n[A]&&we(n),ye(n),Q(b)}},tt&&(p==null?void 0:p.value)===b&&l.jsx("div",{className:`${P}-focus-outline`}),n[A]?l.jsx("div",{...i("select__option-prefix"),children:l.jsx(G,{theme:"primary",children:l.jsx(Wt,{})})}):a?l.jsx("div",{...i("select__option-prefix"),children:l.jsx(Ft,{model:B,disabled:pe})}):null,l.jsx("div",{...i("select__option-content"),children:ke}))},itemFocused:p==null?void 0:p.value,itemEmptyRender:()=>l.jsx("li",{...z(i("select__empty"),{style:{paddingLeft:20}}),children:l.jsx("div",{...i("select__option-content"),children:q("No Data")})}),itemInAriaSetsize:n=>!n.children,placeholder:"li",onScrollEnd:Ye,children:(n,o)=>l.jsx("ul",{...i("select__list"),ref:I,id:Se,tabIndex:-1,role:"listbox","aria-multiselectable":a,"aria-activedescendant":j.isUndefined(p)?void 0:$(p.value),onScroll:o,children:H.length===0?l.jsx(Ne,{style:{padding:"12px 0"},image:Ne.SIMPLE_IMG}):n})})]});return xe?xe(s):s})()})}})})]})}const es=c.forwardRef(Ot);export{es as S};
