import{r as l,u as H,b as M,e as q,f as U,g as G,s as J,i as K,j as s,m as Q,l as m}from"./index-20025430.js";import{g as R,u as V}from"./getOffsetToRoot-fca9d1cb.js";import{s as W}from"./scrollTo-5038c498.js";import{t as C}from"./toPx-279036ad.js";const X={anchor:"^anchor",anchor__link:"^anchor__link","anchor__link.is-active":"is-active","anchor__indicator-track":"^anchor__indicator-track","anchor__indicator-wrapper":"^anchor__indicator-wrapper","anchor__dot-indicator":"^anchor__dot-indicator","anchor__line-indicator":"^anchor__line-indicator"},E=Symbol(),S=Symbol();function Y(N,O){const{styleOverrides:D,styleProvider:T,list:I,page:L,distance:d=0,scrollBehavior:w="instant",indicator:x=E,onClick:y,...k}=H("Anchor",N),u=M(X,{anchor:T==null?void 0:T.anchor},D),{pageScrollRef:$,contentResizeRef:b}=q(),r=U(L??(()=>$.current)),_=l.useRef(null),g=l.useRef(null),A=l.useRef({}),[v,B]=l.useState(null),f=G(()=>{if(r.current&&_.current&&g.current){const a=R(r.current);let e;const n=c=>{c.forEach(({href:t,children:h})=>{const i=document.getElementById(t);if(i&&r.current){const p=R(i),F=m.isString(d)?C(d,!0):d;Math.ceil(r.current.scrollTop)+F>=p-a&&(m.isUndefined(e)?e=[t,p]:p>e[1]&&(e=[t,p]))}m.isArray(h)&&n(h)})};n(I);const o=e?e[0]:null;if(B(o),o){const c=_.current.querySelector(`[data-l-href="${o}"]`).getBoundingClientRect(),t=c.top-_.current.getBoundingClientRect().top+c.height/2;g.current.style.cssText=`opacity:1;top:${t}px;`}else g.current.style.cssText+="opacity:0;"}});V(()=>{f()}),J(r,"scroll",f,{passive:!0}),K(b,f),l.useImperativeHandle(O,()=>({active:v,updateAnchor:f}),[v,f]);const P=a=>{var e,n;if(r.current){const o=R(r.current),c=r.current.scrollTop;window.location.hash=`#${a}`,r.current.scrollTop=c;const t=document.getElementById(a);if(t){const h=R(t),i=m.isString(d)?C(d,!0):d;(n=(e=A.current).clearTid)==null||n.call(e),A.current.clearTid=W(r.current,{top:h-o-i,behavior:w})}}},z=(()=>{const a=(e,n=0)=>e.map(o=>{const{title:c,href:t,target:h,children:i}=o;return s.jsxs(l.Fragment,{children:[s.jsx("li",{...u("anchor__link",{"anchor__link.is-active":t===v}),"data-l-href":t,children:s.jsx("a",{style:{paddingLeft:16+n*16},href:`#${t}`,target:h,onClick:p=>{p.preventDefault(),P(t),y==null||y(t,o)},children:c??t})}),i&&a(i,n+1)]},`${t}-${n}`)});return a(I)})();return s.jsxs("ul",{...k,...Q(u("anchor"),{className:k.className,style:k.style}),ref:_,children:[s.jsx("div",{...u("anchor__indicator-track"),children:s.jsx("div",{...u("anchor__indicator-wrapper"),ref:g,children:x===E?s.jsx("div",{...u("anchor__dot-indicator")}):x===S?s.jsx("div",{...u("anchor__line-indicator")}):x})}),z]})}const j=l.forwardRef(Y);j.DOT_INDICATOR=E;j.LINE_INDICATOR=S;export{j as A};
