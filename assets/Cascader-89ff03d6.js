import{r as p,f as De,l as V,j as c,V as Ue,I as se,q as Ie,E as sa,u as ta,a as na,b as la,w as ia,d as oa,c as ye,z as da,F as ua,G as Ee,H as pa,J as fa,h as _a,i as we,p as ha,K as ba,M as ma,m as he,P as xa,k as va,N as ga,R as Sa,W as Ve}from"./index-859e11c4.js";import{s as ka}from"./setRef-326cedcf.js";import{S as ja}from"./cancel-3d2e549a.js";import{S as ya}from"./keyboard_arrow_down-2c4a0af6.js";import{S as Ea}from"./search-3fed47eb.js";import{s as Pe}from"./scrollIntoViewIfNeeded-1a86a4ce.js";import{C as $e}from"./Checkbox-277cac9f.js";import{E as be}from"./Empty-9a8640a6.js";import{g as Ce}from"./utils-c2ed83c6.js";import{T as N,M as wa,S as Ia}from"./single-node-19c90d0d.js";import{T as Fe}from"./Tag-cf41eab9.js";import{i as Ca}from"./isPrintableCharacter-1b5c27a6.js";import{B as Da}from"./BaseInput-21077995.js";function Be(J){const{ref:ee,namespace:ae,styled:f,id:S,list:C,customItem:B,itemId:O,itemSelected:y,itemFocused:h,multiple:L,virtual:d,focusVisible:T,onFocus:Y,onClick:k,_root:E=!0}=J,x=p.useRef(null),g=p.useRef(null),o=p.useRef(null),z=h&&C.findIndex(a=>a.id===h.id)!==-1,i=(()=>{if(h)for(const a of C){if(h.id===a.id)return a;let _=h;for(;_.parent;)if(_=_.parent,_.id===a.id)return a}})(),b=De(a=>{var _,u,F,w,te,ne,Z;if(x.current){let m;if(E&&V.isUndefined(h))switch(a){case"first":case"next":m=(_=g.current)==null?void 0:_.scrollToStart(x.current);break;case"last":case"prev":m=(u=g.current)==null?void 0:u.scrollToEnd(x.current);break}else if(z)switch(a){case"next":m=(F=g.current)==null?void 0:F.scrollToStep(x.current,1);break;case"prev":m=(w=g.current)==null?void 0:w.scrollToStep(x.current,-1);break;case"first":m=(te=g.current)==null?void 0:te.scrollToStart(x.current);break;case"last":m=(ne=g.current)==null?void 0:ne.scrollToEnd(x.current);break;case"prev-level":i&&i.parent&&(m=i.parent);break;case"next-level":if(i&&i.children){for(const W of i.children)if(W.enabled){m=W;break}}break;default:a instanceof HTMLElement&&x.current&&Pe(a,x.current);break}else m=(Z=o.current)==null?void 0:Z.call(o,a);return m}});p.useImperativeHandle(ee,()=>b,[b]);const M=p.useMemo(()=>({list:C,itemKey:a=>a.id,itemSize:V.isNumber(d)?d:32,itemFocusable:a=>a.enabled}),[C,d]);return c.jsxs(c.Fragment,{children:[c.jsx(Ue,{...M,ref:a=>(g.current=a,()=>{g.current=null}),enable:d!==!1,listSize:200+32*2,listPadding:4,itemRender:(a,_,u)=>{let F=!1;if(a.children&&y){let w=y;for(;w.parent;)if(w=w.parent,w.id===a.id){F=!0;break}}return p.createElement("li",{...f("cascader__option",{"cascader__option.is-focused":a.id===(i==null?void 0:i.id),"cascader__option.is-selected":!L&&a.checked,"cascader__option.is-disabled":a.disabled}),...u,key:a.id,id:O(a.id),title:a.origin.label,role:"option","aria-selected":a.checked,"aria-disabled":a.disabled,onClick:()=>{Y(a),L&&!a.isLeaf||k(a)}},T&&(h==null?void 0:h.id)===a.id&&c.jsx("div",{className:`${ae}-focus-outline`}),F&&c.jsx("div",{...f("cascader__option-dot")}),L&&c.jsx("div",{...f("cascader__option-prefix"),children:c.jsx($e,{model:a.checked,disabled:a.disabled,indeterminate:a.indeterminate,onClick:w=>{w.stopPropagation(),Y(a),k(a)}})}),c.jsx("div",{...f("cascader__option-content"),children:B?B(a.origin):a.origin.label}),!a.isLeaf&&c.jsx("div",{...f("cascader__option-icon"),children:c.jsx(se,{children:a.origin.loading?c.jsx(Ie,{}):c.jsx(sa,{})})}))},itemFocused:i==null?void 0:i.id,placeholder:"li",children:(a,_)=>c.jsx("ul",{...f("cascader__list","cascader__list--inline"),ref:u=>(x.current=u,()=>{x.current=null}),id:S,tabIndex:-1,role:"listbox","aria-multiselectable":L,"aria-activedescendant":E&&!V.isUndefined(h)?O(h.id):void 0,onScroll:_,children:C.length===0?c.jsx(be,{style:{padding:"12px 28px"},image:be.SIMPLE_IMG}):a})}),i&&!i.origin.loading&&i.children&&c.jsx(Be,{...J,_root:!1,ref:a=>(o.current=a,()=>{o.current=null}),id:void 0,list:i.children})]})}function Ra(J){const{ref:ee,namespace:ae,styled:f,id:S,list:C,customItem:B,itemId:O,itemFocused:y,multiple:h,onlyLeafSelectable:L,virtual:d,focusVisible:T,onClick:Y}=J,k=p.useRef(null),E=p.useRef(null),x=De(o=>{var z,i,b,M;if(k.current){let a;switch(o){case"next":a=(z=E.current)==null?void 0:z.scrollToStep(k.current,1);break;case"prev":a=(i=E.current)==null?void 0:i.scrollToStep(k.current,-1);break;case"first":a=(b=E.current)==null?void 0:b.scrollToStart(k.current);break;case"last":a=(M=E.current)==null?void 0:M.scrollToEnd(k.current);break;default:o instanceof HTMLElement&&k.current&&Pe(o,k.current);break}return a}});p.useImperativeHandle(ee,()=>x,[x]);const g=p.useMemo(()=>({list:C,itemKey:o=>o.value,itemSize:V.isNumber(d)?d:32,itemFocusable:o=>o[N].enabled}),[C,d]);return c.jsx(Ue,{...g,ref:o=>(E.current=o,()=>{E.current=null}),enable:d!==!1,listSize:200+32*2,listPadding:4,itemRender:(o,z,i)=>{const b=o[N];let M=b.checked;if(!L){let a=b;for(;a.parent;)if(a=a.parent,a.id===o.value){M=!0;break}}return p.createElement("li",{...f("cascader__option",{"cascader__option.is-selected":!h&&M,"cascader__option.is-disabled":b.disabled}),...i,key:o.value,id:O(o.value),title:o.label,role:"option","aria-selected":b.checked,"aria-disabled":b.disabled,onClick:()=>{Y(o)}},T&&(y==null?void 0:y.value)===o.value&&c.jsx("div",{className:`${ae}-focus-outline`}),h&&c.jsx("div",{...f("cascader__option-prefix"),children:c.jsx($e,{model:b.checked,disabled:b.disabled})}),c.jsx("div",{...f("cascader__option-content"),children:B?B(b.origin):Ce(b)}))},itemFocused:y==null?void 0:y.value,placeholder:"li",children:(o,z)=>c.jsx("ul",{...f("cascader__list"),ref:i=>(k.current=i,()=>{k.current=null}),id:S,tabIndex:-1,role:"listbox","aria-multiselectable":h,"aria-activedescendant":V.isUndefined(y)?void 0:O(y.value),onScroll:z,children:C.length===0?c.jsx(be,{style:{padding:"12px 28px"},image:be.SIMPLE_IMG}):o})})}const Na={cascader:"^cascader","cascader.is-expanded":"is-expanded","cascader.is-disabled":"is-disabled","cascader--small":"^cascader--small","cascader--medium":"^cascader--medium","cascader--large":"^cascader--large",cascader__container:"^cascader__container",cascader__content:"^cascader__content",cascader__search:"^cascader__search","cascader__placeholder-wrapper":"^cascader__placeholder-wrapper",cascader__placeholder:"^cascader__placeholder","cascader__multiple-count":"^cascader__multiple-count",cascader__close:"^cascader__close",cascader__clear:"^cascader__clear",cascader__icon:"^cascader__icon",cascader__arrow:"^cascader__arrow","cascader-popup":"^cascader-popup","cascader-popup__content":"^cascader-popup__content","cascader-popup__loading":"^cascader-popup__loading","cascader-popup__loading--empty":"^cascader-popup__loading--empty",cascader__list:"^cascader__list","cascader__list--inline":"^cascader__list--inline",cascader__option:"^cascader__option","cascader__option.is-focused":"is-focused","cascader__option.is-selected":"is-selected","cascader__option.is-disabled":"is-disabled","cascader__option-dot":"^cascader__option-dot","cascader__option-prefix":"^cascader__option-prefix","cascader__option-content":"^cascader__option-content","cascader__option-icon":"^cascader__option-icon",cascader__empty:"^cascader__empty"};function Ba(J){const{ref:ee,styleOverrides:ae,styleProvider:f,formControl:S,list:C,model:B,defaultModel:O,visible:y,defaultVisible:h,placeholder:L,multiple:d=!1,searchable:T=!1,searchValue:Y,defaultSearchValue:k,onlyLeafSelectable:E=!0,clearable:x=!1,loading:g=!1,size:o,disabled:z=!1,virtual:i=!1,escClosable:b=!0,customItem:M,customSelected:a,customSearch:_,inputProps:u,popupRender:F,onModelChange:w,onVisibleChange:te,onSearch:ne,onClear:Z,onFirstFocus:m,afterVisibleChange:W,...D}=ta("Cascader",J),U=na(),v=la(Na,{cascader:f==null?void 0:f.cascader,"cascader-popup":f==null?void 0:f["cascader-popup"]},ae),{t:Re}=ia(),Ne=p.useId(),me=`${U}-cascader-list-${Ne}`,xe=e=>`${U}-cascader-item-${e}-${Ne}`,{contentResizeRef:Oe}=oa(),Q=p.useRef(null),A=p.useRef(null),re=p.useRef(null),G=p.useRef(null),le=p.useRef(new Set),[ie,q]=p.useMemo(()=>{const e=C.map(s=>d?new wa(s,n=>n.value,{disabled:s.disabled}):new Ia(s,n=>n.value,{disabled:s.disabled})),r=new Map,t=s=>{for(const n of s)r.set(n.id,n),n.children&&t(n.children)};return t(e),[e,r]},[C,d]),[j,H]=ye(h??!1,y,te),[oe,Ge]=ye(k??"",Y,ne),[de,P]=ye(O??(d?[]:null),B,e=>{w&&(d?w(e,e.map(r=>q.get(r).origin)):w(e,V.isNull(e)?null:q.get(e).origin))},void 0,S==null?void 0:S.control),R=p.useMemo(()=>d?new Set(de):de,[de,d]),Te=e=>{if(d){const r=e.changeStatus(e.checked?"UNCHECKED":"CHECKED",R);P(Array.from(r.keys()))}else(e.isLeaf||!E)&&P(e.id),e.isLeaf&&H(!1)},Me=e=>{if(d){const r=e[N].changeStatus(e[N].checked?"UNCHECKED":"CHECKED",R);P(Array.from(r.keys()))}else P(e[N].id),H(!1)};q.forEach(e=>{e.updateStatus(R)});const{size:ve,disabled:X}=da({size:o,disabled:z||(S==null?void 0:S.control.disabled)}),K=oe.length>0,ue=d?R.size>0:!V.isNull(R),pe=(()=>{if(!K)return[];const e=V.isUndefined(_==null?void 0:_.filter)?n=>n.label.includes(oe):n=>_.filter(oe,n),r=_==null?void 0:_.sort,t=[],s=n=>{n.forEach(l=>{(!d&&!E||l.isLeaf)&&e(l.origin)&&t.push({label:Ce(l),value:l.id,disabled:l.disabled,[N]:l}),l.children&&s(l.children)})};return s(ie),r&&t.sort((n,l)=>r(n[N].origin,l[N].origin)),t})(),Ae=K?pe.length===0:ie.length===0,[Le,ge]=ua(e=>e.startsWith("Arrow")||["Home","End","Enter","Space"].includes(e)),[ze,qe]=p.useState(),We=e=>{le.current.has(e.id)||(le.current.add(e.id),m==null||m(e.id,e.origin)),qe(e)},Se=(()=>{if(ze){const e=q.get(ze.id);if(e&&e.enabled)return e}if(ue)return Ee(ie,e=>e.enabled&&e.checked)})(),[ke,Je]=p.useState(),He=e=>{le.current.has(e.value)||(le.current.add(e.value),m==null||m(e.value,e[N].origin)),Je(e)},je=(()=>{if(ke&&Ee(pe,e=>e[N].enabled&&e.value===ke.value))return ke;if(K)return Ee(pe,e=>e[N].enabled)})(),Ye=pa(j),Ze=`calc(var(--${U}-zindex-fixed) + ${Ye})`,$=De(()=>{if(j&&Q.current&&A.current){const e=A.current.offsetHeight,r=Sa.windowSize.width-Ve*2,t=Math.min(A.current.scrollWidth,r),s=fa(Q.current,{width:t,height:e},{placement:"bottom-left",inWindow:Ve});A.current.style.setProperty("--popup-down-transform-origin",s.transformOrigin),A.current.style.top=s.top+"px",A.current.style.left=s.left+"px",A.current.style.maxWidth=r+"px"}});_a(Q,$,!j),we(Q,$,void 0,!j),we(A,$,void 0,!j),we(Oe,$,void 0,!j),p.useImperativeHandle(ee,()=>({updatePosition:$}),[$]);const fe=e=>{document.activeElement===re.current&&e.target!==re.current&&e.button===0&&e.preventDefault()},ce=p.useRef(()=>{}),_e=T&&j,Ke=x&&ue&&!j&&!g&&!X,[Qe,Xe,ea]=(()=>{let e=null,r=null,t;if(d){const s=de.map(n=>{const l=q.get(n);return{value:n,label:a?a(n,l==null?void 0:l.origin):l?l.origin.label:String(n),node:l}});r=c.jsx(ha,{list:s.map(({value:n,label:l,node:I})=>({id:n,title:l,type:"item",disabled:I==null?void 0:I.origin.disabled})),virtual:i,onClick:n=>(P(l=>{l.splice(l.findIndex(I=>I===n),1)}),!1),children:n=>c.jsx(Fe,{...n,tabIndex:-1,size:ve,children:R.size})}),e=s.map(({value:n,label:l,node:I})=>c.jsxs(Fe,{size:ve,children:[l,!(I!=null&&I.disabled||X)&&c.jsx("div",{...v("cascader__close"),role:"button","aria-label":Re("Close"),onClick:ra=>{ra.stopPropagation();const ca=I.changeStatus("UNCHECKED",R);P(Array.from(ca.keys()))},children:c.jsx(se,{children:c.jsx(ba,{})})})]},n))}else if(!V.isNull(R)){const s=q.get(R);e=t=a?a(R,s==null?void 0:s.origin):s?Ce(s):String(R)}return[e,r,t]})(),aa=ma({compose:{disabled:X},form:S});return c.jsxs(c.Fragment,{children:[c.jsxs("div",{...D,...he(v("cascader",`cascader--${ve}`,{"cascader.is-expanded":j,"cascader.is-disabled":X}),{className:D.className,style:D.style}),...aa,ref:e=>(Q.current=e,()=>{Q.current=null}),onMouseDown:e=>{var r;(r=D.onMouseDown)==null||r.call(D,e),fe(e)},onMouseUp:e=>{var r;(r=D.onMouseUp)==null||r.call(D,e),fe(e)},onClick:e=>{var r,t;(r=D.onClick)==null||r.call(D,e),(t=re.current)==null||t.focus({preventScroll:!0}),H(s=>T?!0:!s)},children:[c.jsxs("div",{...v("cascader__container"),title:ea,children:[(()=>{const e=Object.assign({...u,...he(v("cascader__search"),{style:{opacity:_e?void 0:0,zIndex:_e?void 0:-1}}),...S==null?void 0:S.inputAria,ref:r=>{re.current=r;const t=ka(u==null?void 0:u.ref,r);return()=>{re.current=null,t()}},tabIndex:X?-1:0,role:"combobox","aria-haspopup":"listbox","aria-expanded":j,"aria-controls":me,onFocus:r=>{var t;(t=u==null?void 0:u.onFocus)==null||t.call(u,r),ge.onFocus(r)},onBlur:r=>{var t;(t=u==null?void 0:u.onBlur)==null||t.call(u,r),ge.onBlur(r),H(!1)},onKeyDown:r=>{var t;if((t=u==null?void 0:u.onKeyDown)==null||t.call(u,r),ge.onKeyDown(r),r.code==="Escape")j&&b&&(r.stopPropagation(),r.preventDefault(),H(!1));else{const s=n=>{if(G.current){const l=G.current(n);l&&(K?He(l):We(l),i===!1&&!n.includes("level")&&(ce.current=()=>{ce.current=()=>{};const I=document.getElementById(xe(K?l.value:l.id));I&&G.current(I)},j&&ce.current()))}};if(j)switch(r.code){case"ArrowUp":{r.preventDefault(),s("prev");break}case"ArrowDown":{r.preventDefault(),s("next");break}case"ArrowLeft":{K||(r.preventDefault(),s("prev-level"));break}case"ArrowRight":{K||(r.preventDefault(),s("next-level"));break}case"Home":{r.preventDefault(),s("first");break}case"End":{r.preventDefault(),s("last");break}default:{(r.code==="Enter"||r.code==="Space"&&!T)&&(r.preventDefault(),K?je&&Me(je):Se&&Te(Se));break}}else if(!(T&&["Home","End","Enter","Space"].includes(r.code)))switch(r.code){case"End":case"ArrowUp":{r.preventDefault(),H(!0),s("last");break}case"Home":case"ArrowDown":{r.preventDefault(),H(!0),s("first");break}case"Enter":case"Space":{r.preventDefault(),H(!0);break}default:{Ca(r.key)&&H(!0);break}}}}},T?{type:"text",value:oe,autoComplete:"off",disabled:X,onValueChange:r=>{Ge(r)}}:{});return T?c.jsx(Da,{...e}):c.jsx("div",{...e})})(),!_e&&(ue?c.jsx("div",{...v("cascader__content"),children:Qe}):L?c.jsx("div",{...v("cascader__placeholder-wrapper"),children:c.jsx("div",{...v("cascader__placeholder"),children:L})}):null)]}),d&&c.jsx("div",{...v("cascader__multiple-count"),onClick:e=>{e.stopPropagation()},children:Xe}),Ke&&c.jsx("div",{...v("cascader__clear"),role:"button","aria-label":Re("Clear"),onClick:e=>{e.stopPropagation(),Z==null||Z(),P(d?[]:null)},children:c.jsx(se,{children:c.jsx(ja,{})})}),c.jsx("div",{...he(v("cascader__icon"),{style:{visibility:Ke?"hidden":void 0}}),children:c.jsx(se,{children:g?c.jsx(Ie,{}):_e?c.jsx(Ea,{}):c.jsx(ya,{...v("cascader__arrow")})})})]}),c.jsx(xa,{selector:()=>{let e=document.getElementById(`${U}-cascader-root`);return e||(e=document.createElement("div"),e.id=`${U}-cascader-root`,document.body.appendChild(e)),e},children:c.jsx(va,{enter:j,name:`${U}-popup-down`,duration:ga,onSkipEnter:()=>{$(),ce.current()},onBeforeEnter:()=>{$(),ce.current()},onAfterEnter:()=>{W==null||W(!0)},onAfterLeave:()=>{W==null||W(!1)},children:(e,r)=>c.jsx("div",{...he(v("cascader-popup"),{style:{zIndex:Ze,...r?{display:"none"}:void 0}}),ref:t=>(A.current=t,e(t),()=>{A.current=null,e(null)}),onMouseDown:t=>{fe(t)},onMouseUp:t=>{fe(t)},children:(()=>{const t=c.jsxs("div",{...v("cascader-popup__content"),children:[g&&c.jsx("div",{...v("cascader-popup__loading",{"cascader-popup__loading--empty":Ae}),children:c.jsx(se,{children:c.jsx(Ie,{})})}),g&&Ae?null:K?c.jsx(Ra,{ref:s=>(G.current=s,()=>{G.current=null}),namespace:U,styled:v,id:me,list:pe,customItem:M,itemId:xe,itemFocused:je,multiple:d,onlyLeafSelectable:E,virtual:i,focusVisible:Le,onClick:s=>{He(s),Me(s)}}):c.jsx(Be,{ref:s=>(G.current=s,()=>{G.current=null}),namespace:U,styled:v,id:me,list:ie,customItem:M,itemId:xe,itemSelected:!d&&ue?q.get(R):void 0,itemFocused:Se,multiple:d,virtual:i,focusVisible:Le,onFocus:We,onClick:Te})]});return F?F(t):t})()})})})]})}export{Ba as C};
