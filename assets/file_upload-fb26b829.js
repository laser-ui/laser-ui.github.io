import{r as i,u as F,b as O,N as G,l as L,j as e,m as R,I as k,q as Z,C as le,T as C,n as ce,c as me,ao as _e,f as he}from"./index-8c6faddd.js";import{u as ge}from"./useForkRef-859982a8.js";import{S as ve}from"./file_download-5a0fc004.js";import{S as xe}from"./add-e30f2d00.js";import{S as be}from"./visibility-68b1b372.js";import{u as ee}from"./MdRoute-ae2e646b.js";import{u as je}from"./Route-48d81e78.js";import{P as te}from"./Progress-b098cb45.js";function se(){const n=i.useRef(!1);return je(()=>{n.current=!0}),n}function fe(n,w){const l=document.createElement("a");document.body.appendChild(l),l.style.display="none",l.href=n,l.download=w,l.click(),document.body.removeChild(l)}const we=n=>i.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",...n},i.createElement("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM8 9h8v10H8V9zm7.5-5-1-1h-5l-1 1H5v2h14V4h-3.5z"})),Ue={upload:"^upload"},ye={"upload-button":"^upload-button","upload-button.is-disabled":"is-disabled","upload-button--load":"^upload-button--load","upload-button--error":"^upload-button--error","upload-button--progress":"^upload-button--progress","upload-button__thumbnail":"^upload-button__thumbnail","upload-button__name":"^upload-button__name","upload-button__actions":"^upload-button__actions","upload-button__icon":"^upload-button__icon","upload-button__text":"^upload-button__text"},de={"upload-action":"^upload-action","upload-action.is-disabled":"is-disabled","upload-action--light":"^upload-action--light","upload-action--preview":"^upload-action--preview"},Se={"upload-list":"^upload-list","upload-list__item":"^upload-list__item","upload-list__item--load":"^upload-list__item--load","upload-list__item--error":"^upload-list__item--error","upload-list__item--progress":"^upload-list__item--progress","upload-list__icon":"^upload-list__icon","upload-list__link":"^upload-list__link","upload-list__link.is-active":"is-active","upload-list__actions":"^upload-list__actions","upload-list__progress-wrapper":"^upload-list__progress-wrapper"},Re={"upload-picture":"^upload-picture","upload-picture__row":"^upload-picture__row","upload-picture__item":"^upload-picture__item","upload-picture__item.is-disabled":"is-disabled","upload-picture__item--load":"^upload-picture__item--load","upload-picture__item--error":"^upload-picture__item--error","upload-picture__item--progress":"^upload-picture__item--progress","upload-picture__thumbnail":"^upload-picture__thumbnail","upload-picture__name":"^upload-picture__name","upload-picture__actions":"^upload-picture__actions","upload-picture__progress-text":"^upload-picture__progress-text"},ke={"upload-picture-list":"^upload-picture-list","upload-picture-list__item":"^upload-picture-list__item","upload-picture-list__item--load":"^upload-picture-list__item--load","upload-picture-list__item--error":"^upload-picture-list__item--error","upload-picture-list__item--progress":"^upload-picture-list__item--progress","upload-picture-list__thumbnail":"^upload-picture-list__thumbnail","upload-picture-list__thumbnail-img":"^upload-picture-list__thumbnail-img","upload-picture-list__link":"^upload-picture-list__link","upload-picture-list__link.is-active":"is-active","upload-picture-list__actions":"^upload-picture-list__actions","upload-picture-list__progress-wrapper":"^upload-picture-list__progress-wrapper"},X=i.createContext({files:[],onRemove:()=>{}}),V=i.forwardRef((n,w)=>{const{styleOverrides:l,styleProvider:_,children:o,preset:u,disabled:a=!1,_file:c,_defaultActions:b,_light:j,_onRemove:h,...r}=F("UploadAction",n),t=O(de,{"upload-action":_==null?void 0:_["upload-action"]},l),{t:d}=G(),s=u==="download"?a||L.isUndefined(c.url):a;return e.jsx("div",{...r,...R(t("upload-action",{"upload-action.is-disabled":s,"upload-action--light":j}),{className:r.className,style:r.style}),ref:w,role:r.role??"button",tabIndex:r.tabIndex??(s?-1:0),title:r.title??u==="download"?d("Upload","Download file"):u==="remove"?d("Upload","Remove file"):void 0,onClick:v=>{var f;(f=r.onClick)==null||f.call(r,v),v.stopPropagation(),u==="download"?b!=null&&b.download?b.download(c):fe(c.url,c.name):u==="remove"&&(h==null||h())},children:o??(u==="download"?e.jsx(k,{children:e.jsx(ve,{})}):u==="remove"?e.jsx(k,{children:e.jsx(we,{})}):null)})}),oe=n=>i.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",...n},i.createElement("path",{d:"M13 4H6v16h12V9h-5z",opacity:.3}),i.createElement("path",{d:"m20 8-6-6H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8zm-2 12H6V4h7v5h5v11z"})),ie=i.forwardRef((n,w)=>{const{styleOverrides:l,styleProvider:_,children:o,disabled:u=!1,_file:a,_defaultActions:c,_light:b,_onRemove:j,...h}=F("UploadPreviewAction",n),r=O(de,{"upload-action":_==null?void 0:_["upload-action"]},l),{t}=G();return e.jsx("a",{...h,...R(r("upload-action","upload-action--preview",{"upload-action.is-disabled":u||L.isUndefined(a.url),"upload-action--light":b}),{className:h.className,style:h.style}),ref:w,href:a.url,target:h.target??"_blank",title:h.title??t("Upload","Preview file"),onClick:d=>{var s;(s=h.onClick)==null||s.call(h,d),d.stopPropagation(),c!=null&&c.preview&&(d.preventDefault(),c.preview(a))},children:o??e.jsx(k,{children:e.jsx(be,{})})})}),Ee=i.forwardRef((n,w)=>{const{styleOverrides:l,styleProvider:_,file:o,actions:u,defaultActions:a,onRemove:c,...b}=F("UploadButton",n),j=O(ye,{"upload-button":_==null?void 0:_["upload-button"]},l),{t:h}=G(),r=o&&o.state==="progress";return e.jsx("div",{...b,...R(j("upload-button",{"upload-button.is-disabled":r,[`upload-button--${o==null?void 0:o.state}`]:o}),{className:b.className,style:b.style}),ref:w,tabIndex:b.tabIndex??(r?-1:0),children:o&&o.state!=="progress"?e.jsxs(e.Fragment,{children:[o.thumbUrl?e.jsx("img",{...j("upload-button__thumbnail"),src:o.thumbUrl,alt:o.name}):e.jsxs(e.Fragment,{children:[e.jsx(k,{theme:o.state==="error"?"danger":"primary",children:e.jsx(oe,{})}),e.jsx("div",{...j("upload-button__name"),children:o.name})]}),e.jsx("div",{...j("upload-button__actions"),children:i.Children.map(u??[e.jsx(ie,{}),e.jsx(V,{preset:"remove"})],t=>i.cloneElement(t,{_file:o,_defaultActions:a,_light:!0,_onRemove:c}))})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{...j("upload-button__icon"),children:e.jsx(k,{children:r?e.jsx(Z,{}):e.jsx(xe,{})})}),e.jsx("div",{...j("upload-button__text"),children:h("Upload",r?"Uploading":"Upload")})]})})}),Ce=n=>i.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",...n},i.createElement("path",{d:"M16.5 6v11.5c0 2.21-1.79 4-4 4s-4-1.79-4-4V5a2.5 2.5 0 0 1 5 0v10.5c0 .55-.45 1-1 1s-1-.45-1-1V6H10v9.5a2.5 2.5 0 0 0 5 0V5c0-2.21-1.79-4-4-4S7 2.79 7 5v12.5c0 3.04 2.46 5.5 5.5 5.5s5.5-2.46 5.5-5.5V6h-1.5z"}));function Le(n){const{styleOverrides:w,styleProvider:l,actions:_,defaultActions:o,...u}=F("UploadList",n),a=O(Se,{"upload-list":l==null?void 0:l["upload-list"]},w),{files:c,onRemove:b}=i.useContext(X),j=se(),[h,r]=ee([]);return e.jsx("ul",{...u,...R(a("upload-list"),{className:u.className,style:u.style}),children:c.map((t,d)=>e.jsx(le,{originalSize:{height:"auto"},collapsedSize:{height:0},enter:!h.includes(t.uid),during:C,styles:{entering:{transition:["height","padding","margin"].map(s=>`${s} ${C}ms ease-out`).join(", ")},leaving:{transition:["height","padding","margin"].map(s=>`${s} ${C}ms ease-in`).join(", ")},leaved:{display:"none"}},skipFirstTransition:!j.current,afterLeave:()=>{r(s=>{s.splice(s.findIndex(v=>v===t.uid),1)}),b(t)},children:(s,v)=>e.jsxs("li",{...R(a("upload-list__item",{[`upload-list__item--${t.state}`]:t.state}),{style:v}),ref:s,children:[e.jsx("div",{...a("upload-list__icon"),children:t.state==="progress"?e.jsx(k,{children:e.jsx(Z,{})}):e.jsx(k,{rotate:45,children:e.jsx(Ce,{})})}),e.jsx("a",{...a("upload-list__link",{"upload-list__link.is-active":t.state==="load"&&!L.isUndefined(t.url)}),href:t.url,target:"_blank",rel:"noreferrer",title:t.name,onClick:f=>{o&&o.preview&&(f.preventDefault(),o.preview(t))},children:t.name}),e.jsx("div",{...a("upload-list__actions"),children:i.Children.map(_?_(t,d):[e.jsx(V,{preset:"remove"})],f=>i.cloneElement(f,{_file:t,_defaultActions:o,_onRemove:()=>{r(U=>{U.push(t.uid)})}}))}),e.jsx("div",{...a("upload-list__progress-wrapper"),children:L.isNumber(t.percent)&&e.jsx(te,{percent:t.percent,label:!1,lineWidth:2})})]})},t.uid))})}function Ie(n){const{children:w,styleOverrides:l,styleProvider:_,actions:o,defaultActions:u,...a}=F("UploadPicture",n),c=O(Re,{"upload-picture":_==null?void 0:_["upload-picture"]},l),{t:b}=G(),{files:j,onRemove:h}=i.useContext(X),r=se(),[t,d]=ee([]);return e.jsx("ul",{...a,...R(c("upload-picture"),{className:a.className,style:a.style}),children:e.jsxs("div",{...c("upload-picture__row"),children:[j.map((s,v)=>e.jsx(ce,{enter:!t.includes(s.uid),during:C,skipFirstTransition:!r.current,afterLeave:()=>{d(f=>{f.splice(f.findIndex(U=>U===s.uid),1)}),h(s)},children:f=>{let U={};switch(f){case"enter":U={transform:"scale(0)"};break;case"entering":U={transition:["transform"].map(I=>`${I} ${C}ms ease-out`).join(", "),transformOrigin:"top left"};break;case"leaving":U={transform:"scale(0)",transition:["transform"].map(I=>`${I} ${C}ms ease-in`).join(", "),transformOrigin:"top left"};break;case"leaved":U={display:"none"};break}return e.jsx("div",{children:e.jsx("li",{...R(c("upload-picture__item",{[`upload-picture__item--${s.state}`]:s.state,"upload-picture__item.is-disabled":s&&s.state==="progress"}),{style:U}),children:s.state!=="progress"?e.jsxs(e.Fragment,{children:[s.thumbUrl?e.jsx("img",{...c("upload-picture__thumbnail"),src:s.thumbUrl,alt:s.name}):e.jsxs(e.Fragment,{children:[e.jsx(k,{size:28,theme:s.state==="error"?"danger":"primary",children:e.jsx(oe,{})}),e.jsx("div",{...c("upload-picture__name"),children:s.name})]}),e.jsx("div",{...c("upload-picture__actions"),children:i.Children.map(o?o(s,v):[e.jsx(ie,{}),e.jsx(V,{preset:"remove"})],I=>i.cloneElement(I,{_file:s,_defaultActions:u,_light:!0,_onRemove:()=>{d(H=>{H.push(s.uid)})}}))})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{...c("upload-picture__progress-text"),children:b("Upload","Uploading")}),L.isNumber(s.percent)&&e.jsx(te,{style:{width:"100%"},percent:s.percent,label:!1,lineWidth:2})]})})})}},s.uid)),e.jsx("div",{children:w})]})})}function Te(n){const{styleOverrides:w,styleProvider:l,actions:_,defaultActions:o,...u}=F("UploadPictureList",n),a=O(ke,{"upload-picture-list":l==null?void 0:l["upload-picture-list"]},w),{files:c,onRemove:b}=i.useContext(X),j=se(),[h,r]=ee([]);return e.jsx("ul",{...u,...R(a("upload-picture-list"),{className:u.className,style:u.style}),children:c.map((t,d)=>e.jsx(le,{originalSize:{height:"auto"},collapsedSize:{height:0},enter:!h.includes(t.uid),during:C,styles:{entering:{transition:["height","padding","margin"].map(s=>`${s} ${C}ms ease-out`).join(", ")},leaving:{transition:["height","padding","margin"].map(s=>`${s} ${C}ms ease-in`).join(", ")},leaved:{display:"none"}},skipFirstTransition:!j.current,afterLeave:()=>{r(s=>{s.splice(s.findIndex(v=>v===t.uid),1)}),b(t)},children:(s,v)=>e.jsxs("li",{...R(a("upload-picture-list__item",{[`upload-picture-list__item--${t.state}`]:t.state}),{style:v}),ref:s,children:[e.jsx("div",{...a("upload-picture-list__thumbnail"),children:t.state==="progress"?e.jsx(k,{size:28,children:e.jsx(Z,{})}):t.thumbUrl?e.jsx("img",{...a("upload-picture-list__thumbnail-img"),src:t.thumbUrl,alt:t.name}):e.jsx(k,{size:28,theme:t.state==="error"?"danger":"primary",children:e.jsx(oe,{})})}),e.jsx("a",{...a("upload-picture-list__link",{"upload-picture-list__link.is-active":t.state==="load"&&!L.isUndefined(t.url)}),href:t.url,target:"_blank",rel:"noreferrer",title:t.name,onClick:f=>{o&&o.preview&&(f.preventDefault(),o.preview(t))},children:t.name}),e.jsx("div",{...a("upload-picture-list__actions"),children:i.Children.map(_?_(t,d):[e.jsx(V,{preset:"remove"})],f=>i.cloneElement(f,{_file:t,_defaultActions:o,_onRemove:()=>{r(U=>{U.push(t.uid)})}}))}),e.jsx("div",{...a("upload-picture-list__progress-wrapper"),children:L.isNumber(t.percent)&&e.jsx(te,{percent:t.percent,label:!1,lineWidth:2})})]})},t.uid))})}function De(n,w){const{children:l,styleOverrides:_,styleProvider:o,formControl:u,model:a,defaultModel:c,request:b,max:j,drag:h=!1,customUpload:r,beforeUpload:t,onModelChange:d,onRemove:s,...v}=F("Upload",n),f=O(Ue,{upload:o==null?void 0:o.upload,"upload-list":o==null?void 0:o["upload-list"]},_),U=i.useRef(null),I=ge(U,w),H=i.useRef({fileURLs:[]}),[B,q]=me(c??[],a,void 0,void 0,u==null?void 0:u.control);_e(()=>{H.current.fileURLs.forEach(x=>{URL.revokeObjectURL(x)})});const ae=x=>{if(r)r(x);else{const y=[];for(let p=0;p<x.length;p++){const g=x.item(p);if(g){const m=new XMLHttpRequest;let T=Date.now();const z=E=>{const D=URL.createObjectURL(g);H.current.fileURLs.push(D);const S={uid:T,name:g.name,url:D,thumbUrl:g.type.startsWith("image")?D:void 0,originFile:g,response:m.response,...E};if(L.isNumber(j)&&B.length+y.length>=j){if(j===1){T=S.uid=B[0].uid,q([S]),d==null||d([S],{type:"update",files:[S]});return}return!0}y.push(S)},J=E=>{let D=!0;const S=q(A=>{const $=A.findIndex(Q=>Q.uid===T);$!==-1?A[$]=Object.assign(A[$],{response:m.response,...E}):D=!1});D&&(d==null||d(S,{type:"update",files:[S.find(A=>A.uid===T)]}))},K=E=>{if(E===!1)z({state:null});else{if(z({state:"progress",percent:0}))return;m.upload.addEventListener("progress",N=>{if(N.lengthComputable){const W=Math.round(N.loaded*100/N.total);J({state:"progress",percent:W})}}),m.addEventListener("error",()=>{J({state:"error",percent:void 0})}),m.addEventListener("load",()=>{J({state:m.status>=200&&m.status<300?"load":"error",percent:void 0})});const{url:S,method:A="POST",responseType:$="json",header:Q={},body:ue=N=>{const W=new FormData;return W.append("file",N),W},custom:Y}=b;m.open(A,S),m.responseType=$,Object.entries(Q).forEach(N=>{m.setRequestHeader(...N)}),Y==null||Y(m),m.send(ue(E===!0?g:E))}};let M=!0;t?(M=t(g,x),M instanceof Promise?M.then(E=>{K(E)}):K(M)):K(!0)}}if(y.length>0){const p=q(g=>g.concat(y));d==null||d(p,{type:"add",files:y})}}},re=x=>{let y={};return h&&(y={onDragEnter:p=>{var g,m;(m=(g=x.props).onDragEnter)==null||m.call(g,p),p.stopPropagation(),p.preventDefault()},onDragOver:p=>{var g,m;(m=(g=x.props).onDragOver)==null||m.call(g,p),p.stopPropagation(),p.preventDefault()},onDrop:p=>{var T,z;(z=(T=x.props).onDrop)==null||z.call(T,p),p.stopPropagation(),p.preventDefault();const m=p.dataTransfer.files;ae(m)}}),i.cloneElement(x,{...y,onClick:p=>{var g,m;(m=(g=x.props).onClick)==null||m.call(g,p),U.current&&U.current.click()}})},ne=he(x=>{s==null||s(x);const y=q(p=>{const g=p.findIndex(m=>m.uid===x.uid);p.splice(g,1)});d==null||d(y,{type:"remove",files:[x]})}),pe=i.useMemo(()=>({files:B,onRemove:ne}),[B,ne]);return e.jsxs(e.Fragment,{children:[e.jsx(X.Provider,{value:pe,children:L.isFunction(l)?l(re):re(l)}),e.jsx("input",{...v,...R(f("upload"),{className:v.className,style:v.style}),ref:I,type:v.type??"file",onChange:x=>{var p;(p=v.onChange)==null||p.call(v,x);const y=x.currentTarget.files;y&&ae(y),x.currentTarget.value=""}})]})}const P=i.forwardRef(De);P.Button=Ee;P.Action=V;P.PreviewAction=ie;P.List=Le;P.Picture=Ie;P.PictureList=Te;const He=n=>i.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",...n},i.createElement("path",{d:"M18 15v3H6v-3H4v3c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2v-3h-2zM7 9l1.41 1.41L11 7.83V16h2V7.83l2.59 2.58L17 9l-5-5-5 5z"}));export{He as S,P as U};
