import{r as n,g as Ne,l as F,W as Oe,j as s,I as se,q as De,X as da,u as ua,a as pa,b as fa,d as _a,P as ha,e as ba,c as we,R as ma,Y as ga,Z as Ce,_ as va,$ as xa,a0 as Ve,a1 as Sa,h as ka,i as ja,k as Ie,m as be,p as ya,a2 as Ea,a3 as wa,a4 as Ca,n as Ia,a5 as Re}from"./index-23fad38b.js";import{u as Ra}from"./useForkRef-3434b782.js";import{S as Da}from"./cancel-87ccbeac.js";import{S as Na}from"./keyboard_arrow_down-259beba1.js";import{S as Ta}from"./search-a6df90aa.js";import{V as Be}from"./VirtualScroll-5f6fde2f.js";import{C as Ge}from"./Checkbox-ee22e399.js";import{E as ge}from"./Empty-dca90a8a.js";import{g as me}from"./utils-c2ed83c6.js";import{T as D,M as Pa,S as Ma}from"./single-node-19c90d0d.js";import{i as La}from"./isPrintableCharacter-1b5c27a6.js";import{T as Ke}from"./Tag-8f3ea564.js";function Aa(G,X){const{namespace:Q,styled:p,id:x,list:E,customItem:H,itemId:U,itemSelected:k,itemFocused:_,multiple:T,virtual:l,focusVisible:I,onFocus:Y,onClick:j,_root:w=!0}=G,m=n.useRef(null),S=n.useRef(null),d=n.useRef(null),P=_&&E.findIndex(a=>a.id===_.id)!==-1,o=(()=>{if(_)for(const a of E){if(_.id===a.id)return a;let f=_;for(;f.parent;)if(f=f.parent,f.id===a.id)return a}})(),h=Ne(a=>{var f,q,W,y,ce,re,Z;if(m.current){let b;if(w&&F.isUndefined(_))switch(a){case"first":case"next":b=(f=S.current)==null?void 0:f.scrollToStart(m.current);break;case"last":case"prev":b=(q=S.current)==null?void 0:q.scrollToEnd(m.current);break}else if(P)switch(a){case"next":b=(W=S.current)==null?void 0:W.scrollToStep(m.current,1);break;case"prev":b=(y=S.current)==null?void 0:y.scrollToStep(m.current,-1);break;case"first":b=(ce=S.current)==null?void 0:ce.scrollToStart(m.current);break;case"last":b=(re=S.current)==null?void 0:re.scrollToEnd(m.current);break;case"prev-level":o&&o.parent&&(b=o.parent);break;case"next-level":if(o&&o.children){for(const M of o.children)if(M.enabled){b=M;break}}break;default:a instanceof HTMLElement&&m.current&&Oe(a,m.current);break}else b=(Z=d.current)==null?void 0:Z.call(d,a);return b}});n.useImperativeHandle(X,()=>h,[h]);const N=n.useMemo(()=>({list:E,itemKey:a=>a.id,itemSize:F.isNumber(l)?l:32,itemFocusable:a=>a.enabled}),[E,l]);return s.jsxs(s.Fragment,{children:[s.jsx(Be,{...N,ref:S,enable:l!==!1,listSize:264,listPadding:4,itemRender:(a,f,q)=>{let W=!1;if(a.children&&k){let y=k;for(;y.parent;)if(y=y.parent,y.id===a.id){W=!0;break}}return n.createElement("li",{...p("cascader__option",{"cascader__option.is-focused":a.id===(o==null?void 0:o.id),"cascader__option.is-selected":!T&&a.checked,"cascader__option.is-disabled":a.disabled}),...q,key:a.id,id:U(a.id),title:a.origin.label,role:"option","aria-selected":a.checked,"aria-disabled":a.disabled,onClick:()=>{Y(a),T&&!a.isLeaf||j(a)}},I&&(_==null?void 0:_.id)===a.id&&s.jsx("div",{className:`${Q}-focus-outline`}),W&&s.jsx("div",{...p("cascader__option-dot")}),T&&s.jsx("div",{...p("cascader__option-prefix"),children:s.jsx(Ge,{model:a.checked,disabled:a.disabled,indeterminate:a.indeterminate,onClick:y=>{y.stopPropagation(),Y(a),j(a)}})}),s.jsx("div",{...p("cascader__option-content"),children:H?H(a.origin):a.origin.label}),!a.isLeaf&&s.jsx("div",{...p("cascader__option-icon"),children:s.jsx(se,{children:a.origin.loading?s.jsx(De,{}):s.jsx(da,{})})}))},itemFocused:o==null?void 0:o.id,placeholder:"li",children:(a,f)=>s.jsx("ul",{...p("cascader__list","cascader__list--inline"),ref:m,id:x,tabIndex:-1,role:"listbox","aria-multiselectable":T,"aria-activedescendant":w&&!F.isUndefined(_)?U(_.id):void 0,onScroll:f,children:E.length===0?s.jsx(ge,{style:{padding:"12px 28px"},image:ge.SIMPLE_IMG}):a})}),o&&!o.origin.loading&&o.children&&s.jsx(Ye,{...G,_root:!1,ref:d,id:void 0,list:o.children})]})}const Ye=n.forwardRef(Aa);function Fa(G,X){const{namespace:Q,styled:p,id:x,list:E,customItem:H,itemId:U,itemFocused:k,multiple:_,onlyLeafSelectable:T,virtual:l,focusVisible:I,onClick:Y}=G,j=n.useRef(null),w=n.useRef(null),m=Ne(d=>{var P,o,h,N;if(j.current){let a;switch(d){case"next":a=(P=w.current)==null?void 0:P.scrollToStep(j.current,1);break;case"prev":a=(o=w.current)==null?void 0:o.scrollToStep(j.current,-1);break;case"first":a=(h=w.current)==null?void 0:h.scrollToStart(j.current);break;case"last":a=(N=w.current)==null?void 0:N.scrollToEnd(j.current);break;default:d instanceof HTMLElement&&j.current&&Oe(d,j.current);break}return a}});n.useImperativeHandle(X,()=>m,[m]);const S=n.useMemo(()=>({list:E,itemKey:d=>d.value,itemSize:F.isNumber(l)?l:32,itemFocusable:d=>d[D].enabled}),[E,l]);return s.jsx(Be,{...S,ref:w,enable:l!==!1,listSize:264,listPadding:4,itemRender:(d,P,o)=>{const h=d[D];let N=h.checked;if(!T){let a=h;for(;a.parent;)if(a=a.parent,a.id===d.value){N=!0;break}}return n.createElement("li",{...p("cascader__option",{"cascader__option.is-selected":!_&&N,"cascader__option.is-disabled":h.disabled}),...o,key:d.value,id:U(d.value),title:d.label,role:"option","aria-selected":h.checked,"aria-disabled":h.disabled,onClick:()=>{Y(d)}},I&&(k==null?void 0:k.value)===d.value&&s.jsx("div",{className:`${Q}-focus-outline`}),_&&s.jsx("div",{...p("cascader__option-prefix"),children:s.jsx(Ge,{model:h.checked,disabled:h.disabled})}),s.jsx("div",{...p("cascader__option-content"),children:H?H(h.origin):me(h)}))},itemFocused:k==null?void 0:k.value,placeholder:"li",children:(d,P)=>s.jsx("ul",{...p("cascader__list"),ref:j,id:x,tabIndex:-1,role:"listbox","aria-multiselectable":_,"aria-activedescendant":F.isUndefined(k)?void 0:U(k.value),onScroll:P,children:E.length===0?s.jsx(ge,{style:{padding:"12px 28px"},image:ge.SIMPLE_IMG}):d})})}const Wa=n.forwardRef(Fa),$a={cascader:"^cascader","cascader.is-expanded":"is-expanded","cascader.is-disabled":"is-disabled","cascader--small":"^cascader--small","cascader--medium":"^cascader--medium","cascader--large":"^cascader--large",cascader__container:"^cascader__container",cascader__content:"^cascader__content",cascader__search:"^cascader__search","cascader__placeholder-wrapper":"^cascader__placeholder-wrapper",cascader__placeholder:"^cascader__placeholder","cascader__multiple-count":"^cascader__multiple-count",cascader__close:"^cascader__close",cascader__clear:"^cascader__clear",cascader__icon:"^cascader__icon",cascader__arrow:"^cascader__arrow","cascader-popup":"^cascader-popup","cascader-popup__loading":"^cascader-popup__loading","cascader-popup__loading--empty":"^cascader-popup__loading--empty",cascader__list:"^cascader__list","cascader__list--inline":"^cascader__list--inline",cascader__option:"^cascader__option","cascader__option.is-focused":"is-focused","cascader__option.is-selected":"is-selected","cascader__option.is-disabled":"is-disabled","cascader__option-dot":"^cascader__option-dot","cascader__option-prefix":"^cascader__option-prefix","cascader__option-content":"^cascader__option-content","cascader__option-icon":"^cascader__option-icon",cascader__empty:"^cascader__empty"};function za(G,X){const{styleOverrides:Q,styleProvider:p,formControl:x,list:E,model:H,defaultModel:U,visible:k,defaultVisible:_,placeholder:T,multiple:l=!1,searchable:I=!1,searchValue:Y,defaultSearchValue:j,onlyLeafSelectable:w=!0,clearable:m=!1,loading:S=!1,size:d,disabled:P=!1,virtual:o=!1,escClosable:h=!0,customItem:N,customSelected:a,customSearch:f,inputRef:q,inputRender:W,onModelChange:y,onVisibleChange:ce,onSearch:re,onClear:Z,onFirstFocus:b,afterVisibleChange:M,...C}=ua("Cascader",G),V=pa(),g=fa($a,{cascader:p==null?void 0:p.cascader,"cascader-popup":p==null?void 0:p["cascader-popup"]},Q),te=_a(),{t:Te}=ha(),Pe=n.useId(),ve=`${V}-cascader-list-${Pe}`,xe=e=>`${V}-cascader-item-${e}-${Pe}`,{pageScrollRef:qe,contentResizeRef:Ze}=ba(),ie=n.useRef(null),K=n.useRef(null),ne=n.useRef(null),Je=Ra(ne,q),ee=n.useRef(null),le=n.useRef({itemFocused:new Set}),[oe,O]=n.useMemo(()=>{const e=E.map(i=>l?new Pa(i,r=>r.value,{disabled:i.disabled}):new Ma(i,r=>r.value,{disabled:i.disabled})),c=new Map,t=i=>{for(const r of i)c.set(r.id,r),r.children&&t(r.children)};return t(e),[e,c]},[E,l]),[v,L]=we(_??!1,k,ce),[de,Xe]=we(j??"",Y,re),[ue,$]=we(U??(l?[]:null),H,e=>{y&&(l?y(e,e.map(c=>O.get(c).origin)):y(e,F.isNull(e)?null:O.get(e).origin))},void 0,x==null?void 0:x.control),R=n.useMemo(()=>l?new Set(ue):ue,[ue,l]),Me=e=>{if(l){const c=e.changeStatus(e.checked?"UNCHECKED":"CHECKED",R);$(Array.from(c.keys()))}else(e.isLeaf||!w)&&$(e.id),e.isLeaf&&L(!1)},Le=e=>{if(l){const c=e[D].changeStatus(e[D].checked?"UNCHECKED":"CHECKED",R);$(Array.from(c.keys()))}else $(e[D].id),L(!1)};O.forEach(e=>{e.updateStatus(R)});const{size:Se,disabled:J}=ma({size:d,disabled:P||(x==null?void 0:x.control.disabled)}),A=de.length>0,pe=l?R.size>0:!F.isNull(R),fe=(()=>{if(!A)return[];const e=F.isUndefined(f==null?void 0:f.filter)?r=>r.label.includes(de):r=>f.filter(de,r),c=f==null?void 0:f.sort,t=[],i=r=>{r.forEach(u=>{(!l&&!w||u.isLeaf)&&e(u.origin)&&t.push({label:me(u),value:u.id,disabled:u.disabled,[D]:u}),u.children&&i(u.children)})};return i(oe),c&&t.sort((r,u)=>c(r[D].origin,u[D].origin)),t})(),Ae=A?fe.length===0:oe.length===0,[Fe,Qe]=ga(e=>e.startsWith("Arrow")||["Home","End","Enter","Space"].includes(e)),[We,ea]=n.useState(),$e=e=>{le.current.itemFocused.has(e.id)||(le.current.itemFocused.add(e.id),b==null||b(e.id,e.origin)),ea(e)},ke=(()=>{if(We){const e=O.get(We.id);if(e&&e.enabled)return e}if(pe)return Ce(oe,e=>e.enabled&&e.checked)})(),[je,aa]=n.useState(),ze=e=>{le.current.itemFocused.has(e.value)||(le.current.itemFocused.add(e.value),b==null||b(e.value,e[D].origin)),aa(e)},ye=(()=>{if(je&&Ce(fe,e=>e[D].enabled&&e.value===je.value))return je;if(A)return Ce(fe,e=>e[D].enabled)})(),sa=va(v),ca=`calc(var(--${V}-zindex-fixed) + ${sa})`,Ee=n.useRef(),z=Ne(()=>{if(v&&ie.current&&K.current){const e=K.current.offsetHeight,c=xa.windowSize.width-Ve*2,t=Math.min(K.current.scrollWidth,c),i=Sa(ie.current,{width:t,height:e},{placement:"bottom-left",inWindow:Ve});Ee.current=i.transformOrigin,te.classes.position&&K.current.classList.toggle(te.classes.position,!1),te.replaceRule("position",{top:i.top,left:i.left,maxWidth:c}),K.current.classList.toggle(te.classes.position,!0)}}),ra=ka(z,!v);ja(qe,"scroll",z,{passive:!0},!v||ra),Ie(ie,z,void 0,!v),Ie(K,z,void 0,!v),Ie(Ze,z,void 0,!v),n.useImperativeHandle(X,()=>({updatePosition:z}),[z]);const _e=e=>{document.activeElement===ne.current&&e.target!==ne.current&&e.button===0&&e.preventDefault()},B=n.useRef(),he=I&&v,He=m&&pe&&!v&&!S&&!J,Ue=Qe(n.createElement(I?"input":"div",Object.assign({...be(g("cascader__search"),{style:{opacity:he?void 0:0,zIndex:he?void 0:-1}}),...x==null?void 0:x.inputAria,ref:Je,tabIndex:J?-1:0,role:"combobox","aria-haspopup":"listbox","aria-expanded":v,"aria-controls":ve,onBlur:()=>{L(!1)},onKeyDown:e=>{if(e.code==="Escape")v&&h&&(e.stopPropagation(),e.preventDefault(),L(!1));else{const c=t=>{if(ee.current){const i=ee.current(t);i&&(A?ze(i):$e(i),o===!1&&!t.includes("level")&&(B.current=()=>{const r=document.getElementById(xe(A?i.value:i.id));r&&ee.current(r)},v&&(B.current(),B.current=void 0)))}};if(v)switch(e.code){case"ArrowUp":{e.preventDefault(),c("prev");break}case"ArrowDown":{e.preventDefault(),c("next");break}case"ArrowLeft":{A||(e.preventDefault(),c("prev-level"));break}case"ArrowRight":{A||(e.preventDefault(),c("next-level"));break}case"Home":{e.preventDefault(),c("first");break}case"End":{e.preventDefault(),c("last");break}default:{(e.code==="Enter"||e.code==="Space"&&!I)&&(e.preventDefault(),A?ye&&Le(ye):ke&&Me(ke));break}}else if(!(I&&["Home","End","Enter","Space"].includes(e.code)))switch(e.code){case"End":case"ArrowUp":{e.preventDefault(),L(!0),c("last");break}case"Home":case"ArrowDown":{e.preventDefault(),L(!0),c("first");break}case"Enter":case"Space":{e.preventDefault(),L(!0);break}default:{La(e.key)&&L(!0);break}}}},onChange:e=>{I&&Xe(e.currentTarget.value)}},I?{type:"text",value:de,autoComplete:"off",disabled:J}:{}))),[ta,ia,na]=(()=>{let e=null,c=null,t;if(l){const i=[];for(const r of ue){const u=O.get(r);u&&i.push(u)}c=s.jsx(ya,{list:i.map(r=>{const{value:u,disabled:ae}=r.origin,oa=a?a(r.origin):me(r);return{id:u,title:oa,type:"item",disabled:ae,node:r}}),onClick:(r,u)=>{const ae=u.node.changeStatus("UNCHECKED",R);return $(Array.from(ae.keys())),!1},children:s.jsx(Ke,{tabIndex:-1,size:Se,children:R.size})}),e=i.map(r=>s.jsxs(Ke,{size:Se,children:[a?a(r.origin):r.origin.label,!(r.disabled||J)&&s.jsx("div",{...g("cascader__close"),role:"button","aria-label":Te("Close"),onClick:u=>{u.stopPropagation();const ae=r.changeStatus("UNCHECKED",R);$(Array.from(ae.keys()))},children:s.jsx(se,{children:s.jsx(Ea,{})})})]},r.id))}else if(!F.isNull(R)){const i=O.get(R);i&&(t=me(i),e=a?a(i.origin):t)}return[e,c,t]})(),la=wa({compose:{disabled:J},form:x});return s.jsxs(s.Fragment,{children:[s.jsxs("div",{...C,...be(g("cascader",`cascader--${Se}`,{"cascader.is-expanded":v,"cascader.is-disabled":J}),{className:C.className,style:C.style}),...la,ref:ie,onMouseDown:e=>{var c;(c=C.onMouseDown)==null||c.call(C,e),_e(e)},onMouseUp:e=>{var c;(c=C.onMouseUp)==null||c.call(C,e),_e(e)},onClick:e=>{var c,t;(c=C.onClick)==null||c.call(C,e),(t=ne.current)==null||t.focus({preventScroll:!0}),L(i=>I?!0:!i)},children:[s.jsxs("div",{...g("cascader__container"),title:na,children:[W?W(Ue):Ue,!he&&(pe?s.jsx("div",{...g("cascader__content"),children:ta}):T?s.jsx("div",{...g("cascader__placeholder-wrapper"),children:s.jsx("div",{...g("cascader__placeholder"),children:T})}):null)]}),l&&s.jsx("div",{...g("cascader__multiple-count"),onClick:e=>{e.stopPropagation()},children:ia}),He&&s.jsx("div",{...g("cascader__clear"),role:"button","aria-label":Te("Clear"),onClick:e=>{e.stopPropagation(),Z==null||Z(),$(l?[]:null)},children:s.jsx(se,{children:s.jsx(Da,{})})}),s.jsx("div",{...be(g("cascader__icon"),{style:{visibility:He?"hidden":void 0}}),children:s.jsx(se,{children:S?s.jsx(De,{}):he?s.jsx(Ta,{}):s.jsx(Na,{...g("cascader__arrow")})})})]}),s.jsx(Ca,{selector:()=>{let e=document.getElementById(`${V}-cascader-root`);return e||(e=document.createElement("div"),e.id=`${V}-cascader-root`,document.body.appendChild(e)),e},children:s.jsx(Ia,{enter:v,during:Re,afterRender:()=>{var e;z(),(e=B.current)==null||e.call(B),B.current=void 0},afterEnter:()=>{M==null||M(!0)},afterLeave:()=>{M==null||M(!1)},children:e=>{let c={};switch(e){case"enter":c={transform:"scaleY(0.7)",opacity:0};break;case"entering":c={transition:["transform","opacity"].map(t=>`${t} ${Re}ms ease-out`).join(", "),transformOrigin:Ee.current};break;case"leaving":c={transform:"scaleY(0.7)",opacity:0,transition:["transform","opacity"].map(t=>`${t} ${Re}ms ease-in`).join(", "),transformOrigin:Ee.current};break;case"leaved":c={display:"none"};break}return s.jsxs("div",{...be(g("cascader-popup"),{style:{zIndex:ca,...c}}),ref:K,onMouseDown:t=>{_e(t)},onMouseUp:t=>{_e(t)},children:[S&&s.jsx("div",{...g("cascader-popup__loading",{"cascader-popup__loading--empty":Ae}),children:s.jsx(se,{children:s.jsx(De,{})})}),S&&Ae?null:A?s.jsx(Wa,{ref:ee,namespace:V,styled:g,id:ve,list:fe,customItem:N,itemId:xe,itemFocused:ye,multiple:l,onlyLeafSelectable:w,virtual:o,focusVisible:Fe,onClick:t=>{ze(t),Le(t)}}):s.jsx(Ye,{ref:ee,namespace:V,styled:g,id:ve,list:oe,customItem:N,itemId:xe,itemSelected:!l&&pe?O.get(R):void 0,itemFocused:ke,multiple:l,virtual:o,focusVisible:Fe,onFocus:$e,onClick:Me})]})}})})]})}const Qa=n.forwardRef(za);export{Qa as C};
