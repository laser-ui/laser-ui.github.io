import{v as ue,r as p,l as ae,j as t,V as he,I as k,p as _e,u as pe,a as ge,b as Se,c as q,y as be,M as me,m as xe,B as Z,E as je}from"./index-0bc3a1b4.js";import{S as ve}from"./keyboard_arrow_left-d6d764bc.js";import{S as Ce}from"./search-292c7508.js";import{C as ee}from"./Checkbox-7fc6b4c2.js";import{I as ye}from"./Input-09babb13.js";import{V as Ee}from"./VirtualScroll-b7467640.js";import{E as se}from"./Empty-a36b3a10.js";const Ie={transfer:"^transfer","transfer.is-disabled":"is-disabled",transfer__panel:"^transfer__panel",transfer__actions:"^transfer__actions",transfer__header:"^transfer__header","transfer__header-title":"^transfer__header-title",transfer__search:"^transfer__search","transfer__list-container":"^transfer__list-container",transfer__list:"^transfer__list",transfer__loading:"^transfer__loading",transfer__option:"^transfer__option","transfer__option.is-disabled":"is-disabled","transfer__option-prefix":"^transfer__option-prefix","transfer__option-content":"^transfer__option-content"},_=Symbol(),ne=Symbol();function te(T){const{namespace:N,styled:i,list:d,selectedCount:m,state:C,title:y,loading:B,searchable:F,virtual:g,customItem:E,onSelectedChange:x,onAllSelectedChange:f,onSearch:I,onScrollBottom:K}=T,{t:w}=ue(),j=p.useRef(null),c=p.useId(),M=e=>`${N}-transfer-item-${e}-${c}`,v=p.useCallback(e=>!e.disabled,[]),L=p.useMemo(()=>({list:d,itemKey:e=>e.value,itemSize:ae.isNumber(g)?g:32,itemFocusable:v}),[v,d,g]);return t.jsxs("div",{...i("transfer__panel"),children:[t.jsxs("div",{...i("transfer__header"),children:[t.jsxs(ee,{model:C===!0,indeterminate:C==="mixed",disabled:d.length===0,onModelChange:e=>{f(e)},children:[m,"/",d.length]}),he(y)&&t.jsx("div",{...i("transfer__header-title"),children:y})]}),F&&t.jsx("div",{...i("transfer__search"),children:t.jsx(ye,{style:{display:"flex"},placeholder:w("Search"),prefix:t.jsx(k,{children:t.jsx(Ce,{})}),clearable:!0,onModelChange:I})}),t.jsxs("div",{...i("transfer__list-container"),children:[B&&t.jsx("div",{...i("transfer__loading"),children:t.jsx(k,{children:t.jsx(_e,{})})}),t.jsx(Ee,{...L,ref:e=>(j.current=e,()=>{j.current=null}),enable:g!==!1,listSize:192,listPadding:0,itemRender:(e,S,A)=>p.createElement("li",{...i("transfer__option",{"transfer__option.is-disabled":e.disabled}),...A,key:e.value,id:M(e.value),title:e.label,onClick:()=>{e.disabled||x==null||x(e.value)}},t.jsx("div",{...i("transfer__option-prefix"),children:t.jsx(ee,{model:e[_],disabled:e.disabled})}),t.jsx("div",{...i("transfer__option-content"),children:E?E(e.value,e[ne]?void 0:e):e.label})),placeholder:"li",onScrollEnd:K,children:(e,S)=>t.jsx("ul",{...i("transfer__list"),onScroll:S,children:d.length===0?t.jsx(se,{style:{marginTop:32},image:se.SIMPLE_IMG}):e})})]})]})}function Te(T){const{styleOverrides:N,styleProvider:i,formControl:d,list:m,model:C,defaultModel:y,selected:B,defaultSelected:F,searchable:g=!1,searchValue:E,defaultSearchValue:x,title:f,loading:I=[!1,!1],disabled:K=!1,virtual:w=!1,customItem:j,customSearch:c,onModelChange:M,onSelectedChange:v,onSearch:L,onScrollBottom:e,...S}=pe("Transfer",T),A=ge(),P=Se(Ie,{transfer:i==null?void 0:i.transfer},N),O=p.useMemo(()=>new Map(m.map(s=>[s.value,s])),[m]),[$,re]=q(y??[],C,s=>{M&&M(s,s.map(a=>O.get(a)))},void 0,d==null?void 0:d.control),le=p.useMemo(()=>new Set($),[$]),[G,z]=q(F??[],B,s=>{v&&v(s,s.map(a=>O.get(a)))}),oe=p.useMemo(()=>new Set(G),[G]),[b,H]=q(x??["",""],E,L),{disabled:ie}=be({disabled:K||(d==null?void 0:d.control.disabled)}),[u,U,V]=(()=>{const s=[[],[]],a=[0,0],l=[!0,!0],r=[!0,!0],h=[!1,!1],X=ae.isUndefined(c==null?void 0:c.filter)?(n,o)=>n.label.includes(o):(n,o)=>c.filter(o,n),R=c==null?void 0:c.sort,D=(n,o,fe)=>{const Y=Object.assign({[_]:!1,[ne]:fe},n);oe.has(n.value)?(Y[_]=!0,a[o]+=1,n.disabled||(h[o]=!0)):n.disabled||(r[o]=!1),s[o].push(Y),n.disabled||(l[o]=!1)};m.forEach(n=>{le.has(n.value)||(!b[0]||X(n,b[0]))&&D(n,0,!1)}),$.forEach(n=>{const o=O.get(n);b[1]?o&&X(o,b[1])&&D(o,1,!1):D(o??{label:n,value:n},1,!o)}),b[0]&&R&&s[0].sort(R),b[1]&&R&&s[1].sort(R);const ce=[0,1].map(n=>l[n]?!1:r[n]?!0:h[n]?"mixed":!1);return[s,a,ce]})(),J=s=>{z(a=>{const l=a.findIndex(r=>r===s);l!==-1?a.splice(l,1):a.push(s)})},Q=(s,a)=>{z(l=>{const r=new Set(l);for(const h of a?u[0]:u[1])h.disabled||(s&&!h[_]?r.add(h.value):!s&&h[_]&&r.delete(h.value));return Array.from(r)})},W=s=>{re(a=>{if(s){const l=new Set;return u[0].forEach(r=>{r[_]&&l.add(r.value)}),Array.from(l).concat(a)}else{const l=new Set(a);return u[1].forEach(r=>{r[_]&&l.delete(r.value)}),Array.from(l)}}),z(a=>{const l=new Set(a);return(s?u[0]:u[1]).forEach(r=>{r[_]&&l.delete(r.value)}),Array.from(l)})},de=me({form:d});return t.jsxs("div",{...S,...xe(P("transfer",{"transfer.is-disabled":ie}),{className:S.className,style:S.style}),...de,children:[t.jsx(te,{namespace:A,styled:P,list:u[0],selectedCount:U[0],state:V[0],title:f==null?void 0:f[0],loading:I[0]??!1,searchable:g,virtual:w,customItem:j,onSelectedChange:J,onAllSelectedChange:s=>{Q(s,!0)},onSearch:s=>{H(a=>{a[0]=s})},onScrollBottom:()=>{e==null||e("left")}}),t.jsxs("div",{...P("transfer__actions"),children:[t.jsx(Z,{disabled:V[0]===!1,pattern:"secondary",icon:t.jsx(k,{children:t.jsx(je,{})}),onClick:()=>{W(!0)}}),t.jsx(Z,{disabled:V[1]===!1,pattern:"secondary",icon:t.jsx(k,{children:t.jsx(ve,{})}),onClick:()=>{W(!1)}})]}),t.jsx(te,{namespace:A,styled:P,list:u[1],selectedCount:U[1],state:V[1],title:f==null?void 0:f[1],loading:I[1]??!1,searchable:g,virtual:w,customItem:j,onSelectedChange:J,onAllSelectedChange:s=>{Q(s,!1)},onSearch:s=>{H(a=>{a[1]=s})},onScrollBottom:()=>{e==null||e("right")}})]})}export{Te as T};
