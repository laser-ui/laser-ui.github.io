import{u as rt,a as it,b as at,v as dt,r as u,d as ut,c as fe,l as j,y as pt,F as ft,G as se,H as _t,f as ht,R as Ee,W as le,J as Ie,h as mt,i as _e,j as n,o as xt,I as G,K as bt,M as vt,m as z,p as ke,P as gt,k as St,N as yt,A as jt}from"./index-11f4945e.js";import{s as wt}from"./setRef-d510918a.js";import{S as Et}from"./cancel-be7a1fc6.js";import{S as It}from"./add-fdc20cbd.js";import{S as kt}from"./keyboard_arrow_down-0f317b49.js";import{S as Dt}from"./search-eae0a724.js";import{T as De}from"./Tag-09d679a5.js";import{i as Ct}from"./isPrintableCharacter-1b5c27a6.js";import{B as Rt}from"./BaseInput-1c6ddb56.js";import{V as Mt}from"./VirtualScroll-0816c5ae.js";import{C as Nt}from"./Checkbox-7628988d.js";import{E as Ce}from"./Empty-ce83a2b5.js";const Wt={select:"^select","select.is-expanded":"is-expanded","select.is-disabled":"is-disabled","select--small":"^select--small","select--medium":"^select--medium","select--large":"^select--large",select__container:"^select__container",select__content:"^select__content",select__search:"^select__search","select__placeholder-wrapper":"^select__placeholder-wrapper",select__placeholder:"^select__placeholder","select__multiple-count":"^select__multiple-count",select__close:"^select__close",select__clear:"^select__clear",select__icon:"^select__icon",select__arrow:"^select__arrow","select-popup":"^select-popup","select-popup__content":"^select-popup__content","select-popup__loading":"^select-popup__loading","select-popup__loading--empty":"^select-popup__loading--empty",select__list:"^select__list",select__option:"^select__option","select__option.is-selected":"is-selected","select__option.is-disabled":"is-disabled","select__option-prefix":"^select__option-prefix","select__option-content":"^select__option-content","select__option-group":"^select__option-group","select__option-group-label":"^select__option-group-label",select__empty:"^select__empty"},F=Symbol();function Kt(Re){const{ref:Me,styleOverrides:Ne,styleProvider:D,formControl:b,list:C,model:We,defaultModel:Ae,visible:ze,defaultVisible:Fe,placeholder:he,multiple:f=!1,searchable:R=!1,searchValue:Te,defaultSearchValue:Ve,clearable:Le=!1,loading:q=!1,size:$e,disabled:Be=!1,monospaced:Ue=!0,virtual:T=!1,escClosable:Oe=!0,customItem:me,customSelected:J,customSearch:w,createItem:ne,inputProps:r,popupRender:xe,onModelChange:ce,onVisibleChange:Pe,onSearch:He,onClear:oe,onCreateItem:re,onScrollBottom:Ke,afterVisibleChange:M,...h}=rt("Select",Re),E=it(),o=at(Wt,{select:D==null?void 0:D.select,"select-popup":D==null?void 0:D["select-popup"]},Ne),{t:Z}=dt(),be=u.useId(),ve=`${E}-select-list-${be}`,V=e=>`${E}-select-item-${e}-${be}`,{contentResizeRef:Ge}=ut(),v=u.useRef(null),i=u.useRef(null),g=u.useRef(null),L=u.useRef(null),N=u.useRef(null),$=u.useMemo(()=>{const e=new Map,t=s=>{for(const l of s)e.set(l.value,l),l.children&&t(l.children)};return t(C),e},[C]),[_,S]=fe(Fe??!1,ze,Pe),[B,qe]=fe(Ve??"",Te,He),I=u.useCallback(e=>!e.disabled&&!e.children,[]),[Q,X]=fe(Ae??(f?[]:null),We,e=>{ce&&(f?ce(e,e.map(t=>$.get(t))):ce(e,j.isNull(e)?null:$.get(e)))},void 0,b==null?void 0:b.control),x=u.useMemo(()=>f?new Set(Q):Q,[Q,f]),Y=e=>{f?X(t=>{const s=t.findIndex(l=>l===e);s!==-1?t.splice(s,1):t.push(e)}):(X(e),S(!1))},{size:ie,disabled:W}=pt({size:$e,disabled:Be||(b==null?void 0:b.control.disabled)}),U=B.length>0,ae=f?x.size>0:!j.isNull(x),de=(()=>{if(!U)return[];const e=j.isUndefined(w==null?void 0:w.filter)?c=>c.label.includes(B):c=>w.filter(B,c),t=w==null?void 0:w.sort;let s=ne==null?void 0:ne(B);s&&(s={...s,[F]:!0});let l=[];return C.forEach(c=>{if(!c.children)s&&c.value===s.value&&(s=void 0),e(c)&&l.push(c);else{const a=[];c.children.forEach(p=>{s&&p.value===s.value&&(s=void 0),e(p)&&a.push(p)}),l=l.concat(a)}}),t&&l.sort(t),s&&l.unshift(s),l})(),O=U?de:C,[Je,ue]=ft(e=>e.startsWith("Arrow")||["Home","End","Enter","Space"].includes(e)),[ge,Ze]=u.useState(),Qe=(()=>{let e;return ge&&(e=$.get(ge.value),e&&I(e))||(ae&&(e=se(C,t=>I(t)&&f?x.has(t.value):x===t.value)),j.isUndefined(e)&&(e=se(C,t=>I(t)))),e})(),[pe,Xe]=u.useState(),Ye=(()=>{if(pe&&se(de,e=>I(e)&&e.value===pe.value))return pe;if(U)return se(de,e=>I(e))})(),m=U?Ye:Qe,Se=e=>{U?Xe(e):Ze(e)},ye=e=>{if(!j.isUndefined(e)){const t=Object.assign({},e);delete t[F],re==null||re(t)}},et=_t(_),tt=`calc(var(--${E}-zindex-fixed) + ${et})`,y=ht(()=>{if(_&&v.current&&i.current)if(Ue){const e=Math.min(v.current.offsetWidth,Ee.windowSize.width-le*2),t=i.current.offsetHeight,s=Ie(v.current,{width:e,height:t},{placement:"bottom",inWindow:le});i.current.style.setProperty("--popup-down-transform-origin",s.transformOrigin),i.current.style.top=s.top+"px",i.current.style.left=s.left+"px",i.current.style.width=e+"px",i.current.style.minWidth="",i.current.style.maxWidth=""}else{const e=v.current.offsetWidth,t=i.current.offsetHeight,s=Ee.windowSize.width-le*2,l=Math.min(Math.max(i.current.scrollWidth,e),s),c=Ie(v.current,{width:l,height:t},{placement:"bottom-left",inWindow:le});i.current.style.setProperty("--popup-down-transform-origin",c.transformOrigin),i.current.style.top=c.top+"px",i.current.style.left=c.left+"px",i.current.style.width="",i.current.style.minWidth=Math.min(e,s)+"px",i.current.style.maxWidth=s+"px"}});mt(v,y,!_),_e(v,y,void 0,!_),_e(i,y,void 0,!_),_e(Ge,y,void 0,!_),u.useImperativeHandle(Me,()=>({updatePosition:y}),[y]);const ee=e=>{document.activeElement===L.current&&e.target!==L.current&&e.button===0&&e.preventDefault()},P=u.useRef(()=>{}),te=R&&_,je=Le&&ae&&!_&&!q&&!W,[st,lt,nt]=(()=>{let e=null,t=null,s;if(f){const l=Q.map(c=>{const a=$.get(c);return{value:c,label:J?J(c,a):a?a.label:String(c),item:a}});t=n.jsx(xt,{list:l.map(({value:c,label:a,item:p})=>({id:c,title:a,type:"item",disabled:p==null?void 0:p.disabled})),onClick:c=>(Y(c),!1),children:c=>n.jsx(De,{...c,tabIndex:-1,size:ie,children:x.size})}),e=l.map(({value:c,label:a,item:p})=>n.jsxs(De,{size:ie,children:[a,!(p!=null&&p.disabled||W)&&n.jsx("div",{...o("select__close"),role:"button","aria-label":Z("Close"),onClick:k=>{k.stopPropagation(),Y(c)},children:n.jsx(G,{children:n.jsx(bt,{})})})]},c))}else if(!j.isNull(x)){const l=$.get(x);e=s=J?J(x,l):l?l.label:String(x)}return[e,t,s]})(),ct=vt({compose:{disabled:W},form:b}),ot=u.useMemo(()=>({list:O,itemKey:e=>e.value,itemSize:j.isNumber(T)?T:32,itemEmptySize:32,itemNested:e=>e.children,itemFocusable:I}),[I,O,T]);return n.jsxs(n.Fragment,{children:[n.jsxs("div",{...h,...z(o("select",`select--${ie}`,{"select.is-expanded":_,"select.is-disabled":W}),{className:h.className,style:h.style}),...ct,ref:e=>(v.current=e,()=>{v.current=null}),onMouseDown:e=>{var t;(t=h.onMouseDown)==null||t.call(h,e),ee(e)},onMouseUp:e=>{var t;(t=h.onMouseUp)==null||t.call(h,e),ee(e)},onClick:e=>{var t,s;(t=h.onClick)==null||t.call(h,e),(s=L.current)==null||s.focus({preventScroll:!0}),S(l=>R?!0:!l)},children:[n.jsxs("div",{...o("select__container"),title:nt,children:[(()=>{const e=Object.assign({...r,...z(o("select__search"),{style:{opacity:te?void 0:0,zIndex:te?void 0:-1}}),...b==null?void 0:b.inputAria,ref:t=>{L.current=t;const s=wt(r==null?void 0:r.ref,t);return()=>{L.current=null,s()}},tabIndex:W?-1:0,role:"combobox","aria-haspopup":"listbox","aria-expanded":_,"aria-controls":ve,onFocus:t=>{var s;(s=r==null?void 0:r.onFocus)==null||s.call(r,t),ue.onFocus(t)},onBlur:t=>{var s;(s=r==null?void 0:r.onBlur)==null||s.call(r,t),ue.onBlur(t),S(!1)},onKeyDown:t=>{var s;if((s=r==null?void 0:r.onKeyDown)==null||s.call(r,t),ue.onKeyDown(t),t.code==="Escape")_&&Oe&&(t.stopPropagation(),t.preventDefault(),S(!1));else{const l=c=>{var a,p,k,H;if(g.current){let d;switch(c){case"next":d=(a=N.current)==null?void 0:a.scrollToStep(g.current,1);break;case"prev":d=(p=N.current)==null?void 0:p.scrollToStep(g.current,-1);break;case"first":d=(k=N.current)==null?void 0:k.scrollToStart(g.current);break;case"last":d=(H=N.current)==null?void 0:H.scrollToEnd(g.current);break}d&&(Se(d),T===!1&&(P.current=()=>{P.current=()=>{};const A=document.getElementById(V(d.value));A&&jt(A,g.current)},_&&P.current()))}};if(_)switch(t.code){case"ArrowUp":{t.preventDefault(),l("prev");break}case"ArrowDown":{t.preventDefault(),l("next");break}case"Home":{t.preventDefault(),l("first");break}case"End":{t.preventDefault(),l("last");break}default:{(t.code==="Enter"||t.code==="Space"&&!R)&&(t.preventDefault(),m&&(m[F]&&ye(m),Y(m.value)));break}}else if(!(R&&["Home","End","Enter","Space"].includes(t.code)))switch(t.code){case"End":case"ArrowUp":{t.preventDefault(),S(!0),l("last");break}case"Home":case"ArrowDown":{t.preventDefault(),S(!0),l("first");break}case"Enter":case"Space":{t.preventDefault(),S(!0);break}default:{Ct(t.key)&&S(!0);break}}}}},R?{type:"text",value:B,autoComplete:"off",disabled:W,onValueChange:t=>{qe(t)}}:{});return R?n.jsx(Rt,{...e}):n.jsx("div",{...e})})(),!te&&(ae?n.jsx("div",{...o("select__content"),children:st}):he?n.jsx("div",{...o("select__placeholder-wrapper"),children:n.jsx("div",{...o("select__placeholder"),children:he})}):null)]}),f&&n.jsx("div",{...o("select__multiple-count"),onClick:e=>{e.stopPropagation()},children:lt}),je&&n.jsx("div",{...o("select__clear"),role:"button","aria-label":Z("Clear"),onClick:e=>{e.stopPropagation(),X(f?[]:null),oe==null||oe()},children:n.jsx(G,{children:n.jsx(Et,{})})}),n.jsx("div",{...z(o("select__icon"),{style:{visibility:je?"hidden":void 0}}),children:n.jsx(G,{children:q?n.jsx(ke,{}):te?n.jsx(Dt,{}):n.jsx(kt,{...o("select__arrow")})})})]}),n.jsx(gt,{selector:()=>{let e=document.getElementById(`${E}-select-root`);return e||(e=document.createElement("div"),e.id=`${E}-select-root`,document.body.appendChild(e)),e},children:n.jsx(St,{enter:_,name:`${E}-popup-down`,duration:yt,onSkipEnter:()=>{y(),P.current()},onBeforeEnter:()=>{y(),P.current()},onAfterEnter:()=>{M==null||M(!0)},onAfterLeave:()=>{M==null||M(!1)},children:(e,t)=>n.jsx("div",{...z(o("select-popup"),{style:{zIndex:tt,...t?{display:"none"}:void 0}}),ref:s=>(i.current=s,e(s),()=>{i.current=null,e(null)}),onMouseDown:s=>{ee(s)},onMouseUp:s=>{ee(s)},children:(()=>{const s=n.jsxs("div",{...o("select-popup__content"),children:[q&&n.jsx("div",{...o("select-popup__loading",{"select-popup__loading--empty":O.length===0}),children:n.jsx(G,{children:n.jsx(ke,{})})}),q&&O.length===0?null:n.jsx(Mt,{...ot,ref:l=>(N.current=l,()=>{N.current=null}),enable:T!==!1,listSize:264,listPadding:4,itemRender:(l,c,a,p,k)=>{const{label:H,value:d,disabled:A}=l,we=me?me(l):H;if(k)return u.createElement("ul",{...o("select__option-group"),key:d,role:"group","aria-labelledby":V(d)},u.createElement("li",{...o("select__option-group-label"),key:d,id:V(d),role:"presentation"},n.jsx("div",{...o("select__option-content"),children:we})),k);let K=!1;return f?K=x.has(d):K=x===d,u.createElement("li",{...z(o("select__option",{"select__option.is-selected":!f&&K,"select__option.is-disabled":A}),{style:{paddingLeft:p.length===0?void 0:20}}),...a,key:d,id:V(d),title:(l[F]?Z("Create")+" ":"")+H,role:"option","aria-selected":K,"aria-disabled":A,onClick:()=>{l[F]&&ye(l),Se(l),Y(d)}},Je&&(m==null?void 0:m.value)===d&&n.jsx("div",{className:`${E}-focus-outline`}),l[F]?n.jsx("div",{...o("select__option-prefix"),children:n.jsx(G,{theme:"primary",children:n.jsx(It,{})})}):f?n.jsx("div",{...o("select__option-prefix"),children:n.jsx(Nt,{model:K,disabled:A})}):null,n.jsx("div",{...o("select__option-content"),children:we}))},itemFocused:m==null?void 0:m.value,itemEmptyRender:()=>n.jsx("li",{...z(o("select__empty"),{style:{paddingLeft:20}}),children:n.jsx("div",{...o("select__option-content"),children:Z("No data")})}),itemInAriaSetsize:l=>!l.children,placeholder:"li",onScrollEnd:Ke,children:(l,c)=>n.jsx("ul",{...o("select__list"),ref:a=>(g.current=a,()=>{g.current=null}),id:ve,tabIndex:-1,role:"listbox","aria-multiselectable":f,"aria-activedescendant":j.isUndefined(m)?void 0:V(m.value),onScroll:c,children:O.length===0?n.jsx(Ce,{style:{padding:"12px 0"},image:Ce.SIMPLE_IMG}):l})})]});return xe?xe(s):s})()})})})]})}export{Kt as S};
