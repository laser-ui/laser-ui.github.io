import{r as i,u as O,b as P,v as G,l as I,j as e,m as R,I as k,q as Z,C as de,T as L,n as me,c as _e,a9 as he,g as ge}from"./index-d424cda2.js";import{u as ve}from"./useForkRef-3a065cfc.js";import{F as xe}from"./file_download-9ba86618.js";import{S as be}from"./add-62c4348a.js";import{S as je}from"./visibility-46d12d30.js";import{u as ee}from"./MdRoute-2a8afccb.js";import{u as fe}from"./getOffsetToRoot-13eacab8.js";import{P as te}from"./Progress-fbdb7ef6.js";function se(){const n=i.useRef(!1);return fe(()=>{n.current=!0}),n}function we(n,w){const l=document.createElement("a");document.body.appendChild(l),l.style.display="none",l.href=n,l.download=w,l.click(),document.body.removeChild(l)}const Ue=n=>i.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",...n},i.createElement("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM8 9h8v10H8V9zm7.5-5-1-1h-5l-1 1H5v2h14V4h-3.5z"})),ye={upload:"^upload"},Se={"upload-button":"^upload-button","upload-button.is-disabled":"is-disabled","upload-button--load":"^upload-button--load","upload-button--error":"^upload-button--error","upload-button--progress":"^upload-button--progress","upload-button__thumbnail":"^upload-button__thumbnail","upload-button__name":"^upload-button__name","upload-button__actions":"^upload-button__actions","upload-button__icon":"^upload-button__icon","upload-button__text":"^upload-button__text"},pe={"upload-action":"^upload-action","upload-action.is-disabled":"is-disabled","upload-action--light":"^upload-action--light","upload-action--preview":"^upload-action--preview"},Re={"upload-list":"^upload-list","upload-list__item":"^upload-list__item","upload-list__item--load":"^upload-list__item--load","upload-list__item--error":"^upload-list__item--error","upload-list__item--progress":"^upload-list__item--progress","upload-list__icon":"^upload-list__icon","upload-list__link":"^upload-list__link","upload-list__link.is-active":"is-active","upload-list__actions":"^upload-list__actions","upload-list__progress-wrapper":"^upload-list__progress-wrapper"},ke={"upload-picture":"^upload-picture","upload-picture__row":"^upload-picture__row","upload-picture__item":"^upload-picture__item","upload-picture__item.is-disabled":"is-disabled","upload-picture__item--load":"^upload-picture__item--load","upload-picture__item--error":"^upload-picture__item--error","upload-picture__item--progress":"^upload-picture__item--progress","upload-picture__thumbnail":"^upload-picture__thumbnail","upload-picture__name":"^upload-picture__name","upload-picture__actions":"^upload-picture__actions","upload-picture__progress-text":"^upload-picture__progress-text"},Ee={"upload-picture-list":"^upload-picture-list","upload-picture-list__item":"^upload-picture-list__item","upload-picture-list__item--load":"^upload-picture-list__item--load","upload-picture-list__item--error":"^upload-picture-list__item--error","upload-picture-list__item--progress":"^upload-picture-list__item--progress","upload-picture-list__thumbnail":"^upload-picture-list__thumbnail","upload-picture-list__thumbnail-img":"^upload-picture-list__thumbnail-img","upload-picture-list__link":"^upload-picture-list__link","upload-picture-list__link.is-active":"is-active","upload-picture-list__actions":"^upload-picture-list__actions","upload-picture-list__progress-wrapper":"^upload-picture-list__progress-wrapper"},X=i.createContext({files:[],onRemove:()=>{}}),V=i.forwardRef((n,w)=>{const{styleOverrides:l,styleProvider:m,children:o,preset:u,disabled:a=!1,_file:c,_defaultActions:x,_light:b,_onRemove:_,...r}=O("UploadAction",n),t=P(pe,{"upload-action":m==null?void 0:m["upload-action"]},l),{t:d}=G(),s=u==="download"?a||I.isUndefined(c.url):a;return e.jsx("div",{...r,...R(t("upload-action",{"upload-action.is-disabled":s,"upload-action--light":b}),{className:r.className,style:r.style}),ref:w,role:r.role??"button",tabIndex:r.tabIndex??(s?-1:0),title:r.title??u==="download"?d("Upload","Download file"):u==="remove"?d("Upload","Remove file"):void 0,onClick:g=>{var j;(j=r.onClick)==null||j.call(r,g),g.stopPropagation(),u==="download"?x!=null&&x.download?x.download(c):we(c.url,c.name):u==="remove"&&(_==null||_())},children:o??(u==="download"?e.jsx(k,{children:e.jsx(xe,{})}):u==="remove"?e.jsx(k,{children:e.jsx(Ue,{})}):null)})}),oe=n=>i.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",...n},i.createElement("path",{d:"M13 4H6v16h12V9h-5z",opacity:.3}),i.createElement("path",{d:"m20 8-6-6H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8zm-2 12H6V4h7v5h5v11z"})),ie=i.forwardRef((n,w)=>{const{styleOverrides:l,styleProvider:m,children:o,disabled:u=!1,_file:a,_defaultActions:c,_light:x,_onRemove:b,..._}=O("UploadPreviewAction",n),r=P(pe,{"upload-action":m==null?void 0:m["upload-action"]},l),{t}=G();return e.jsx("a",{..._,...R(r("upload-action","upload-action--preview",{"upload-action.is-disabled":u||I.isUndefined(a.url),"upload-action--light":x}),{className:_.className,style:_.style}),ref:w,href:a.url,target:_.target??"_blank",title:_.title??t("Upload","Preview file"),onClick:d=>{var s;(s=_.onClick)==null||s.call(_,d),d.stopPropagation(),c!=null&&c.preview&&(d.preventDefault(),c.preview(a))},children:o??e.jsx(k,{children:e.jsx(je,{})})})}),Ce=i.forwardRef((n,w)=>{const{styleOverrides:l,styleProvider:m,file:o,actions:u,defaultActions:a,onRemove:c,...x}=O("UploadButton",n),b=P(Se,{"upload-button":m==null?void 0:m["upload-button"]},l),{t:_}=G(),r=o&&o.state==="progress";return e.jsx("div",{...x,...R(b("upload-button",{"upload-button.is-disabled":r,[`upload-button--${o==null?void 0:o.state}`]:o}),{className:x.className,style:x.style}),ref:w,tabIndex:x.tabIndex??(r?-1:0),children:o&&o.state!=="progress"?e.jsxs(e.Fragment,{children:[o.thumbUrl?e.jsx("img",{...b("upload-button__thumbnail"),src:o.thumbUrl,alt:o.name}):e.jsxs(e.Fragment,{children:[e.jsx(k,{theme:o.state==="error"?"danger":"primary",children:e.jsx(oe,{})}),e.jsx("div",{...b("upload-button__name"),children:o.name})]}),e.jsx("div",{...b("upload-button__actions"),children:i.Children.map(u??[e.jsx(ie,{}),e.jsx(V,{preset:"remove"})],t=>i.cloneElement(t,{_file:o,_defaultActions:a,_light:!0,_onRemove:c}))})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{...b("upload-button__icon"),children:e.jsx(k,{children:r?e.jsx(Z,{}):e.jsx(be,{})})}),e.jsx("div",{...b("upload-button__text"),children:_("Upload",r?"Uploading":"Upload")})]})})}),Le=n=>i.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",...n},i.createElement("path",{d:"M16.5 6v11.5c0 2.21-1.79 4-4 4s-4-1.79-4-4V5a2.5 2.5 0 0 1 5 0v10.5c0 .55-.45 1-1 1s-1-.45-1-1V6H10v9.5a2.5 2.5 0 0 0 5 0V5c0-2.21-1.79-4-4-4S7 2.79 7 5v12.5c0 3.04 2.46 5.5 5.5 5.5s5.5-2.46 5.5-5.5V6h-1.5z"}));function Ie(n){const{styleOverrides:w,styleProvider:l,actions:m,defaultActions:o,...u}=O("UploadList",n),a=P(Re,{"upload-list":l==null?void 0:l["upload-list"]},w),{files:c,onRemove:x}=i.useContext(X),b=se(),[_,r]=ee([]);return e.jsx("ul",{...u,...R(a("upload-list"),{className:u.className,style:u.style}),children:c.map((t,d)=>e.jsx(de,{originalSize:{height:"auto"},collapsedSize:{height:0},enter:!_.includes(t.uid),during:L,styles:{entering:{transition:["height","padding","margin"].map(s=>`${s} ${L}ms ease-out`).join(", ")},leaving:{transition:["height","padding","margin"].map(s=>`${s} ${L}ms ease-in`).join(", ")},leaved:{display:"none"}},skipFirstTransition:!b.current,afterLeave:()=>{r(s=>{s.splice(s.findIndex(g=>g===t.uid),1)}),x(t)},children:(s,g)=>e.jsxs("li",{...R(a("upload-list__item",{[`upload-list__item--${t.state}`]:t.state}),{style:g}),ref:s,children:[e.jsx("div",{...a("upload-list__icon"),children:t.state==="progress"?e.jsx(k,{children:e.jsx(Z,{})}):e.jsx(k,{rotate:45,children:e.jsx(Le,{})})}),e.jsx("a",{...a("upload-list__link",{"upload-list__link.is-active":t.state==="load"&&!I.isUndefined(t.url)}),href:t.url,target:"_blank",rel:"noreferrer",title:t.name,onClick:j=>{o&&o.preview&&(j.preventDefault(),o.preview(t))},children:t.name}),e.jsx("div",{...a("upload-list__actions"),children:i.Children.map(m?m(t,d):[e.jsx(V,{preset:"remove"})],j=>i.cloneElement(j,{_file:t,_defaultActions:o,_onRemove:()=>{r(U=>{U.push(t.uid)})}}))}),e.jsx("div",{...a("upload-list__progress-wrapper"),children:I.isNumber(t.percent)&&e.jsx(te,{percent:t.percent,label:!1,lineWidth:2})})]})},t.uid))})}function Te(n){const{children:w,styleOverrides:l,styleProvider:m,actions:o,defaultActions:u,...a}=O("UploadPicture",n),c=P(ke,{"upload-picture":m==null?void 0:m["upload-picture"]},l),{t:x}=G(),{files:b,onRemove:_}=i.useContext(X),r=se(),[t,d]=ee([]);return e.jsx("ul",{...a,...R(c("upload-picture"),{className:a.className,style:a.style}),children:e.jsxs("div",{...c("upload-picture__row"),children:[b.map((s,g)=>e.jsx(me,{enter:!t.includes(s.uid),during:L,skipFirstTransition:!r.current,afterLeave:()=>{d(j=>{j.splice(j.findIndex(U=>U===s.uid),1)}),_(s)},children:j=>{let U={};switch(j){case"enter":U={transform:"scale(0)"};break;case"entering":U={transition:["transform"].map(T=>`${T} ${L}ms ease-out`).join(", "),transformOrigin:"top left"};break;case"leaving":U={transform:"scale(0)",transition:["transform"].map(T=>`${T} ${L}ms ease-in`).join(", "),transformOrigin:"top left"};break;case"leaved":U={display:"none"};break}return e.jsx("div",{children:e.jsx("li",{...R(c("upload-picture__item",{[`upload-picture__item--${s.state}`]:s.state,"upload-picture__item.is-disabled":s&&s.state==="progress"}),{style:U}),children:s.state!=="progress"?e.jsxs(e.Fragment,{children:[s.thumbUrl?e.jsx("img",{...c("upload-picture__thumbnail"),src:s.thumbUrl,alt:s.name}):e.jsxs(e.Fragment,{children:[e.jsx(k,{size:28,theme:s.state==="error"?"danger":"primary",children:e.jsx(oe,{})}),e.jsx("div",{...c("upload-picture__name"),children:s.name})]}),e.jsx("div",{...c("upload-picture__actions"),children:i.Children.map(o?o(s,g):[e.jsx(ie,{}),e.jsx(V,{preset:"remove"})],T=>i.cloneElement(T,{_file:s,_defaultActions:u,_light:!0,_onRemove:()=>{d(H=>{H.push(s.uid)})}}))})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{...c("upload-picture__progress-text"),children:x("Upload","Uploading")}),I.isNumber(s.percent)&&e.jsx(te,{style:{width:"100%"},percent:s.percent,label:!1,lineWidth:2})]})})})}},s.uid)),e.jsx("div",{children:w})]})})}function De(n){const{styleOverrides:w,styleProvider:l,actions:m,defaultActions:o,...u}=O("UploadPictureList",n),a=P(Ee,{"upload-picture-list":l==null?void 0:l["upload-picture-list"]},w),{files:c,onRemove:x}=i.useContext(X),b=se(),[_,r]=ee([]);return e.jsx("ul",{...u,...R(a("upload-picture-list"),{className:u.className,style:u.style}),children:c.map((t,d)=>e.jsx(de,{originalSize:{height:"auto"},collapsedSize:{height:0},enter:!_.includes(t.uid),during:L,styles:{entering:{transition:["height","padding","margin"].map(s=>`${s} ${L}ms ease-out`).join(", ")},leaving:{transition:["height","padding","margin"].map(s=>`${s} ${L}ms ease-in`).join(", ")},leaved:{display:"none"}},skipFirstTransition:!b.current,afterLeave:()=>{r(s=>{s.splice(s.findIndex(g=>g===t.uid),1)}),x(t)},children:(s,g)=>e.jsxs("li",{...R(a("upload-picture-list__item",{[`upload-picture-list__item--${t.state}`]:t.state}),{style:g}),ref:s,children:[e.jsx("div",{...a("upload-picture-list__thumbnail"),children:t.state==="progress"?e.jsx(k,{size:28,children:e.jsx(Z,{})}):t.thumbUrl?e.jsx("img",{...a("upload-picture-list__thumbnail-img"),src:t.thumbUrl,alt:t.name}):e.jsx(k,{size:28,theme:t.state==="error"?"danger":"primary",children:e.jsx(oe,{})})}),e.jsx("a",{...a("upload-picture-list__link",{"upload-picture-list__link.is-active":t.state==="load"&&!I.isUndefined(t.url)}),href:t.url,target:"_blank",rel:"noreferrer",title:t.name,onClick:j=>{o&&o.preview&&(j.preventDefault(),o.preview(t))},children:t.name}),e.jsx("div",{...a("upload-picture-list__actions"),children:i.Children.map(m?m(t,d):[e.jsx(V,{preset:"remove"})],j=>i.cloneElement(j,{_file:t,_defaultActions:o,_onRemove:()=>{r(U=>{U.push(t.uid)})}}))}),e.jsx("div",{...a("upload-picture-list__progress-wrapper"),children:I.isNumber(t.percent)&&e.jsx(te,{percent:t.percent,label:!1,lineWidth:2})})]})},t.uid))})}function Ae(n,w){const{children:l,styleOverrides:m,styleProvider:o,formControl:u,model:a,defaultModel:c,request:x,max:b,drag:_=!1,customUpload:r,beforeUpload:t,onModelChange:d,onRemove:s,...g}=O("Upload",n),j=P(ye,{upload:o==null?void 0:o.upload,"upload-list":o==null?void 0:o["upload-list"]},m),U=i.useRef(null),T=ve(U,w),H=i.useRef({fileURLs:[]}),[B,q]=_e(c??[],a,void 0,void 0,u==null?void 0:u.control);he(()=>{H.current.fileURLs.forEach(v=>{URL.revokeObjectURL(v)})});const ae=v=>{if(r)r(v);else{let E=Date.now();const p=[];for(let f=0;f<v.length;f++){const h=v.item(f);if(h){const y=new XMLHttpRequest;let D=++E;const le=C=>{const A=URL.createObjectURL(h);H.current.fileURLs.push(A);const S={uid:D,name:h.name,url:A,thumbUrl:h.type.startsWith("image")?A:void 0,originFile:h,response:y.response,...C};if(I.isNumber(b)&&B.length+p.length>=b){if(b===1){D=S.uid=B[0].uid,q([S]),d==null||d([S],{type:"update",files:[S]});return}return!0}p.push(S)},J=C=>{let A=!0;const S=q(N=>{const $=N.findIndex(Q=>Q.uid===D);$!==-1?N[$]=Object.assign(N[$],{response:y.response,...C}):A=!1});A&&(d==null||d(S,{type:"update",files:[S.find(N=>N.uid===D)]}))},K=C=>{if(C===!1)le({state:null});else{if(le({state:"progress",percent:0}))return;y.upload.addEventListener("progress",F=>{if(F.lengthComputable){const W=Math.round(F.loaded*100/F.total);J({state:"progress",percent:W})}}),y.addEventListener("error",()=>{J({state:"error",percent:void 0})}),y.addEventListener("load",()=>{J({state:y.status>=200&&y.status<300?"load":"error",percent:void 0})});const{url:S,method:N="POST",responseType:$="json",header:Q={},body:ce=F=>{const W=new FormData;return W.append("file",F),W},custom:Y}=x;y.open(N,S),y.responseType=$,Object.entries(Q).forEach(F=>{y.setRequestHeader(...F)}),Y==null||Y(y),y.send(ce(C===!0?h:C))}};let M=!0;t?(M=t(h,v),M instanceof Promise?M.then(C=>{K(C)}):K(M)):K(!0)}}if(p.length>0){const f=q(h=>h.concat(p));d==null||d(f,{type:"add",files:p})}}},re=v=>{let E={};return _&&(E={onDragEnter:p=>{var f,h;(h=(f=v.props).onDragEnter)==null||h.call(f,p),p.stopPropagation(),p.preventDefault()},onDragOver:p=>{var f,h;(h=(f=v.props).onDragOver)==null||h.call(f,p),p.stopPropagation(),p.preventDefault()},onDrop:p=>{var y,D;(D=(y=v.props).onDrop)==null||D.call(y,p),p.stopPropagation(),p.preventDefault();const h=p.dataTransfer.files;ae(h)}}),i.cloneElement(v,{...E,onClick:p=>{var f,h;(h=(f=v.props).onClick)==null||h.call(f,p),U.current&&U.current.click()}})},ne=ge(v=>{s==null||s(v);const E=q(p=>{const f=p.findIndex(h=>h.uid===v.uid);p.splice(f,1)});d==null||d(E,{type:"remove",files:[v]})}),ue=i.useMemo(()=>({files:B,onRemove:ne}),[B,ne]);return e.jsxs(e.Fragment,{children:[e.jsx(X.Provider,{value:ue,children:I.isFunction(l)?l(re):re(l)}),e.jsx("input",{...g,...R(j("upload"),{className:g.className,style:g.style}),ref:T,type:g.type??"file",onChange:v=>{var p;(p=g.onChange)==null||p.call(g,v);const E=v.currentTarget.files;E&&ae(E),v.currentTarget.value=""}})]})}const z=i.forwardRef(Ae);z.Button=Ce;z.Action=V;z.PreviewAction=ie;z.List=Ie;z.Picture=Te;z.PictureList=De;const Be=n=>i.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",...n},i.createElement("path",{d:"M18 15v3H6v-3H4v3c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2v-3h-2zM7 9l1.41 1.41L11 7.83V16h2V7.83l2.59 2.58L17 9l-5-5-5 5z"}));export{Be as S,z as U};
