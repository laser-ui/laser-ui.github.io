import{r as i,u as ht,a as mt,b as bt,d as gt,v as xt,e as vt,c as fe,l as j,x as St,F as jt,G as se,H as yt,g as wt,R as Re,W as le,J as De,h as Et,i as It,k as _e,m as W,j as l,p as kt,I as H,K as Rt,L as Dt,q as Ce,P as Ct,n as Mt,M as he,A as Nt}from"./index-40b015b6.js";import{u as Pt}from"./useForkRef-fb6acea2.js";import{S as Wt}from"./cancel-ec520f89.js";import{S as Lt}from"./add-44ed2b88.js";import{S as zt}from"./keyboard_arrow_down-27f36eca.js";import{S as At}from"./search-0219cd73.js";import{B as $t}from"./BaseInput-759c6821.js";import{i as Ft}from"./isPrintableCharacter-1b5c27a6.js";import{T as Me}from"./Tag-e88d597a.js";import{V as Tt}from"./VirtualScroll-c90d0b66.js";import{C as Vt}from"./Checkbox-93ccc764.js";import{E as Ne}from"./Empty-5f6b3e37.js";const Ot={select:"^select","select.is-expanded":"is-expanded","select.is-disabled":"is-disabled","select--small":"^select--small","select--medium":"^select--medium","select--large":"^select--large",select__container:"^select__container",select__content:"^select__content",select__search:"^select__search","select__placeholder-wrapper":"^select__placeholder-wrapper",select__placeholder:"^select__placeholder","select__multiple-count":"^select__multiple-count",select__close:"^select__close",select__clear:"^select__clear",select__icon:"^select__icon",select__arrow:"^select__arrow","select-popup":"^select-popup","select-popup__content":"^select-popup__content","select-popup__loading":"^select-popup__loading","select-popup__loading--empty":"^select-popup__loading--empty",select__list:"^select__list",select__option:"^select__option","select__option.is-selected":"is-selected","select__option.is-disabled":"is-disabled","select__option-prefix":"^select__option-prefix","select__option-content":"^select__option-content","select__option-group":"^select__option-group","select__option-group-label":"^select__option-group-label",select__empty:"^select__empty"},L=Symbol();function Ut(Pe,We){const{styleOverrides:Le,styleProvider:R,formControl:m,list:D,model:ze,defaultModel:Ae,visible:$e,defaultVisible:Fe,placeholder:me,multiple:u=!1,searchable:C=!1,searchValue:Te,defaultSearchValue:Ve,clearable:Oe=!1,loading:G=!1,size:Ue,disabled:Be=!1,monospaced:He=!0,virtual:z=!1,escClosable:Ge=!0,customItem:be,customSelected:K,customSearch:y,createItem:ne,inputRef:Ke,inputRender:ge,popupRender:xe,onModelChange:oe,onVisibleChange:qe,onSearch:Je,onClear:ce,onCreateItem:ie,onScrollBottom:Ye,afterVisibleChange:M,...p}=ht("Select",Pe),N=mt(),c=bt(Ot,{select:R==null?void 0:R.select,"select-popup":R==null?void 0:R["select-popup"]},Le),x=gt(),{t:q}=xt(),ve=i.useId(),Se=`${N}-select-list-${ve}`,A=e=>`${N}-select-item-${e}-${ve}`,{pageScrollRef:Ze,contentResizeRef:Qe}=vt(),w=i.useRef(null),b=i.useRef(null),E=i.useRef(null),J=i.useRef(null),Xe=Pt(J,Ke),$=i.useRef(null),F=i.useMemo(()=>{const e=new Map,t=s=>{for(const n of s)e.set(n.value,n),n.children&&t(n.children)};return t(D),e},[D]),[d,v]=fe(Fe??!1,$e,qe),[T,et]=fe(Ve??"",Te,Je),I=i.useCallback(e=>!e.disabled&&!e.children,[]),[Y,Z]=fe(Ae??(u?[]:null),ze,e=>{oe&&(u?oe(e,e.map(t=>F.get(t))):oe(e,j.isNull(e)?null:F.get(e)))},void 0,m==null?void 0:m.control),h=i.useMemo(()=>u?new Set(Y):Y,[Y,u]),Q=e=>{u?Z(t=>{const s=t.findIndex(n=>n===e);s!==-1?t.splice(s,1):t.push(e)}):(Z(e),v(!1))},{size:re,disabled:P}=St({size:Ue,disabled:Be||(m==null?void 0:m.control.disabled)}),V=T.length>0,ae=u?h.size>0:!j.isNull(h),de=(()=>{if(!V)return[];const e=j.isUndefined(y==null?void 0:y.filter)?o=>o.label.includes(T):o=>y.filter(T,o),t=y==null?void 0:y.sort;let s=ne==null?void 0:ne(T);s&&(s={...s,[L]:!0});let n=[];return D.forEach(o=>{if(!o.children)s&&o.value===s.value&&(s=void 0),e(o)&&n.push(o);else{const r=[];o.children.forEach(a=>{s&&a.value===s.value&&(s=void 0),e(a)&&r.push(a)}),n=n.concat(r)}}),t&&n.sort(t),s&&n.unshift(s),n})(),O=V?de:D,[tt,st]=jt(e=>e.startsWith("Arrow")||["Home","End","Enter","Space"].includes(e)),[je,lt]=i.useState(),nt=(()=>{let e;return je&&(e=F.get(je.value),e&&I(e))||(ae&&(e=se(D,t=>I(t)&&u?h.has(t.value):h===t.value)),j.isUndefined(e)&&(e=se(D,t=>I(t)))),e})(),[ue,ot]=i.useState(),ct=(()=>{if(ue&&se(de,e=>I(e)&&e.value===ue.value))return ue;if(V)return se(de,e=>I(e))})(),f=V?ct:nt,ye=e=>{V?ot(e):lt(e)},we=e=>{if(!j.isUndefined(e)){const t=Object.assign({},e);delete t[L],ie==null||ie(t)}},it=yt(d),rt=`calc(var(--${N}-zindex-fixed) + ${it})`,X=i.useRef(),S=wt(()=>{if(d&&w.current&&b.current)if(He){const e=Math.min(w.current.offsetWidth,Re.windowSize.width-le*2),t=b.current.offsetHeight,s=De(w.current,{width:e,height:t},{placement:"bottom",inWindow:le});X.current=s.transformOrigin,x.classes.position&&b.current.classList.toggle(x.classes.position,!1),x.replaceRule("position",{top:s.top,left:s.left,width:e}),b.current.classList.toggle(x.classes.position,!0)}else{const e=w.current.offsetWidth,t=b.current.offsetHeight,s=Re.windowSize.width-le*2,n=Math.min(Math.max(b.current.scrollWidth,e),s),o=De(w.current,{width:n,height:t},{placement:"bottom-left",inWindow:le});X.current=o.transformOrigin,x.classes.position&&b.current.classList.toggle(x.classes.position,!1),x.replaceRule("position",{top:o.top,left:o.left,minWidth:Math.min(e,s),maxWidth:s}),b.current.classList.toggle(x.classes.position,!0)}}),at=Et(S,!d);It(Ze,"scroll",S,{passive:!0},!d||at),_e(w,S,void 0,!d),_e(b,S,void 0,!d),_e(Qe,S,void 0,!d),i.useImperativeHandle(We,()=>({updatePosition:S}),[S]);const ee=e=>{document.activeElement===J.current&&e.target!==J.current&&e.button===0&&e.preventDefault()},k=i.useRef(),te=C&&d,Ee=Oe&&ae&&!d&&!G&&!P,Ie=st(i.createElement(C?$t:"div",Object.assign({...W(c("select__search"),{style:{opacity:te?void 0:0,zIndex:te?void 0:-1}}),...m==null?void 0:m.inputAria,ref:Xe,tabIndex:P?-1:0,role:"combobox","aria-haspopup":"listbox","aria-expanded":d,"aria-controls":Se,onBlur:()=>{v(!1)},onKeyDown:e=>{if(e.code==="Escape")d&&Ge&&(e.stopPropagation(),e.preventDefault(),v(!1));else{const t=s=>{var n,o,r,a;if(E.current){let _;switch(s){case"next":_=(n=$.current)==null?void 0:n.scrollToStep(E.current,1);break;case"prev":_=(o=$.current)==null?void 0:o.scrollToStep(E.current,-1);break;case"first":_=(r=$.current)==null?void 0:r.scrollToStart(E.current);break;case"last":_=(a=$.current)==null?void 0:a.scrollToEnd(E.current);break}_&&(ye(_),z===!1&&(k.current=()=>{const U=document.getElementById(A(_.value));U&&Nt(U,E.current)},d&&(k.current(),k.current=void 0)))}};if(d)switch(e.code){case"ArrowUp":{e.preventDefault(),t("prev");break}case"ArrowDown":{e.preventDefault(),t("next");break}case"Home":{e.preventDefault(),t("first");break}case"End":{e.preventDefault(),t("last");break}default:{(e.code==="Enter"||e.code==="Space"&&!C)&&(e.preventDefault(),f&&(f[L]&&we(f),Q(f.value)));break}}else if(!(C&&["Home","End","Enter","Space"].includes(e.code)))switch(e.code){case"End":case"ArrowUp":{e.preventDefault(),v(!0),t("last");break}case"Home":case"ArrowDown":{e.preventDefault(),v(!0),t("first");break}case"Enter":case"Space":{e.preventDefault(),v(!0);break}default:{Ft(e.key)&&v(!0);break}}}}},C?{type:"text",value:T,autoComplete:"off",disabled:P,onValueChange:e=>{et(e)}}:{}))),[dt,ut,pt]=(()=>{let e=null,t=null,s;if(u){const n=Y.map(o=>{const r=F.get(o);return{value:o,label:K?K(o,r):r?r.label:String(o),item:r}});t=l.jsx(kt,{list:n.map(({value:o,label:r,item:a})=>({id:o,title:r,type:"item",disabled:a==null?void 0:a.disabled})),onClick:o=>(Q(o),!1),children:l.jsx(Me,{tabIndex:-1,size:re,children:h.size})}),e=n.map(({value:o,label:r,item:a})=>l.jsxs(Me,{size:re,children:[r,!(a!=null&&a.disabled||P)&&l.jsx("div",{...c("select__close"),role:"button","aria-label":q("Close"),onClick:_=>{_.stopPropagation(),Q(o)},children:l.jsx(H,{children:l.jsx(Rt,{})})})]},o))}else if(!j.isNull(h)){const n=F.get(h);e=s=K?K(h,n):n?n.label:String(h)}return[e,t,s]})(),ft=Dt({compose:{disabled:P},form:m}),_t=i.useMemo(()=>({list:O,itemKey:e=>e.value,itemSize:j.isNumber(z)?z:32,itemEmptySize:32,itemNested:e=>e.children,itemFocusable:I}),[I,O,z]);return l.jsxs(l.Fragment,{children:[l.jsxs("div",{...p,...W(c("select",`select--${re}`,{"select.is-expanded":d,"select.is-disabled":P}),{className:p.className,style:p.style}),...ft,ref:w,onMouseDown:e=>{var t;(t=p.onMouseDown)==null||t.call(p,e),ee(e)},onMouseUp:e=>{var t;(t=p.onMouseUp)==null||t.call(p,e),ee(e)},onClick:e=>{var t,s;(t=p.onClick)==null||t.call(p,e),(s=J.current)==null||s.focus({preventScroll:!0}),v(n=>C?!0:!n)},children:[l.jsxs("div",{...c("select__container"),title:pt,children:[ge?ge(Ie):Ie,!te&&(ae?l.jsx("div",{...c("select__content"),children:dt}):me?l.jsx("div",{...c("select__placeholder-wrapper"),children:l.jsx("div",{...c("select__placeholder"),children:me})}):null)]}),u&&l.jsx("div",{...c("select__multiple-count"),onClick:e=>{e.stopPropagation()},children:ut}),Ee&&l.jsx("div",{...c("select__clear"),role:"button","aria-label":q("Clear"),onClick:e=>{e.stopPropagation(),Z(u?[]:null),ce==null||ce()},children:l.jsx(H,{children:l.jsx(Wt,{})})}),l.jsx("div",{...W(c("select__icon"),{style:{visibility:Ee?"hidden":void 0}}),children:l.jsx(H,{children:G?l.jsx(Ce,{}):te?l.jsx(At,{}):l.jsx(zt,{...c("select__arrow")})})})]}),l.jsx(Ct,{selector:()=>{let e=document.getElementById(`${N}-select-root`);return e||(e=document.createElement("div"),e.id=`${N}-select-root`,document.body.appendChild(e)),e},children:l.jsx(Mt,{enter:d,during:he,afterRender:()=>{var e;S(),(e=k.current)==null||e.call(k),k.current=void 0},afterEnter:()=>{M==null||M(!0)},afterLeave:()=>{M==null||M(!1)},children:e=>{let t={};switch(e){case"enter":t={transform:"scaleY(0.7)",opacity:0};break;case"entering":t={transition:["transform","opacity"].map(s=>`${s} ${he}ms ease-out`).join(", "),transformOrigin:X.current};break;case"leaving":t={transform:"scaleY(0.7)",opacity:0,transition:["transform","opacity"].map(s=>`${s} ${he}ms ease-in`).join(", "),transformOrigin:X.current};break;case"leaved":t={display:"none"};break}return l.jsx("div",{...W(c("select-popup"),{style:{zIndex:rt,...t}}),ref:b,onMouseDown:s=>{ee(s)},onMouseUp:s=>{ee(s)},children:(()=>{const s=l.jsxs("div",{...c("select-popup__content"),children:[G&&l.jsx("div",{...c("select-popup__loading",{"select-popup__loading--empty":O.length===0}),children:l.jsx(H,{children:l.jsx(Ce,{})})}),G&&O.length===0?null:l.jsx(Tt,{..._t,ref:$,enable:z!==!1,listSize:264,listPadding:4,itemRender:(n,o,r,a,_)=>{const{label:U,value:g,disabled:pe}=n,ke=be?be(n):U;if(_)return i.createElement("ul",{...c("select__option-group"),key:g,role:"group","aria-labelledby":A(g)},i.createElement("li",{...c("select__option-group-label"),key:g,id:A(g),role:"presentation"},l.jsx("div",{...c("select__option-content"),children:ke})),_);let B=!1;return u?B=h.has(g):B=h===g,i.createElement("li",{...W(c("select__option",{"select__option.is-selected":!u&&B,"select__option.is-disabled":pe}),{style:{paddingLeft:a.length===0?void 0:20}}),...r,key:g,id:A(g),title:(n[L]?q("Create")+" ":"")+U,role:"option","aria-selected":B,"aria-disabled":pe,onClick:()=>{n[L]&&we(n),ye(n),Q(g)}},tt&&(f==null?void 0:f.value)===g&&l.jsx("div",{className:`${N}-focus-outline`}),n[L]?l.jsx("div",{...c("select__option-prefix"),children:l.jsx(H,{theme:"primary",children:l.jsx(Lt,{})})}):u?l.jsx("div",{...c("select__option-prefix"),children:l.jsx(Vt,{model:B,disabled:pe})}):null,l.jsx("div",{...c("select__option-content"),children:ke}))},itemFocused:f==null?void 0:f.value,itemEmptyRender:()=>l.jsx("li",{...W(c("select__empty"),{style:{paddingLeft:20}}),children:l.jsx("div",{...c("select__option-content"),children:q("No Data")})}),itemInAriaSetsize:n=>!n.children,placeholder:"li",onScrollEnd:Ye,children:(n,o)=>l.jsx("ul",{...c("select__list"),ref:E,id:Se,tabIndex:-1,role:"listbox","aria-multiselectable":u,"aria-activedescendant":j.isUndefined(f)?void 0:A(f.value),onScroll:o,children:O.length===0?l.jsx(Ne,{style:{padding:"12px 0"},image:Ne.SIMPLE_IMG}):n})})]});return xe?xe(s):s})()})}})})]})}const ss=i.forwardRef(Ut);export{ss as S};
